import{d as Mt,k as W,r as Tt,e as Ut,Z as yt,V as ht,a3 as Yt,i as Ct,aa as S,P as St}from"./vega-util-7f144c9d.js";import{e as wt,d as _,c as Z,b as N,a as Ft,t as It,s as B,v as J,l as kt,k as z,j as X,i as p,h as Et,u as Ht}from"./d3-time-22f10c4f.js";import{e as bt,t as K}from"./d3-array-ee3dc224.js";const l="year",g="quarter",m="month",c="week",d="date",i="day",U="dayofyear",M="hours",T="minutes",y="seconds",h="milliseconds",Ot=[l,g,m,c,d,i,U,M,T,y,h],A=Ot.reduce((t,e,n)=>(t[e]=1+n,t),{});function $t(t){const e=Mt(t).slice(),n={};return e.length||W("Missing time unit."),e.forEach(a=>{Tt(A,a)?n[a]=1:W(`Invalid time unit: ${a}.`)}),(n[c]||n[i]?1:0)+(n[g]||n[m]||n[d]?1:0)+(n[U]?1:0)>1&&W(`Incompatible time units: ${t}`),e.sort((a,u)=>A[a]-A[u]),e}const vt={[l]:"%Y ",[g]:"Q%q ",[m]:"%b ",[d]:"%d ",[c]:"W%U ",[i]:"%a ",[U]:"%j ",[M]:"%H:00",[T]:"00:%M",[y]:":%S",[h]:".%L",[`${l}-${m}`]:"%Y-%m ",[`${l}-${m}-${d}`]:"%Y-%m-%d ",[`${M}-${T}`]:"%H:%M"};function Vt(t,e){const n=Ut({},vt,e),s=$t(t),a=s.length;let u="",r=0,o,D;for(r=0;r<a;)for(o=s.length;o>r;--o)if(D=s.slice(r,o).join("-"),n[D]!=null){u+=n[D],r=o;break}return u.trim()}const Y=new Date;function L(t){return Y.setFullYear(t),Y.setMonth(0),Y.setDate(1),Y.setHours(0,0,0,0),Y}function Zt(t){return tt(new Date(t))}function Bt(t){return q(new Date(t))}function tt(t){return N.count(L(t.getFullYear())-1,t)}function q(t){return Z.count(L(t.getFullYear())-1,t)}function R(t){return L(t).getDay()}function Nt(t,e,n,s,a,u,r){if(0<=t&&t<100){const o=new Date(-1,e,n,s,a,u,r);return o.setFullYear(t),o}return new Date(t,e,n,s,a,u,r)}function Jt(t){return et(new Date(t))}function Xt(t){return j(new Date(t))}function et(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return p.count(e-1,t)}function j(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return X.count(e-1,t)}function Q(t){return Y.setTime(Date.UTC(t,0,1)),Y.getUTCDay()}function pt(t,e,n,s,a,u,r){if(0<=t&&t<100){const o=new Date(Date.UTC(-1,e,n,s,a,u,r));return o.setUTCFullYear(n.y),o}return new Date(Date.UTC(t,e,n,s,a,u,r))}function nt(t,e,n,s,a){const u=e||1,r=ht(t),o=(O,$,v)=>(v=v||O,xt(n[v],s[v],O===r&&u,$)),D=new Date,f=Yt(t),it=f[l]?o(l):Ct(2012),lt=f[m]?o(m):f[g]?o(g):S,ft=f[c]&&f[i]?o(i,1,c+i):f[c]?o(c,1):f[i]?o(i,1):f[d]?o(d,1):f[U]?o(U,1):St,mt=f[M]?o(M):S,Dt=f[T]?o(T):S,gt=f[y]?o(y):S,dt=f[h]?o(h):S;return function(O){D.setTime(+O);const $=it(D);return a($,lt(D),ft(D,$),mt(D),Dt(D),gt(D),dt(D))}}function xt(t,e,n,s){const a=n<=1?t:s?(u,r)=>s+n*Math.floor((t(u,r)-s)/n):(u,r)=>n*Math.floor(t(u,r)/n);return e?(u,r)=>e(a(u,r),r):a}function C(t,e,n){return e+t*7-(n+6)%7}const Wt={[l]:t=>t.getFullYear(),[g]:t=>Math.floor(t.getMonth()/3),[m]:t=>t.getMonth(),[d]:t=>t.getDate(),[M]:t=>t.getHours(),[T]:t=>t.getMinutes(),[y]:t=>t.getSeconds(),[h]:t=>t.getMilliseconds(),[U]:t=>tt(t),[c]:t=>q(t),[c+i]:(t,e)=>C(q(t),t.getDay(),R(e)),[i]:(t,e)=>C(1,t.getDay(),R(e))},At={[g]:t=>3*t,[c]:(t,e)=>C(t,0,R(e))};function te(t,e){return nt(t,e||1,Wt,At,Nt)}const qt={[l]:t=>t.getUTCFullYear(),[g]:t=>Math.floor(t.getUTCMonth()/3),[m]:t=>t.getUTCMonth(),[d]:t=>t.getUTCDate(),[M]:t=>t.getUTCHours(),[T]:t=>t.getUTCMinutes(),[y]:t=>t.getUTCSeconds(),[h]:t=>t.getUTCMilliseconds(),[U]:t=>et(t),[c]:t=>j(t),[i]:(t,e)=>C(1,t.getUTCDay(),Q(e)),[c+i]:(t,e)=>C(j(t),t.getUTCDay(),Q(e))},Rt={[g]:t=>3*t,[c]:(t,e)=>C(t,0,Q(e))};function ee(t,e){return nt(t,e||1,qt,Rt,pt)}const jt={[l]:wt,[g]:_.every(3),[m]:_,[c]:Z,[d]:N,[i]:N,[U]:N,[M]:Ft,[T]:It,[y]:B,[h]:J},Qt={[l]:kt,[g]:z.every(3),[m]:z,[c]:X,[d]:p,[i]:p,[U]:p,[M]:Et,[T]:Ht,[y]:B,[h]:J};function at(t){return jt[t]}function st(t){return Qt[t]}function ot(t,e,n){return t?t.offset(e,n):void 0}function ne(t,e,n){return ot(at(t),e,n)}function ae(t,e,n){return ot(st(t),e,n)}function rt(t,e,n,s){return t?t.range(e,n,s):void 0}function se(t,e,n,s){return rt(at(t),e,n,s)}function oe(t,e,n,s){return rt(st(t),e,n,s)}const F=1e3,I=F*60,k=I*60,x=k*24,Gt=x*7,P=x*30,G=x*365,ut=[l,m,d,M,T,y,h],E=ut.slice(0,-1),H=E.slice(0,-1),b=H.slice(0,-1),Lt=b.slice(0,-1),_t=[l,c],V=[l,m],ct=[l],w=[[E,1,F],[E,5,5*F],[E,15,15*F],[E,30,30*F],[H,1,I],[H,5,5*I],[H,15,15*I],[H,30,30*I],[b,1,k],[b,3,3*k],[b,6,6*k],[b,12,12*k],[Lt,1,x],[_t,1,Gt],[V,1,P],[V,3,3*P],[ct,1,G]];function re(t){const e=t.extent,n=t.maxbins||40,s=Math.abs(yt(e))/n;let a=bt(o=>o[2]).right(w,s),u,r;return a===w.length?(u=ct,r=K(e[0]/G,e[1]/G,n)):a?(a=w[s/w[a-1][2]<w[a][2]/s?a-1:a],u=a[0],r=a[1]):(u=ut,r=Math.max(K(e[0],e[1],n),1)),{units:u,step:r}}export{d as D,M as H,h as M,g as Q,y as S,Ot as T,c as W,l as Y,i as a,U as b,T as c,m as d,Zt as e,re as f,at as g,ne as h,se as i,Vt as j,$t as k,st as l,ae as m,oe as n,Jt as o,Xt as p,te as t,ee as u,Bt as w};
