import{a as l,t as W,c as $,w as E,o as Z,S as ge,v as S,x as y,K as B,z as i,L as X,N as L,A as T,I as F,O as he,U as Y,J as z,u as P,T as ye,F as we,n as K,l as Se,H as Pe,Q as _e}from"./@vue-ClpcO8Zo.js";import{u as xe,F as Le}from"./vee-validate-BmYbzI1D.js";import{c as Ce,a as ke}from"./yup-BgJ03jPv.js";import{l as I}from"./lodash-BzB9AJ4Z.js";import{C as Ve}from"./vue-select-BKCeRojA.js";import{_ as Be}from"./index-CLToagtx.js";import"./property-expr-DEi1ZLzV.js";import"./tiny-case-BJ7jYKNY.js";import"./toposort-D3GKjj2I.js";import"./vue-router-DlzEUOd-.js";/* empty css                   */const Ie=["for"],Fe={class:"location-item"},Oe={class:"location-item-text"},qe={class:"text-bold"},Ne={key:0},$e={class:"form-validation"},Ee={key:0,class:"invalid-message"},U=50,j=25,Te={__name:"InfiniteSelect",props:{name:{type:String,required:!0},label:{type:String},field:{type:String,default:"text"},modelValue:[String,Number,Object],placeholder:{type:String,default:""},options:{type:Array},labelProp:{type:String},valueProp:{type:String},disabled:{type:Boolean},paginate:{type:Boolean,default:!0},fetchPageCallBack:{type:Function,default:void 0},isLastPage:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},disableValidation:{type:Boolean,default:!1},icon:{type:String},clearable:{type:Boolean,default:!0},searchable:{type:Boolean,default:!0}},emits:["selected","update:modelValue"],setup(u,{expose:C,emit:O}){const n=u,k=O,p=l(U),c=l(""),m=l([]),g=l([]),_=l(!0),w=l(null),d=l(1),b=l(!1),R=l(null),s=l(0),o=W(n,"name"),f=W(n,"modelValue"),{value:h,errorMessage:x,meta:v}=xe(o,void 0,{initialValue:f}),q=l(0),A=l(null),N=l(null),D=$(()=>m.value.filter(e=>e&&e[n.labelProp]&&e[n.labelProp].toLowerCase().includes(c.value.toLowerCase()))),ee=$(()=>d.value>1),H=$(()=>{if(!n.paginate)return D.value;const e=d.value*p.value;return D.value.slice(0,e+p.value)}),te=$(()=>!v.validated||n.disableValidation?null:v.valid?"valid":"invalid");E(()=>n.modelValue,()=>{w.value=n.modelValue}),E(()=>n.loading,e=>{b.value=e,q.value++}),E(()=>n.isLastPage,e=>{_.value=!e}),E(()=>I.cloneDeep(n.options),e=>{if(m.value.length===0)m.value=e,g.value=e;else{const t=e.filter(a=>!m.value.some(r=>I.isEqual(r,a)));t.length>0&&m.value.push(...t),de()}},{immediate:!0});async function ae(){!_.value||b.value||await J(d.value,c.value)}async function J(e,t=null){if(n.fetchPageCallBack===void 0)console.error("fetchPageCallBack must be implemented inorder to enable pagination.");else try{await n.fetchPageCallBack(e,t)}catch(a){console.error("Error fetching items:",a)}}const le=async e=>{c.value=e,d.value=1,p.value=U,m.value=g.value,oe(d.value,c.value),await K(),q.value++},oe=I.debounce(async(e,t)=>{await J(e,t)},j);async function ne(e){var t,a;if(e!=null&&e.target){const r=e.target,M=r.scrollTop,pe=r.scrollHeight,be=r.clientHeight;if(M<=100&&ee.value){const V=r.children[0];V&&((t=A.value)==null||t.observe(V))}else if(pe-M<=be+100){const V=r.children[(r==null?void 0:r.children.length)-1];V&&((a=N.value)==null||a.observe(V))}s.value=M}}const G=I.debounce(ne,j);function se(e){e.forEach(t=>{t.isIntersecting&&!b.value&&d.value--})}async function re(e){e.forEach(async t=>{t.isIntersecting&&!b.value&&_.value&&(d.value++,await ae())})}const ie=e=>{var t;if(!(!_.value||b.value))switch(e.key){case"ArrowDown":const a=H.value.length-1;if(a>=0&&document.querySelectorAll(".vs__dropdown-option")[a]){const r=document.querySelectorAll(".vs__dropdown-option")[a];r.getBoundingClientRect().bottom>=window.innerHeight*.8&&(ue(d.value+1)||((t=N.value)==null||t.observe(r),s.value=r.scrollTop))}break}},Q=I.debounce(ie,j);function ue(e){const t=e*p.value;return D.value.slice(t,t+p.value).length>1}function ce(e){k("selected",e)}function de(){K().then(()=>{const e=document.querySelector(".vs__dropdown-menu");e&&requestAnimationFrame(()=>{e.scrollTop=s.value})})}function ve(){K(()=>{requestAnimationFrame(()=>{const e=document.querySelector(".vs__dropdown-menu");e&&e.addEventListener("scroll",G)})})}function me(){const e=document.querySelector(".vs-dropdown-menu");e&&e.removeEventListener("scroll",G),s.value=0}function fe(){m.value=[],p.value=U}return C({reset:fe}),Z(()=>{A.value=new IntersectionObserver(se),N.value=new IntersectionObserver(re)}),ge(()=>{var e,t;(e=A.value)==null||e.disconnect(),(t=N.value)==null||t.disconnect()}),(e,t)=>(y(),S(we,null,[u.label?(y(),S("label",{key:0,class:X(["label",{required:e.$attrs.required}]),for:e.$attrs.id},L(u.label)+" Page: "+L(d.value)+" | Loaded Records: "+L(m.value.length),11,Ie)):B("",!0),i("div",{class:X(["input-field-select",te.value,{icon:u.icon}])},[T(P(Ve),he({id:"selector",ref_key:"selectRef",ref:R,disabled:u.disabled,options:H.value,filterable:!1,placeholder:u.placeholder,clearable:u.clearable,onSearch:t[0]||(t[0]=a=>{le(a)}),onOpen:ve,onClose:me,"onOption:selected":ce,onKeydown:[Y(z(P(Q),["prevent"]),["down"]),Y(z(P(Q),["prevent"]),["up"])],label:u.labelProp,modelValue:w.value,"onUpdate:modelValue":t[1]||(t[1]=a=>w.value=a),reduce:a=>a[u.valueProp],searchable:n.searchable},e.$attrs),{option:F(a=>[i("div",Fe,[i("div",Oe,[i("div",qe,L(a.text),1),a!=null&&a.subText?(y(),S("div",Ne,L(a.subText),1)):B("",!0)])])]),"list-footer":F(()=>[b.value?(y(),S("li",{key:q.value,class:"loader"},"Loading...")):B("",!0)]),"no-options":F(()=>[!b.value&&H.value.length===0?(y(),S("div",{key:q.value},t[2]||(t[2]=[i("span",null,"No Matches found",-1)]))):B("",!0)]),_:1},16,["disabled","options","placeholder","clearable","onKeydown","label","modelValue","reduce","searchable"])],2),i("div",$e,[T(ye,{name:"fade"},{default:F(()=>[P(x)?(y(),S("span",Ee,L(P(x)),1)):B("",!0)]),_:1})])],64))}},Re=["onSubmit"],Ae=["onClick"],De={__name:"CustomForm",setup(u){const C=l(!0),O=Ce({location:ke().required("location is required")}),n=Se("api"),k=l(""),p=l([{text:"Select Location",value:0}]),c=l([{text:"Select Location",value:0}]),m=l(""),g=l(!1),_=l(null),w=l(!1);async function d(s,o){m.value=o,c.value=p.value,g.value=!0;const f=o&&o.trim()!==""?{LocationName:o}:{},h=await n.getPage({searchCriteria:f,pageNumber:s});w.value=!h.HasNextPage;const x=h.Items.map(v=>({text:v.LocationName,value:v.LocationID,subText:v.FormattedAddress}));c.value=[...x],g.value=!1}function b(s){alert(JSON.stringify(s,null,2))}function R(s,o){var h;(h=l(null).value)==null||h.reset(),C.value=!1,o({values:{location:""}}),setTimeout(()=>{s({location:""}),C.value=!0},500)}return Z(async()=>{g.value=!0;const s=await n.getPage({searchCriteria:{},pageNumber:1});w.value=!s.HasNextPage;const o=s.Items.map(f=>({text:f.LocationName,subText:f.FormattedAddress,value:f.LocationID}));c.value=[...o],g.value=!1}),(s,o)=>(y(),Pe(P(Le),{"validation-schema":P(O),as:"div"},{default:F(({handleSubmit:f,handleReset:h,setErrors:x})=>[i("form",{ref:"customFormRef",onSubmit:v=>f(v,b),style:{"border-color":"black","border-style":"dashed","border-width":"1px","border-radius":"1%","margin-top":"10%",padding:"10%",width:"500px"}},[o[1]||(o[1]=i("br",null,null,-1)),T(Te,{ref_key:"elLocation",ref:_,modelValue:k.value,"onUpdate:modelValue":o[0]||(o[0]=v=>k.value=v),name:"location",options:c.value,label:"Location:",labelProp:"text",valueProp:"value",paginate:!0,required:!0,searchable:!0,clearable:!0,isLastPage:w.value,loading:g.value,fetchPageCallBack:d,rules:"required",placeholder:"Select Location",style:{width:"100%"}},null,8,["modelValue","options","isLastPage","loading"]),o[2]||(o[2]=i("br",null,null,-1)),o[3]||(o[3]=i("button",null,"Submit",-1)),i("button",{onClick:z(v=>R(x,h),["prevent"])},"Reset",8,Ae)],40,Re)]),_:1},8,["validation-schema"]))}},He={name:"FiddleView",components:{CustomForm:De}},Me={class:"scrollable"},Ke={class:"h-100 d-flex align-items-top justify-content-center"};function Ue(u,C,O,n,k,p){const c=_e("CustomForm");return y(),S("div",Me,[i("div",Ke,[T(c)])])}const at=Be(He,[["render",Ue],["__scopeId","data-v-397f3d23"]]);export{at as default};
