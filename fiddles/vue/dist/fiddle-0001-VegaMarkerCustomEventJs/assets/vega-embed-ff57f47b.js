import{a as Be}from"./fast-json-patch-033b2d6f.js";import{s as de}from"./json-stringify-pretty-compact-c32375a1.js";import{v as Ke}from"./vega-67efe240.js";import{e as Je}from"./vega-interpreter-639133e5.js";import{v as Ze}from"./vega-lite-c92f86a8.js";import{e as Ve}from"./vega-schema-url-parser-6a596cb2.js";import{t as Qe}from"./vega-themes-b87a000a.js";import{H as ke}from"./vega-tooltip-3e36d24f.js";import{G as oe,O as He,x as et,C as tt,a9 as rt}from"./vega-util-7f144c9d.js";function ee(t){"@babel/helpers - typeof";return ee=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ee(t)}function it(t,e){if(ee(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(ee(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nt(t){var e=it(t,"string");return ee(e)==="symbol"?e:String(e)}function st(t,e,r){return e=nt(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function at(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var me,Se;function ot(){return Se||(Se=1,me=function(t){t.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}),me}var lt=g;g.Node=W;g.create=g;function g(t){var e=this;if(e instanceof g||(e=new g),e.tail=null,e.head=null,e.length=0,t&&typeof t.forEach=="function")t.forEach(function(s){e.push(s)});else if(arguments.length>0)for(var r=0,i=arguments.length;r<i;r++)e.push(arguments[r]);return e}g.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,r=t.prev;return e&&(e.prev=r),r&&(r.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=r),t.list.length--,t.next=null,t.prev=null,t.list=null,e};g.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}};g.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}};g.prototype.push=function(){for(var t=0,e=arguments.length;t<e;t++)ht(this,arguments[t]);return this.length};g.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)ut(this,arguments[t]);return this.length};g.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}};g.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}};g.prototype.forEach=function(t,e){e=e||this;for(var r=this.head,i=0;r!==null;i++)t.call(e,r.value,i,this),r=r.next};g.prototype.forEachReverse=function(t,e){e=e||this;for(var r=this.tail,i=this.length-1;r!==null;i--)t.call(e,r.value,i,this),r=r.prev};g.prototype.get=function(t){for(var e=0,r=this.head;r!==null&&e<t;e++)r=r.next;if(e===t&&r!==null)return r.value};g.prototype.getReverse=function(t){for(var e=0,r=this.tail;r!==null&&e<t;e++)r=r.prev;if(e===t&&r!==null)return r.value};g.prototype.map=function(t,e){e=e||this;for(var r=new g,i=this.head;i!==null;)r.push(t.call(e,i.value,this)),i=i.next;return r};g.prototype.mapReverse=function(t,e){e=e||this;for(var r=new g,i=this.tail;i!==null;)r.push(t.call(e,i.value,this)),i=i.prev;return r};g.prototype.reduce=function(t,e){var r,i=this.head;if(arguments.length>1)r=e;else if(this.head)i=this.head.next,r=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var s=0;i!==null;s++)r=t(r,i.value,s),i=i.next;return r};g.prototype.reduceReverse=function(t,e){var r,i=this.tail;if(arguments.length>1)r=e;else if(this.tail)i=this.tail.prev,r=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var s=this.length-1;i!==null;s--)r=t(r,i.value,s),i=i.prev;return r};g.prototype.toArray=function(){for(var t=new Array(this.length),e=0,r=this.head;r!==null;e++)t[e]=r.value,r=r.next;return t};g.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,r=this.tail;r!==null;e++)t[e]=r.value,r=r.prev;return t};g.prototype.slice=function(t,e){e=e||this.length,e<0&&(e+=this.length),t=t||0,t<0&&(t+=this.length);var r=new g;if(e<t||e<0)return r;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=0,s=this.head;s!==null&&i<t;i++)s=s.next;for(;s!==null&&i<e;i++,s=s.next)r.push(s.value);return r};g.prototype.sliceReverse=function(t,e){e=e||this.length,e<0&&(e+=this.length),t=t||0,t<0&&(t+=this.length);var r=new g;if(e<t||e<0)return r;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=this.length,s=this.tail;s!==null&&i>e;i--)s=s.prev;for(;s!==null&&i>t;i--,s=s.prev)r.push(s.value);return r};g.prototype.splice=function(t,e,...r){t>this.length&&(t=this.length-1),t<0&&(t=this.length+t);for(var i=0,s=this.head;s!==null&&i<t;i++)s=s.next;for(var n=[],i=0;s&&i<e;i++)n.push(s.value),s=this.removeNode(s);s===null&&(s=this.tail),s!==this.head&&s!==this.tail&&(s=s.prev);for(var i=0;i<r.length;i++)s=ct(this,s,r[i]);return n};g.prototype.reverse=function(){for(var t=this.head,e=this.tail,r=t;r!==null;r=r.prev){var i=r.prev;r.prev=r.next,r.next=i}return this.head=e,this.tail=t,this};function ct(t,e,r){var i=e===t.head?new W(r,null,e,t):new W(r,e,e.next,t);return i.next===null&&(t.tail=i),i.prev===null&&(t.head=i),t.length++,i}function ht(t,e){t.tail=new W(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function ut(t,e){t.head=new W(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function W(t,e,r,i){if(!(this instanceof W))return new W(t,e,r,i);this.list=i,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}try{ot()(g)}catch{}const ft=lt,H=Symbol("max"),j=Symbol("length"),M=Symbol("lengthCalculator"),k=Symbol("allowStale"),z=Symbol("maxAge"),U=Symbol("dispose"),Ae=Symbol("noDisposeOnSet"),b=Symbol("lruList"),D=Symbol("cache"),ze=Symbol("updateAgeOnGet"),ve=()=>1;class pt{constructor(e){if(typeof e=="number"&&(e={max:e}),e||(e={}),e.max&&(typeof e.max!="number"||e.max<0))throw new TypeError("max must be a non-negative number");this[H]=e.max||1/0;const r=e.length||ve;if(this[M]=typeof r!="function"?ve:r,this[k]=e.stale||!1,e.maxAge&&typeof e.maxAge!="number")throw new TypeError("maxAge must be a number");this[z]=e.maxAge||0,this[U]=e.dispose,this[Ae]=e.noDisposeOnSet||!1,this[ze]=e.updateAgeOnGet||!1,this.reset()}set max(e){if(typeof e!="number"||e<0)throw new TypeError("max must be a non-negative number");this[H]=e||1/0,Z(this)}get max(){return this[H]}set allowStale(e){this[k]=!!e}get allowStale(){return this[k]}set maxAge(e){if(typeof e!="number")throw new TypeError("maxAge must be a non-negative number");this[z]=e,Z(this)}get maxAge(){return this[z]}set lengthCalculator(e){typeof e!="function"&&(e=ve),e!==this[M]&&(this[M]=e,this[j]=0,this[b].forEach(r=>{r.length=this[M](r.value,r.key),this[j]+=r.length})),Z(this)}get lengthCalculator(){return this[M]}get length(){return this[j]}get itemCount(){return this[b].length}rforEach(e,r){r=r||this;for(let i=this[b].tail;i!==null;){const s=i.prev;Te(this,e,i,r),i=s}}forEach(e,r){r=r||this;for(let i=this[b].head;i!==null;){const s=i.next;Te(this,e,i,r),i=s}}keys(){return this[b].toArray().map(e=>e.key)}values(){return this[b].toArray().map(e=>e.value)}reset(){this[U]&&this[b]&&this[b].length&&this[b].forEach(e=>this[U](e.key,e.value)),this[D]=new Map,this[b]=new ft,this[j]=0}dump(){return this[b].map(e=>le(this,e)?!1:{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[b]}set(e,r,i){if(i=i||this[z],i&&typeof i!="number")throw new TypeError("maxAge must be a number");const s=i?Date.now():0,n=this[M](r,e);if(this[D].has(e)){if(n>this[H])return B(this,this[D].get(e)),!1;const l=this[D].get(e).value;return this[U]&&(this[Ae]||this[U](e,l.value)),l.now=s,l.maxAge=i,l.value=r,this[j]+=n-l.length,l.length=n,this.get(e),Z(this),!0}const a=new Et(e,r,n,s,i);return a.length>this[H]?(this[U]&&this[U](e,r),!1):(this[j]+=a.length,this[b].unshift(a),this[D].set(e,this[b].head),Z(this),!0)}has(e){if(!this[D].has(e))return!1;const r=this[D].get(e).value;return!le(this,r)}get(e){return ge(this,e,!0)}peek(e){return ge(this,e,!1)}pop(){const e=this[b].tail;return e?(B(this,e),e.value):null}del(e){B(this,this[D].get(e))}load(e){this.reset();const r=Date.now();for(let i=e.length-1;i>=0;i--){const s=e[i],n=s.e||0;if(n===0)this.set(s.k,s.v);else{const a=n-r;a>0&&this.set(s.k,s.v,a)}}}prune(){this[D].forEach((e,r)=>ge(this,r,!1))}}const ge=(t,e,r)=>{const i=t[D].get(e);if(i){const s=i.value;if(le(t,s)){if(B(t,i),!t[k])return}else r&&(t[ze]&&(i.value.now=Date.now()),t[b].unshiftNode(i));return s.value}},le=(t,e)=>{if(!e||!e.maxAge&&!t[z])return!1;const r=Date.now()-e.now;return e.maxAge?r>e.maxAge:t[z]&&r>t[z]},Z=t=>{if(t[j]>t[H])for(let e=t[b].tail;t[j]>t[H]&&e!==null;){const r=e.prev;B(t,e),e=r}},B=(t,e)=>{if(e){const r=e.value;t[U]&&t[U](r.key,r.value),t[j]-=r.length,t[D].delete(r.key),t[b].removeNode(e)}};class Et{constructor(e,r,i,s,n){this.key=e,this.value=r,this.length=i,this.now=s,this.maxAge=n||0}}const Te=(t,e,r,i)=>{let s=r.value;le(t,s)&&(B(t,r),t[k]||(s=void 0)),s&&e.call(i,s.value,s.key,t)};var dt=pt;const mt=Object.freeze({loose:!0}),vt=Object.freeze({}),gt=t=>t?typeof t!="object"?mt:t:vt;var Oe=gt,Re={exports:{}};const $t="2.0.0",It=256,Rt=Number.MAX_SAFE_INTEGER||9007199254740991,Ot=16,yt=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var ye={MAX_LENGTH:It,MAX_SAFE_COMPONENT_LENGTH:Ot,MAX_SAFE_INTEGER:Rt,RELEASE_TYPES:yt,SEMVER_SPEC_VERSION:$t,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2};const Lt=typeof process=="object"&&process.env&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};var he=Lt;(function(t,e){const{MAX_SAFE_COMPONENT_LENGTH:r}=ye,i=he;e=t.exports={};const s=e.re=[],n=e.src=[],a=e.t={};let $=0;const l=(P,u,I)=>{const L=$++;i(P,L,u),a[P]=L,n[L]=u,s[L]=new RegExp(u,I?"g":void 0)};l("NUMERICIDENTIFIER","0|[1-9]\\d*"),l("NUMERICIDENTIFIERLOOSE","[0-9]+"),l("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),l("MAINVERSION",`(${n[a.NUMERICIDENTIFIER]})\\.(${n[a.NUMERICIDENTIFIER]})\\.(${n[a.NUMERICIDENTIFIER]})`),l("MAINVERSIONLOOSE",`(${n[a.NUMERICIDENTIFIERLOOSE]})\\.(${n[a.NUMERICIDENTIFIERLOOSE]})\\.(${n[a.NUMERICIDENTIFIERLOOSE]})`),l("PRERELEASEIDENTIFIER",`(?:${n[a.NUMERICIDENTIFIER]}|${n[a.NONNUMERICIDENTIFIER]})`),l("PRERELEASEIDENTIFIERLOOSE",`(?:${n[a.NUMERICIDENTIFIERLOOSE]}|${n[a.NONNUMERICIDENTIFIER]})`),l("PRERELEASE",`(?:-(${n[a.PRERELEASEIDENTIFIER]}(?:\\.${n[a.PRERELEASEIDENTIFIER]})*))`),l("PRERELEASELOOSE",`(?:-?(${n[a.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${n[a.PRERELEASEIDENTIFIERLOOSE]})*))`),l("BUILDIDENTIFIER","[0-9A-Za-z-]+"),l("BUILD",`(?:\\+(${n[a.BUILDIDENTIFIER]}(?:\\.${n[a.BUILDIDENTIFIER]})*))`),l("FULLPLAIN",`v?${n[a.MAINVERSION]}${n[a.PRERELEASE]}?${n[a.BUILD]}?`),l("FULL",`^${n[a.FULLPLAIN]}$`),l("LOOSEPLAIN",`[v=\\s]*${n[a.MAINVERSIONLOOSE]}${n[a.PRERELEASELOOSE]}?${n[a.BUILD]}?`),l("LOOSE",`^${n[a.LOOSEPLAIN]}$`),l("GTLT","((?:<|>)?=?)"),l("XRANGEIDENTIFIERLOOSE",`${n[a.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),l("XRANGEIDENTIFIER",`${n[a.NUMERICIDENTIFIER]}|x|X|\\*`),l("XRANGEPLAIN",`[v=\\s]*(${n[a.XRANGEIDENTIFIER]})(?:\\.(${n[a.XRANGEIDENTIFIER]})(?:\\.(${n[a.XRANGEIDENTIFIER]})(?:${n[a.PRERELEASE]})?${n[a.BUILD]}?)?)?`),l("XRANGEPLAINLOOSE",`[v=\\s]*(${n[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${n[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${n[a.XRANGEIDENTIFIERLOOSE]})(?:${n[a.PRERELEASELOOSE]})?${n[a.BUILD]}?)?)?`),l("XRANGE",`^${n[a.GTLT]}\\s*${n[a.XRANGEPLAIN]}$`),l("XRANGELOOSE",`^${n[a.GTLT]}\\s*${n[a.XRANGEPLAINLOOSE]}$`),l("COERCE",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?(?:$|[^\\d])`),l("COERCERTL",n[a.COERCE],!0),l("LONETILDE","(?:~>?)"),l("TILDETRIM",`(\\s*)${n[a.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",l("TILDE",`^${n[a.LONETILDE]}${n[a.XRANGEPLAIN]}$`),l("TILDELOOSE",`^${n[a.LONETILDE]}${n[a.XRANGEPLAINLOOSE]}$`),l("LONECARET","(?:\\^)"),l("CARETTRIM",`(\\s*)${n[a.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",l("CARET",`^${n[a.LONECARET]}${n[a.XRANGEPLAIN]}$`),l("CARETLOOSE",`^${n[a.LONECARET]}${n[a.XRANGEPLAINLOOSE]}$`),l("COMPARATORLOOSE",`^${n[a.GTLT]}\\s*(${n[a.LOOSEPLAIN]})$|^$`),l("COMPARATOR",`^${n[a.GTLT]}\\s*(${n[a.FULLPLAIN]})$|^$`),l("COMPARATORTRIM",`(\\s*)${n[a.GTLT]}\\s*(${n[a.LOOSEPLAIN]}|${n[a.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",l("HYPHENRANGE",`^\\s*(${n[a.XRANGEPLAIN]})\\s+-\\s+(${n[a.XRANGEPLAIN]})\\s*$`),l("HYPHENRANGELOOSE",`^\\s*(${n[a.XRANGEPLAINLOOSE]})\\s+-\\s+(${n[a.XRANGEPLAINLOOSE]})\\s*$`),l("STAR","(<|>)?=?\\s*\\*"),l("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),l("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(Re,Re.exports);var Le=Re.exports;const be=/^[0-9]+$/,We=(t,e)=>{const r=be.test(t),i=be.test(e);return r&&i&&(t=+t,e=+e),t===e?0:r&&!i?-1:i&&!r?1:t<e?-1:1},Nt=(t,e)=>We(e,t);var St={compareIdentifiers:We,rcompareIdentifiers:Nt};const ne=he,{MAX_LENGTH:xe,MAX_SAFE_INTEGER:se}=ye,{re:we,t:Ce}=Le,At=Oe,{compareIdentifiers:Y}=St;let Tt=class G{constructor(e,r){if(r=At(r),e instanceof G){if(e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid Version: ${e}`);if(e.length>xe)throw new TypeError(`version is longer than ${xe} characters`);ne("SemVer",e,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;const i=e.trim().match(r.loose?we[Ce.LOOSE]:we[Ce.FULL]);if(!i)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>se||this.major<0)throw new TypeError("Invalid major version");if(this.minor>se||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>se||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map(s=>{if(/^[0-9]+$/.test(s)){const n=+s;if(n>=0&&n<se)return n}return s}):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(ne("SemVer.compare",this.version,this.options,e),!(e instanceof G)){if(typeof e=="string"&&e===this.version)return 0;e=new G(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof G||(e=new G(e,this.options)),Y(this.major,e.major)||Y(this.minor,e.minor)||Y(this.patch,e.patch)}comparePre(e){if(e instanceof G||(e=new G(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let r=0;do{const i=this.prerelease[r],s=e.prerelease[r];if(ne("prerelease compare",r,i,s),i===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(i===void 0)return-1;if(i===s)continue;return Y(i,s)}while(++r)}compareBuild(e){e instanceof G||(e=new G(e,this.options));let r=0;do{const i=this.build[r],s=e.build[r];if(ne("prerelease compare",r,i,s),i===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(i===void 0)return-1;if(i===s)continue;return Y(i,s)}while(++r)}inc(e,r,i){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r,i);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r,i);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r,i),this.inc("pre",r,i);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",r,i),this.inc("pre",r,i);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);s===-1&&this.prerelease.push(0)}if(r){const s=Number(i)?1:0;Y(this.prerelease[0],r)===0?isNaN(this.prerelease[1])&&(this.prerelease=[r,s]):this.prerelease=[r,s]}break;default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}};var Ne=Tt;const Pe=Ne,bt=(t,e,r)=>new Pe(t,r).compare(new Pe(e,r));var K=bt;const xt=K,wt=(t,e,r)=>xt(t,e,r)===0;var Ct=wt;const Pt=K,Dt=(t,e,r)=>Pt(t,e,r)!==0;var Ft=Dt;const Gt=K,_t=(t,e,r)=>Gt(t,e,r)>0;var Ut=_t;const jt=K,Xt=(t,e,r)=>jt(t,e,r)>=0;var Vt=Xt;const Ht=K,zt=(t,e,r)=>Ht(t,e,r)<0;var Wt=zt;const qt=K,Mt=(t,e,r)=>qt(t,e,r)<=0;var Yt=Mt;const Bt=Ct,Kt=Ft,Jt=Ut,Zt=Vt,Qt=Wt,kt=Yt,er=(t,e,r,i)=>{switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t===r;case"!==":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t!==r;case"":case"=":case"==":return Bt(t,r,i);case"!=":return Kt(t,r,i);case">":return Jt(t,r,i);case">=":return Zt(t,r,i);case"<":return Qt(t,r,i);case"<=":return kt(t,r,i);default:throw new TypeError(`Invalid operator: ${e}`)}};var tr=er,$e,De;function rr(){if(De)return $e;De=1;const t=Symbol("SemVer ANY");class e{static get ANY(){return t}constructor(u,I){if(I=r(I),u instanceof e){if(u.loose===!!I.loose)return u;u=u.value}a("comparator",u,I),this.options=I,this.loose=!!I.loose,this.parse(u),this.semver===t?this.value="":this.value=this.operator+this.semver.version,a("comp",this)}parse(u){const I=this.options.loose?i[s.COMPARATORLOOSE]:i[s.COMPARATOR],L=u.match(I);if(!L)throw new TypeError(`Invalid comparator: ${u}`);this.operator=L[1]!==void 0?L[1]:"",this.operator==="="&&(this.operator=""),L[2]?this.semver=new $(L[2],this.options.loose):this.semver=t}toString(){return this.value}test(u){if(a("Comparator.test",u,this.options.loose),this.semver===t||u===t)return!0;if(typeof u=="string")try{u=new $(u,this.options)}catch{return!1}return n(u,this.operator,this.semver,this.options)}intersects(u,I){if(!(u instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new l(u.value,I).test(this.value):u.operator===""?u.value===""?!0:new l(this.value,I).test(u.semver):(I=r(I),I.includePrerelease&&(this.value==="<0.0.0-0"||u.value==="<0.0.0-0")||!I.includePrerelease&&(this.value.startsWith("<0.0.0")||u.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&u.operator.startsWith(">")||this.operator.startsWith("<")&&u.operator.startsWith("<")||this.semver.version===u.semver.version&&this.operator.includes("=")&&u.operator.includes("=")||n(this.semver,"<",u.semver,I)&&this.operator.startsWith(">")&&u.operator.startsWith("<")||n(this.semver,">",u.semver,I)&&this.operator.startsWith("<")&&u.operator.startsWith(">")))}}$e=e;const r=Oe,{re:i,t:s}=Le,n=tr,a=he,$=Ne,l=qe();return $e}var Ie,Fe;function qe(){if(Fe)return Ie;Fe=1;class t{constructor(o,E){if(E=i(E),o instanceof t)return o.loose===!!E.loose&&o.includePrerelease===!!E.includePrerelease?o:new t(o.raw,E);if(o instanceof s)return this.raw=o.value,this.set=[[o]],this.format(),this;if(this.options=E,this.loose=!!E.loose,this.includePrerelease=!!E.includePrerelease,this.raw=o,this.set=o.split("||").map(f=>this.parseRange(f.trim())).filter(f=>f.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${o}`);if(this.set.length>1){const f=this.set[0];if(this.set=this.set.filter(p=>!V(p[0])),this.set.length===0)this.set=[f];else if(this.set.length>1){for(const p of this.set)if(p.length===1&&re(p[0])){this.set=[p];break}}}this.format()}format(){return this.range=this.set.map(o=>o.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(o){o=o.trim();const f=((this.options.includePrerelease&&L)|(this.options.loose&&F))+":"+o,p=r.get(f);if(p)return p;const h=this.options.loose,d=h?$[l.HYPHENRANGELOOSE]:$[l.HYPHENRANGE];o=o.replace(d,pe(this.options.includePrerelease)),n("hyphen replace",o),o=o.replace($[l.COMPARATORTRIM],P),n("comparator trim",o),o=o.replace($[l.TILDETRIM],u),o=o.replace($[l.CARETTRIM],I),o=o.split(/\s+/).join(" ");let R=o.split(" ").map(A=>w(A,this.options)).join(" ").split(/\s+/).map(A=>fe(A,this.options));h&&(R=R.filter(A=>(n("loose invalid filter",A,this.options),!!A.match($[l.COMPARATORLOOSE])))),n("range list",R);const m=new Map,y=R.map(A=>new s(A,this.options));for(const A of y){if(V(A))return[A];m.set(A.value,A)}m.size>1&&m.has("")&&m.delete("");const x=[...m.values()];return r.set(f,x),x}intersects(o,E){if(!(o instanceof t))throw new TypeError("a Range is required");return this.set.some(f=>ie(f,E)&&o.set.some(p=>ie(p,E)&&f.every(h=>p.every(d=>h.intersects(d,E)))))}test(o){if(!o)return!1;if(typeof o=="string")try{o=new a(o,this.options)}catch{return!1}for(let E=0;E<this.set.length;E++)if(Ee(this.set[E],o,this.options))return!0;return!1}}Ie=t;const e=dt,r=new e({max:1e3}),i=Oe,s=rr(),n=he,a=Ne,{re:$,t:l,comparatorTrimReplace:P,tildeTrimReplace:u,caretTrimReplace:I}=Le,{FLAG_INCLUDE_PRERELEASE:L,FLAG_LOOSE:F}=ye,V=c=>c.value==="<0.0.0-0",re=c=>c.value==="",ie=(c,o)=>{let E=!0;const f=c.slice();let p=f.pop();for(;E&&f.length;)E=f.every(h=>p.intersects(h,o)),p=f.pop();return E},w=(c,o)=>(n("comp",c,o),c=O(c,o),n("caret",c),c=q(c,o),n("tildes",c),c=v(c,o),n("xrange",c),c=C(c,o),n("stars",c),c),N=c=>!c||c.toLowerCase()==="x"||c==="*",q=(c,o)=>c.trim().split(/\s+/).map(E=>ue(E,o)).join(" "),ue=(c,o)=>{const E=o.loose?$[l.TILDELOOSE]:$[l.TILDE];return c.replace(E,(f,p,h,d,R)=>{n("tilde",c,f,p,h,d,R);let m;return N(p)?m="":N(h)?m=`>=${p}.0.0 <${+p+1}.0.0-0`:N(d)?m=`>=${p}.${h}.0 <${p}.${+h+1}.0-0`:R?(n("replaceTilde pr",R),m=`>=${p}.${h}.${d}-${R} <${p}.${+h+1}.0-0`):m=`>=${p}.${h}.${d} <${p}.${+h+1}.0-0`,n("tilde return",m),m})},O=(c,o)=>c.trim().split(/\s+/).map(E=>S(E,o)).join(" "),S=(c,o)=>{n("caret",c,o);const E=o.loose?$[l.CARETLOOSE]:$[l.CARET],f=o.includePrerelease?"-0":"";return c.replace(E,(p,h,d,R,m)=>{n("caret",c,p,h,d,R,m);let y;return N(h)?y="":N(d)?y=`>=${h}.0.0${f} <${+h+1}.0.0-0`:N(R)?h==="0"?y=`>=${h}.${d}.0${f} <${h}.${+d+1}.0-0`:y=`>=${h}.${d}.0${f} <${+h+1}.0.0-0`:m?(n("replaceCaret pr",m),h==="0"?d==="0"?y=`>=${h}.${d}.${R}-${m} <${h}.${d}.${+R+1}-0`:y=`>=${h}.${d}.${R}-${m} <${h}.${+d+1}.0-0`:y=`>=${h}.${d}.${R}-${m} <${+h+1}.0.0-0`):(n("no pr"),h==="0"?d==="0"?y=`>=${h}.${d}.${R}${f} <${h}.${d}.${+R+1}-0`:y=`>=${h}.${d}.${R}${f} <${h}.${+d+1}.0-0`:y=`>=${h}.${d}.${R} <${+h+1}.0.0-0`),n("caret return",y),y})},v=(c,o)=>(n("replaceXRanges",c,o),c.split(/\s+/).map(E=>T(E,o)).join(" ")),T=(c,o)=>{c=c.trim();const E=o.loose?$[l.XRANGELOOSE]:$[l.XRANGE];return c.replace(E,(f,p,h,d,R,m)=>{n("xRange",c,f,p,h,d,R,m);const y=N(h),x=y||N(d),A=x||N(R),J=A;return p==="="&&J&&(p=""),m=o.includePrerelease?"-0":"",y?p===">"||p==="<"?f="<0.0.0-0":f="*":p&&J?(x&&(d=0),R=0,p===">"?(p=">=",x?(h=+h+1,d=0,R=0):(d=+d+1,R=0)):p==="<="&&(p="<",x?h=+h+1:d=+d+1),p==="<"&&(m="-0"),f=`${p+h}.${d}.${R}${m}`):x?f=`>=${h}.0.0${m} <${+h+1}.0.0-0`:A&&(f=`>=${h}.${d}.0${m} <${h}.${+d+1}.0-0`),n("xRange return",f),f})},C=(c,o)=>(n("replaceStars",c,o),c.trim().replace($[l.STAR],"")),fe=(c,o)=>(n("replaceGTE0",c,o),c.trim().replace($[o.includePrerelease?l.GTE0PRE:l.GTE0],"")),pe=c=>(o,E,f,p,h,d,R,m,y,x,A,J,Ir)=>(N(f)?E="":N(p)?E=`>=${f}.0.0${c?"-0":""}`:N(h)?E=`>=${f}.${p}.0${c?"-0":""}`:d?E=`>=${E}`:E=`>=${E}${c?"-0":""}`,N(y)?m="":N(x)?m=`<${+y+1}.0.0-0`:N(A)?m=`<${y}.${+x+1}.0-0`:J?m=`<=${y}.${x}.${A}-${J}`:c?m=`<${y}.${x}.${+A+1}-0`:m=`<=${m}`,`${E} ${m}`.trim()),Ee=(c,o,E)=>{for(let f=0;f<c.length;f++)if(!c[f].test(o))return!1;if(o.prerelease.length&&!E.includePrerelease){for(let f=0;f<c.length;f++)if(n(c[f].semver),c[f].semver!==s.ANY&&c[f].semver.prerelease.length>0){const p=c[f].semver;if(p.major===o.major&&p.minor===o.minor&&p.patch===o.patch)return!0}return!1}return!0};return Ie}const ir=qe(),nr=(t,e,r)=>{try{e=new ir(e,r)}catch{return!1}return e.test(t)};var sr=nr,Me=at(sr);function ar(t,e,r){const i=t.open(e),s=1e4,n=250,{origin:a}=new URL(e);let $=~~(s/n);function l(u){u.source===i&&($=0,t.removeEventListener("message",l,!1))}t.addEventListener("message",l,!1);function P(){$<=0||(i.postMessage(r,a),setTimeout(P,n),$-=1)}setTimeout(P,n)}var or=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box;
}
.vega-embed.has-actions {
  padding-right: 38px;
}
.vega-embed details:not([open]) > :not(summary) {
  display: none !important;
}
.vega-embed summary {
  list-style: none;
  position: absolute;
  top: 0;
  right: 0;
  padding: 6px;
  z-index: 1000;
  background: white;
  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
  color: #1b1e23;
  border: 1px solid #aaa;
  border-radius: 999px;
  opacity: 0.2;
  transition: opacity 0.4s ease-in;
  cursor: pointer;
  line-height: 0px;
}
.vega-embed summary::-webkit-details-marker {
  display: none;
}
.vega-embed summary:active {
  box-shadow: #aaa 0px 0px 0px 1px inset;
}
.vega-embed summary svg {
  width: 14px;
  height: 14px;
}
.vega-embed details[open] summary {
  opacity: 0.7;
}
.vega-embed:hover summary, .vega-embed:focus-within summary {
  opacity: 1 !important;
  transition: opacity 0.2s ease;
}
.vega-embed .vega-actions {
  position: absolute;
  z-index: 1001;
  top: 35px;
  right: -9px;
  display: flex;
  flex-direction: column;
  padding-bottom: 8px;
  padding-top: 8px;
  border-radius: 4px;
  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
  border: 1px solid #d9d9d9;
  background: white;
  animation-duration: 0.15s;
  animation-name: scale-in;
  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
  text-align: left;
}
.vega-embed .vega-actions a {
  padding: 8px 16px;
  font-family: sans-serif;
  font-size: 14px;
  font-weight: 600;
  white-space: nowrap;
  color: #434a56;
  text-decoration: none;
}
.vega-embed .vega-actions a:hover, .vega-embed .vega-actions a:focus {
  background-color: #f7f7f9;
  color: black;
}
.vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
  content: "";
  display: inline-block;
  position: absolute;
}
.vega-embed .vega-actions::before {
  left: auto;
  right: 14px;
  top: -16px;
  border: 8px solid rgba(0, 0, 0, 0);
  border-bottom-color: #d9d9d9;
}
.vega-embed .vega-actions::after {
  left: auto;
  right: 15px;
  top: -14px;
  border: 7px solid rgba(0, 0, 0, 0);
  border-bottom-color: #fff;
}
.vega-embed .chart-wrapper.fit-x {
  width: 100%;
}
.vega-embed .chart-wrapper.fit-y {
  height: 100%;
}

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px;
}

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}
`;function Ye(t,...e){for(const r of e)lr(t,r);return t}function lr(t,e){for(const r of Object.keys(e))rt(t,r,e[r],!0)}function Ge(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,i)}return r}function X(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ge(Object(r),!0).forEach(function(i){st(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ge(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}const _=Ke;let te=Ze;const ae=typeof window<"u"?window:void 0;var Xe;te===void 0&&((Xe=ae==null?void 0:ae.vl)!=null&&Xe.compile)&&(te=ae.vl);const cr={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},hr={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},Q={vega:"Vega","vega-lite":"Vega-Lite"},ce={vega:_.version,"vega-lite":te?te.version:"not available"},ur={vega:t=>t,"vega-lite":(t,e)=>te.compile(t,{config:e}).spec},fr=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,pr="chart-wrapper";function Er(t){return typeof t=="function"}function _e(t,e,r,i){const s=`<html><head>${e}</head><body><pre><code class="json">`,n=`</code></pre>${r}</body></html>`,a=window.open("");a.document.write(s+t+n),a.document.title=`${Q[i]} JSON Source`}function dr(t,e){if(t.$schema){const r=Ve(t.$schema);e&&e!==r.library&&console.warn(`The given visualization spec is written in ${Q[r.library]}, but mode argument sets ${Q[e]??e}.`);const i=r.library;return Me(ce[i],`^${r.version.slice(1)}`)||console.warn(`The input spec uses ${Q[i]} ${r.version}, but the current version of ${Q[i]} is v${ce[i]}.`),i}return"mark"in t||"encoding"in t||"layer"in t||"hconcat"in t||"vconcat"in t||"facet"in t||"repeat"in t?"vega-lite":"marks"in t||"signals"in t||"scales"in t||"axes"in t?"vega":e??"vega"}function mr(t){return!!(t&&"load"in t)}function Ue(t){return mr(t)?t:_.loader(t)}function vr(t){var r;const e=((r=t.usermeta)==null?void 0:r.embedOptions)??{};return oe(e.defaultStyle)&&(e.defaultStyle=!1),e}async function xr(t,e,r={}){let i,s;oe(e)?(s=Ue(r.loader),i=JSON.parse(await s.load(e))):i=e;const n=vr(i),a=n.loader;(!s||a)&&(s=Ue(r.loader??a));const $=await je(n,s),l=await je(r,s),P=X(X({},Ye(l,$)),{},{config:He(l.config??{},$.config??{})});return await $r(t,i,P,s)}async function je(t,e){const r=oe(t.config)?JSON.parse(await e.load(t.config)):t.config??{},i=oe(t.patch)?JSON.parse(await e.load(t.patch)):t.patch;return X(X(X({},t),i?{patch:i}:{}),r?{config:r}:{})}function gr(t){const e=t.getRootNode?t.getRootNode():document;return e instanceof ShadowRoot?{root:e,rootContainer:e}:{root:document,rootContainer:document.head??document.body}}async function $r(t,e,r={},i){const s=r.theme?He(Qe[r.theme],r.config??{}):r.config,n=et(r.actions)?r.actions:Ye({},cr,r.actions??{}),a=X(X({},hr),r.i18n),$=r.renderer??"canvas",l=r.logLevel??_.Warn,P=r.downloadFileName??"visualization",u=typeof t=="string"?document.querySelector(t):t;if(!u)throw new Error(`${t} does not exist`);if(r.defaultStyle!==!1){const O="vega-embed-style",{root:S,rootContainer:v}=gr(u);if(!S.getElementById(O)){const T=document.createElement("style");T.id=O,T.innerHTML=r.defaultStyle===void 0||r.defaultStyle===!0?or.toString():r.defaultStyle,v.appendChild(T)}}const I=dr(e,r.mode);let L=ur[I](e,s);if(I==="vega-lite"&&L.$schema){const O=Ve(L.$schema);Me(ce.vega,`^${O.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${O.version}, but current version is v${ce.vega}.`)}u.classList.add("vega-embed"),n&&u.classList.add("has-actions"),u.innerHTML="";let F=u;if(n){const O=document.createElement("div");O.classList.add(pr),u.appendChild(O),F=O}const V=r.patch;if(V&&(L=V instanceof Function?V(L):Be(L,V,!0,!1).newDocument),r.formatLocale&&_.formatLocale(r.formatLocale),r.timeFormatLocale&&_.timeFormatLocale(r.timeFormatLocale),r.expressionFunctions)for(const O in r.expressionFunctions){const S=r.expressionFunctions[O];"fn"in S?_.expressionFunction(O,S.fn,S.visitor):S instanceof Function&&_.expressionFunction(O,S)}const{ast:re}=r,ie=_.parse(L,I==="vega-lite"?{}:s,{ast:re}),w=new(r.viewClass||_.View)(ie,X({loader:i,logLevel:l,renderer:$},re?{expr:_.expressionInterpreter??r.expr??Je}:{}));if(w.addSignalListener("autosize",(O,S)=>{const{type:v}=S;v=="fit-x"?(F.classList.add("fit-x"),F.classList.remove("fit-y")):v=="fit-y"?(F.classList.remove("fit-x"),F.classList.add("fit-y")):v=="fit"?F.classList.add("fit-x","fit-y"):F.classList.remove("fit-x","fit-y")}),r.tooltip!==!1){const O=Er(r.tooltip)?r.tooltip:new ke(r.tooltip===!0?{}:r.tooltip).call;w.tooltip(O)}let{hover:N}=r;if(N===void 0&&(N=I==="vega"),N){const{hoverSet:O,updateSet:S}=typeof N=="boolean"?{}:N;w.hover(O,S)}r&&(r.width!=null&&w.width(r.width),r.height!=null&&w.height(r.height),r.padding!=null&&w.padding(r.padding)),await w.initialize(F,r.bind).runAsync();let q;if(n!==!1){let O=u;if(r.defaultStyle!==!1){const v=document.createElement("details");v.title=a.CLICK_TO_VIEW_ACTIONS,u.append(v),O=v;const T=document.createElement("summary");T.innerHTML=fr,v.append(T),q=C=>{v.contains(C.target)||v.removeAttribute("open")},document.addEventListener("click",q)}const S=document.createElement("div");if(O.append(S),S.classList.add("vega-actions"),n===!0||n.export!==!1){for(const v of["svg","png"])if(n===!0||n.export===!0||n.export[v]){const T=a[`${v.toUpperCase()}_ACTION`],C=document.createElement("a"),fe=tt(r.scaleFactor)?r.scaleFactor[v]:r.scaleFactor;C.text=T,C.href="#",C.target="_blank",C.download=`${P}.${v}`,C.addEventListener("mousedown",async function(pe){pe.preventDefault();const Ee=await w.toImageURL(v,fe);this.href=Ee}),S.append(C)}}if(n===!0||n.source!==!1){const v=document.createElement("a");v.text=a.SOURCE_ACTION,v.href="#",v.addEventListener("click",function(T){_e(de(e),r.sourceHeader??"",r.sourceFooter??"",I),T.preventDefault()}),S.append(v)}if(I==="vega-lite"&&(n===!0||n.compiled!==!1)){const v=document.createElement("a");v.text=a.COMPILED_ACTION,v.href="#",v.addEventListener("click",function(T){_e(de(L),r.sourceHeader??"",r.sourceFooter??"","vega"),T.preventDefault()}),S.append(v)}if(n===!0||n.editor!==!1){const v=r.editorUrl??"https://vega.github.io/editor/",T=document.createElement("a");T.text=a.EDITOR_ACTION,T.href="#",T.addEventListener("click",function(C){ar(window,v,{config:s,mode:I,renderer:$,spec:de(e)}),C.preventDefault()}),S.append(T)}}function ue(){q&&document.removeEventListener("click",q),w.finalize()}return{view:w,spec:e,vgSpec:L,finalize:ue,embedOptions:r}}export{xr as e};
