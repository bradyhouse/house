class Ae extends Error{constructor(e,t){super(t),this.type=e}}class $ extends Ae{constructor(e,t){super("Configuration",e),this.node=t}}class Ge extends Ae{constructor(e){super("PopoutBlocked",e)}}class Ze extends Ae{constructor(e){super("Bind",e)}}class Ee extends Error{constructor(e,t,n){super(`${e}: ${t}${n===void 0?"":": "+n}`)}}class w extends Ee{constructor(e,t){super("Assert",e,t)}}class D extends Ee{constructor(e,t,n){super("UnreachableCase",e,`${t}${n===void 0?"":": "+n}`)}}class x extends Ee{constructor(e,t){super("UnexpectedNull",e,t)}}class v extends Ee{constructor(e,t){super("UnexpectedUndefined",e,t)}}var Ie;(function(r){let e=!1;const t={PopoutCannotBeCreatedWithGroundItemConfig:{id:0,default:"Popout cannot be created with ground ItemConfig"},PleaseRegisterAConstructorFunction:{id:1,default:"Please register a constructor function"},ComponentTypeNotRegisteredAndBindComponentEventHandlerNotAssigned:{id:2,default:"Component type not registered and BindComponentEvent handler not assigned"},ComponentIsAlreadyRegistered:{id:3,default:"Component is already registered"},ComponentIsNotVirtuable:{id:4,default:"Component is not virtuable. Requires rootHtmlElement field/getter"},VirtualComponentDoesNotHaveRootHtmlElement:{id:5,default:'Virtual component does not have getter "rootHtmlElement"'},ItemConfigIsNotTypeComponent:{id:6,default:"ItemConfig is not of type component"},InvalidNumberPartInSizeString:{id:7,default:"Invalid number part in size string"},UnknownUnitInSizeString:{id:8,default:"Unknown unit in size string"},UnsupportedUnitInSizeString:{id:9,default:"Unsupported unit in size string"}};r.idCount=Object.keys(t).length;const n=Object.values(t);function i(){if(!e)for(let s=0;s<r.idCount;s++){const o=n[s];if(o.id!==s)throw new w("INSI00110",`${s}: ${o.id}`);J[s]=o.default}e=!0}r.checkInitialise=i})(Ie||(Ie={}));const J=new Array(Ie.idCount);var le;(function(r){r.defaultComponentBaseZIndex="auto",r.defaultComponentDragZIndex="32",r.defaultComponentStackMaximisedZIndex="41"})(le||(le={}));var be;(function(r){r.width="width",r.height="height"})(be||(be={}));var Z;(function(r){r.top="top",r.left="left",r.right="right",r.bottom="bottom"})(Z||(Z={}));var de;(function(r){r.base="base",r.drag="drag",r.stackMaximised="stackMaximised"})(de||(de={}));const je={base:le.defaultComponentBaseZIndex,drag:le.defaultComponentDragZIndex,stackMaximised:le.defaultComponentStackMaximisedZIndex};var Re;(function(r){function e(n){return t(n)}r.isJson=e;function t(n){return!Array.isArray(n)&&n!==null&&typeof n=="object"}r.isJsonObject=t})(Re||(Re={}));var p;(function(r){r.ground="ground",r.row="row",r.column="column",r.stack="stack",r.component="component"})(p||(p={}));var ce;(function(r){r.none="none",r.always="always",r.onload="onload"})(ce||(ce={}));var y;(function(r){r.Pixel="px",r.Percent="%",r.Fractional="fr",r.Em="em"})(y||(y={}));(function(r){function e(n){switch(n){case r.Pixel:return r.Pixel;case r.Percent:return r.Percent;case r.Fractional:return r.Fractional;case r.Em:return r.Em;default:return}}r.tryParse=e;function t(n){switch(n){case r.Pixel:return r.Pixel;case r.Percent:return r.Percent;case r.Fractional:return r.Fractional;case r.Em:return r.Em;default:throw new D("SUEF44998",n)}}r.format=t})(y||(y={}));function S(r){return r.toString(10)+"px"}function ie(r){const e=r.replace("px","");return parseFloat(e)}function qe(r){r=r.trimStart();const e=r.length;if(e===0)return{numericPart:"",firstNonNumericCharPart:""};{let t=e,n=!1;for(let o=0;o<e;o++){const a=r[o];if(!Xe(a))if(a!=="."){t=o;break}else if(n){t=o;break}else n=!0}const i=r.substring(0,t),s=r.substring(t).trim();return{numericPart:i,firstNonNumericCharPart:s}}}function Xe(r){return r>="0"&&r<="9"}function Ye(r){return r.offsetWidth}function W(r,e){const t=S(e);r.style.width=t}function $e(r){return r.offsetHeight}function H(r,e){const t=S(e);r.style.height=t}function G(r){return{width:r.offsetWidth,height:r.offsetHeight}}function K(r,e){e?r.style.display="":r.style.display="none"}function X(r,e){if(e!==void 0){for(const t in e)if(e.hasOwnProperty(t)){const n=e[t],i=r[t];r[t]=ue(i,n)}}return r}function ue(r,e){if(typeof e!="object")return e;if(Array.isArray(e)){const t=e.length,n=new Array(t);for(let i=0;i<t;i++){const s=e[i];n[i]=ue({},s)}return n}else{if(e===null)return null;{const t=e;return r===void 0?X({},t):typeof r!="object"?X({},t):Array.isArray(r)?X({},t):X(r===null?{}:r,t)}}}function Je(r,e){const t=e.indexOf(r);if(t===-1)throw new Error("Can't remove item from array. Item is not in the array");e.splice(t,1)}function Ue(){return(Math.random()*1e15).toString(36).replace(".","")}function Ke(r){return r instanceof Error?r.message:typeof r=="string"?r:"Unknown Error"}var me;(function(r){const e=["settings","hasHeaders","constrainDragToContainer","selectionEnabled","dimensions","borderWidth","minItemHeight","minItemWidth","headerHeight","dragProxyWidth","dragProxyHeight","labels","close","maximise","minimise","popout","content","componentType","componentState","id","width","type","height","isClosable","title","popoutWholeStack","openPopouts","parentId","activeItemIndex","reorderEnabled","borderGrabWidth"],t=[!0,!1,"row","column","stack","component","close","maximise","minimise","open in new window"];function n(){if(e.length>36)throw new Error("Too many keys in config minifier map")}r.checkInitialise=n;function i(c,f){const _={};for(const C in c)if(c.hasOwnProperty(C)){let b;f?b=a(C):b=l(C);const E=c[C];_[b]=o(E,f)}return _}r.translateObject=i;function s(c,f){const _=c.length,C=new Array(_);for(let b=0;b<_;b++){const E=c[b];C[b]=o(E,f)}return C}function o(c,f){return typeof c=="object"?c===null?null:Array.isArray(c)?s(c,f):i(c,f):f?d(c):h(c)}function a(c){if(typeof c=="string"&&c.length===1)return"___"+c;const f=m(c);return f===-1?c:f.toString(36)}function l(c){return c.length===1?e[parseInt(c,36)]:c.substr(0,3)==="___"?c[3]:c}function d(c){if(typeof c=="string"&&c.length===1)return"___"+c;const f=u(c);return f===-1?c:f.toString(36)}function h(c){return typeof c=="string"&&c.length===1?t[parseInt(c,36)]:typeof c=="string"&&c.substr(0,3)==="___"?c[3]:c}function m(c){for(let f=0;f<e.length;f++)if(e[f]===c)return f;return-1}function u(c){for(let f=0;f<t.length;f++)if(t[f]===c)return f;return-1}})(me||(me={}));var I;(function(r){r.defaults={type:p.ground,content:[],size:1,sizeUnit:y.Fractional,minSize:void 0,minSizeUnit:y.Pixel,id:"",isClosable:!0};function e(o,a){switch(o.type){case p.ground:case p.row:case p.column:return oe.createCopy(o,a);case p.stack:return N.createCopy(o,a);case p.component:return se.createCopy(o);default:throw new D("CICC91354",o.type,"Invalid Config Item type specified")}}r.createCopy=e;function t(o){switch(o){case p.ground:throw new w("CICCDR91562");case p.row:case p.column:return oe.createDefault(o);case p.stack:return N.createDefault();case p.component:return se.createDefault();default:throw new D("CICCDD91563",o,"Invalid Config Item type specified")}}r.createDefault=t;function n(o){return o.type===p.component}r.isComponentItem=n;function i(o){return o.type===p.stack}r.isStackItem=i;function s(o){return o.type===p.ground}r.isGroundItem=s})(I||(I={}));var B;(function(r){r.defaultMaximised=!1,function(e){function t(n,i){if(n!==void 0)return{show:i??n.show,popout:n.popout,close:n.close,maximise:n.maximise,minimise:n.minimise,tabDropdown:n.tabDropdown}}e.createCopy=t}(r.Header||(r.Header={}))})(B||(B={}));var N;(function(r){r.defaultActiveItemIndex=0;function e(i,s){return{type:i.type,content:t(s!==void 0?s:i.content),size:i.size,sizeUnit:i.sizeUnit,minSize:i.minSize,minSizeUnit:i.minSizeUnit,id:i.id,maximised:i.maximised,isClosable:i.isClosable,activeItemIndex:i.activeItemIndex,header:B.Header.createCopy(i.header)}}r.createCopy=e;function t(i){const s=i.length,o=new Array(s);for(let a=0;a<s;a++)o[a]=I.createCopy(i[a]);return o}r.copyContent=t;function n(){return{type:p.stack,content:[],size:I.defaults.size,sizeUnit:I.defaults.sizeUnit,minSize:I.defaults.minSize,minSizeUnit:I.defaults.minSizeUnit,id:I.defaults.id,maximised:B.defaultMaximised,isClosable:I.defaults.isClosable,activeItemIndex:r.defaultActiveItemIndex,header:void 0}}r.createDefault=n})(N||(N={}));var se;(function(r){r.defaultReorderEnabled=!0;function e(s){const o=s.componentType;if(typeof o=="string")return o}r.resolveComponentTypeName=e;function t(s){return{type:s.type,content:[],size:s.size,sizeUnit:s.sizeUnit,minSize:s.minSize,minSizeUnit:s.minSizeUnit,id:s.id,maximised:s.maximised,isClosable:s.isClosable,reorderEnabled:s.reorderEnabled,title:s.title,header:B.Header.createCopy(s.header),componentType:s.componentType,componentState:ue(void 0,s.componentState)}}r.createCopy=t;function n(s="",o,a=""){return{type:p.component,content:[],size:I.defaults.size,sizeUnit:I.defaults.sizeUnit,minSize:I.defaults.minSize,minSizeUnit:I.defaults.minSizeUnit,id:I.defaults.id,maximised:B.defaultMaximised,isClosable:I.defaults.isClosable,reorderEnabled:r.defaultReorderEnabled,title:a,header:void 0,componentType:s,componentState:o}}r.createDefault=n;function i(s){return ue({},s)}r.copyComponentType=i})(se||(se={}));var oe;(function(r){function e(s){switch(s.type){case p.row:case p.column:case p.stack:case p.component:return!0;case p.ground:return!1;default:throw new D("CROCOSPCICIC13687",s.type)}}r.isChildItemConfig=e;function t(s,o){return{type:s.type,content:n(o!==void 0?o:s.content),size:s.size,sizeUnit:s.sizeUnit,minSize:s.minSize,minSizeUnit:s.minSizeUnit,id:s.id,isClosable:s.isClosable}}r.createCopy=t;function n(s){const o=s.length,a=new Array(o);for(let l=0;l<o;l++)a[l]=I.createCopy(s[l]);return a}r.copyContent=n;function i(s){return{type:s,content:[],size:I.defaults.size,sizeUnit:I.defaults.sizeUnit,minSize:I.defaults.minSize,minSizeUnit:I.defaults.minSizeUnit,id:I.defaults.id,isClosable:I.defaults.isClosable}}r.createDefault=i})(oe||(oe={}));var te;(function(r){function e(n){return I.createCopy(n)}r.createCopy=e;function t(n){switch(n.type){case p.row:case p.column:case p.stack:case p.component:return!0;case p.ground:return!1;default:throw new D("CROCOSPCICIC13687",n.type)}}r.isRootItemConfig=t})(te||(te={}));var Te;(function(r){function e(t){const n=t===void 0?[]:[t];return{type:p.ground,content:n,size:100,sizeUnit:y.Percent,minSize:0,minSizeUnit:y.Pixel,id:"",isClosable:!1,title:"",reorderEnabled:!1}}r.create=e})(Te||(Te={}));var g;(function(r){(function(a){a.defaults={constrainDragToContainer:!0,reorderEnabled:!0,popoutWholeStack:!1,blockedPopoutsThrowError:!0,closePopoutsOnUnload:!0,responsiveMode:ce.none,tabOverlapAllowance:0,reorderOnTabMenuClick:!0,tabControlOffset:10,popInOnClose:!1};function l(d){return{constrainDragToContainer:d.constrainDragToContainer,reorderEnabled:d.reorderEnabled,popoutWholeStack:d.popoutWholeStack,blockedPopoutsThrowError:d.blockedPopoutsThrowError,closePopoutsOnUnload:d.closePopoutsOnUnload,responsiveMode:d.responsiveMode,tabOverlapAllowance:d.tabOverlapAllowance,reorderOnTabMenuClick:d.reorderOnTabMenuClick,tabControlOffset:d.tabControlOffset,popInOnClose:d.popInOnClose}}a.createCopy=l})(r.Settings||(r.Settings={})),function(a){function l(d){return{borderWidth:d.borderWidth,borderGrabWidth:d.borderGrabWidth,defaultMinItemHeight:d.defaultMinItemHeight,defaultMinItemHeightUnit:d.defaultMinItemHeightUnit,defaultMinItemWidth:d.defaultMinItemWidth,defaultMinItemWidthUnit:d.defaultMinItemWidthUnit,headerHeight:d.headerHeight,dragProxyWidth:d.dragProxyWidth,dragProxyHeight:d.dragProxyHeight}}a.createCopy=l,a.defaults={borderWidth:5,borderGrabWidth:5,defaultMinItemHeight:0,defaultMinItemHeightUnit:y.Pixel,defaultMinItemWidth:10,defaultMinItemWidthUnit:y.Pixel,headerHeight:20,dragProxyWidth:300,dragProxyHeight:200}}(r.Dimensions||(r.Dimensions={})),function(a){function l(d){return{show:d.show,popout:d.popout,dock:d.dock,close:d.close,maximise:d.maximise,minimise:d.minimise,tabDropdown:d.tabDropdown}}a.createCopy=l,a.defaults={show:Z.top,popout:"open in new window",dock:"dock",maximise:"maximise",minimise:"minimise",close:"close",tabDropdown:"additional tabs"}}(r.Header||(r.Header={}));function e(a){return"parentId"in a}r.isPopout=e;function t(){return{root:void 0,openPopouts:[],dimensions:r.Dimensions.defaults,settings:r.Settings.defaults,header:r.Header.defaults,resolved:!0}}r.createDefault=t;function n(a){return e(a)?fe.createCopy(a):{root:a.root===void 0?void 0:te.createCopy(a.root),openPopouts:r.copyOpenPopouts(a.openPopouts),settings:r.Settings.createCopy(a.settings),dimensions:r.Dimensions.createCopy(a.dimensions),header:r.Header.createCopy(a.header),resolved:a.resolved}}r.createCopy=n;function i(a){const l=a.length,d=new Array(l);for(let h=0;h<l;h++)d[h]=fe.createCopy(a[h]);return d}r.copyOpenPopouts=i;function s(a){return me.translateObject(a,!0)}r.minifyConfig=s;function o(a){return me.translateObject(a,!1)}r.unminifyConfig=o})(g||(g={}));var fe;(function(r){(function(t){function n(i){return{width:i.width,height:i.height,left:i.left,top:i.top}}t.createCopy=n,t.defaults={width:null,height:null,left:null,top:null}})(r.Window||(r.Window={}));function e(t){return{root:t.root===void 0?void 0:te.createCopy(t.root),openPopouts:g.copyOpenPopouts(t.openPopouts),settings:g.Settings.createCopy(t.settings),dimensions:g.Dimensions.createCopy(t.dimensions),header:g.Header.createCopy(t.header),parentId:t.parentId,indexInParent:t.indexInParent,window:r.Window.createCopy(t.window),resolved:t.resolved}}r.createCopy=e})(fe||(fe={}));var z;(function(r){function e(u,c){switch(u.type){case p.ground:throw new $("ItemConfig cannot specify type ground",JSON.stringify(u));case p.row:case p.column:return ye.resolve(u,c);case p.stack:return pe.resolve(u,c);case p.component:return j.resolve(u,c);default:throw new D("UCUICR55499",u.type)}}r.resolve=e;function t(u){if(u===void 0)return[];{const c=u.length,f=new Array(c);for(let _=0;_<c;_++)f[_]=r.resolve(u[_],!1);return f}}r.resolveContent=t;function n(u){return u===void 0?I.defaults.id:Array.isArray(u)?u.length===0?I.defaults.id:u[0]:u}r.resolveId=n;function i(u,c,f,_){if(u!==void 0)return we(u,[y.Percent,y.Fractional]);if(c!==void 0||f!==void 0){if(c!==void 0)return{size:c,sizeUnit:y.Percent};if(f!==void 0)return{size:f,sizeUnit:y.Percent};throw new v("CRS33390")}else return _?{size:50,sizeUnit:y.Percent}:{size:I.defaults.size,sizeUnit:I.defaults.sizeUnit}}r.resolveSize=i;function s(u,c,f){if(u!==void 0)return we(u,[y.Pixel]);{const _=c!==void 0;return _||f!==void 0?_?{size:c,sizeUnit:y.Pixel}:{size:f,sizeUnit:y.Pixel}:{size:I.defaults.minSize,sizeUnit:I.defaults.minSizeUnit}}}r.resolveMinSize=s;function o(u){return u.size!==void 0?1:u.width!==void 0||u.height!==void 0?2:0}r.calculateSizeWidthHeightSpecificationType=o;function a(u){return u.type===p.ground}r.isGround=a;function l(u){return u.type===p.row}r.isRow=l;function d(u){return u.type===p.column}r.isColumn=d;function h(u){return u.type===p.stack}r.isStack=h;function m(u){return u.type===p.component}r.isComponent=m})(z||(z={}));var re;(function(r){const e="__glMaximised";(function(n){function i(s,o){var a;if(!(s===void 0&&o===void 0))return{show:(a=s==null?void 0:s.show)!==null&&a!==void 0?a:o===void 0?void 0:o?g.Header.defaults.show:!1,popout:s==null?void 0:s.popout,maximise:s==null?void 0:s.maximise,close:s==null?void 0:s.close,minimise:s==null?void 0:s.minimise,tabDropdown:s==null?void 0:s.tabDropdown}}n.resolve=i})(r.Header||(r.Header={}));function t(n){let i,s=n.id,o=!1;if(s===void 0)i=I.defaults.id;else if(Array.isArray(s)){const l=s.findIndex(d=>d===e);l>0&&(o=!0,s=s.splice(l,1)),s.length>0?i=s[0]:i=I.defaults.id}else i=s;let a;return n.maximised!==void 0?a=n.maximised:a=o,{id:i,maximised:a}}r.resolveIdAndMaximised=t})(re||(re={}));var pe;(function(r){function e(s,o){var a,l;const{id:d,maximised:h}=re.resolveIdAndMaximised(s),{size:m,sizeUnit:u}=z.resolveSize(s.size,s.width,s.height,o),{size:c,sizeUnit:f}=z.resolveMinSize(s.minSize,s.minWidth,s.minHeight);return{type:p.stack,content:n(s.content),size:m,sizeUnit:u,minSize:c,minSizeUnit:f,id:d,maximised:h,isClosable:(a=s.isClosable)!==null&&a!==void 0?a:I.defaults.isClosable,activeItemIndex:(l=s.activeItemIndex)!==null&&l!==void 0?l:N.defaultActiveItemIndex,header:re.Header.resolve(s.header,s.hasHeaders)}}r.resolve=e;function t(s){return{type:p.stack,content:i(s.content),size:_e(s.size,s.sizeUnit),minSize:De(s.minSize,s.minSizeUnit),id:s.id,maximised:s.maximised,isClosable:s.isClosable,activeItemIndex:s.activeItemIndex,header:B.Header.createCopy(s.header)}}r.fromResolved=t;function n(s){if(s===void 0)return[];{const o=s.length,a=new Array(o);for(let l=0;l<o;l++){const d=s[l],h=z.resolve(d,!1);if(I.isComponentItem(h))a[l]=h;else throw new w("UCUSICRC91114",JSON.stringify(h))}return a}}function i(s){const o=s.length,a=new Array(o);for(let l=0;l<o;l++){const d=s[l];a[l]=j.fromResolved(d)}return a}})(pe||(pe={}));var j;(function(r){function e(i,s){var o,a,l;let d=i.componentType;if(d===void 0&&(d=i.componentName),d===void 0)throw new Error("ComponentItemConfig.componentType is undefined");{const{id:h,maximised:m}=re.resolveIdAndMaximised(i);let u;i.title===void 0||i.title===""?u=r.componentTypeToTitle(d):u=i.title;const{size:c,sizeUnit:f}=z.resolveSize(i.size,i.width,i.height,s),{size:_,sizeUnit:C}=z.resolveMinSize(i.minSize,i.minWidth,i.minHeight);return{type:i.type,content:[],size:c,sizeUnit:f,minSize:_,minSizeUnit:C,id:h,maximised:m,isClosable:(o=i.isClosable)!==null&&o!==void 0?o:I.defaults.isClosable,reorderEnabled:(a=i.reorderEnabled)!==null&&a!==void 0?a:se.defaultReorderEnabled,title:u,header:re.Header.resolve(i.header,i.hasHeaders),componentType:d,componentState:(l=i.componentState)!==null&&l!==void 0?l:{}}}}r.resolve=e;function t(i){return{type:p.component,size:_e(i.size,i.sizeUnit),minSize:De(i.minSize,i.minSizeUnit),id:i.id,maximised:i.maximised,isClosable:i.isClosable,reorderEnabled:i.reorderEnabled,title:i.title,header:B.Header.createCopy(i.header),componentType:i.componentType,componentState:ue(void 0,i.componentState)}}r.fromResolved=t;function n(i){switch(typeof i){case"string":return i;case"number":return i.toString();case"boolean":return i.toString();default:return""}}r.componentTypeToTitle=n})(j||(j={}));var ye;(function(r){function e(o){switch(o.type){case p.row:case p.column:case p.stack:case p.component:return!0;case p.ground:return!1;default:throw new D("UROCOSPCICIC13687",o.type)}}r.isChildItemConfig=e;function t(o,a){var l;const{size:d,sizeUnit:h}=z.resolveSize(o.size,o.width,o.height,a),{size:m,sizeUnit:u}=z.resolveMinSize(o.minSize,o.minWidth,o.minHeight);return{type:o.type,content:r.resolveContent(o.content),size:d,sizeUnit:h,minSize:m,minSizeUnit:u,id:z.resolveId(o.id),isClosable:(l=o.isClosable)!==null&&l!==void 0?l:I.defaults.isClosable}}r.resolve=t;function n(o){return{type:o.type,content:s(o.content),size:_e(o.size,o.sizeUnit),minSize:De(o.minSize,o.minSizeUnit),id:o.id,isClosable:o.isClosable}}r.fromResolved=n;function i(o){if(o===void 0)return[];{const a=o.length,l=new Array(a);let d=!1,h=!1;for(let c=0;c<a;c++){const f=o[c];if(r.isChildItemConfig(f)){if(!h){const _=z.calculateSizeWidthHeightSpecificationType(f);switch(_){case 0:break;case 2:d=!0;break;case 1:h=!0;break;default:throw new D("ROCICRC87556",_)}}l[c]=f}else throw new $("ItemConfig is not Row, Column or Stack",f)}let m;h?m=!1:d?m=!0:m=!1;const u=new Array(a);for(let c=0;c<a;c++){const f=l[c],_=z.resolve(f,m);if(oe.isChildItemConfig(_))u[c]=_;else throw new w("UROCOSPIC99512",JSON.stringify(_))}return u}}r.resolveContent=i;function s(o){const a=o.length,l=new Array(a);for(let d=0;d<a;d++){const h=o[d],m=h.type;let u;switch(m){case p.row:case p.column:u=r.fromResolved(h);break;case p.stack:u=pe.fromResolved(h);break;case p.component:u=j.fromResolved(h);break;default:throw new D("ROCICFRC44797",m)}l[d]=u}return l}})(ye||(ye={}));var ae;(function(r){function e(i){switch(i.type){case p.row:case p.column:case p.stack:case p.component:return!0;case p.ground:return!1;default:throw new D("URICIR23687",i.type)}}r.isRootItemConfig=e;function t(i){if(i!==void 0){const s=z.resolve(i,!1);if(te.isRootItemConfig(s))return s;throw new $("ItemConfig is not Row, Column or Stack",JSON.stringify(i))}}r.resolve=t;function n(i){if(i!==void 0){const s=i.type;switch(s){case p.row:case p.column:return ye.fromResolved(i);case p.stack:return pe.fromResolved(i);case p.component:return j.fromResolved(i);default:throw new D("RICFROU89921",s)}}}r.fromResolvedOrUndefined=n})(ae||(ae={}));var U;(function(r){(function(o){function a(l){var d,h,m,u,c,f,_,C,b,E;return{constrainDragToContainer:(d=l==null?void 0:l.constrainDragToContainer)!==null&&d!==void 0?d:g.Settings.defaults.constrainDragToContainer,reorderEnabled:(h=l==null?void 0:l.reorderEnabled)!==null&&h!==void 0?h:g.Settings.defaults.reorderEnabled,popoutWholeStack:(m=l==null?void 0:l.popoutWholeStack)!==null&&m!==void 0?m:g.Settings.defaults.popoutWholeStack,blockedPopoutsThrowError:(u=l==null?void 0:l.blockedPopoutsThrowError)!==null&&u!==void 0?u:g.Settings.defaults.blockedPopoutsThrowError,closePopoutsOnUnload:(c=l==null?void 0:l.closePopoutsOnUnload)!==null&&c!==void 0?c:g.Settings.defaults.closePopoutsOnUnload,responsiveMode:(f=l==null?void 0:l.responsiveMode)!==null&&f!==void 0?f:g.Settings.defaults.responsiveMode,tabOverlapAllowance:(_=l==null?void 0:l.tabOverlapAllowance)!==null&&_!==void 0?_:g.Settings.defaults.tabOverlapAllowance,reorderOnTabMenuClick:(C=l==null?void 0:l.reorderOnTabMenuClick)!==null&&C!==void 0?C:g.Settings.defaults.reorderOnTabMenuClick,tabControlOffset:(b=l==null?void 0:l.tabControlOffset)!==null&&b!==void 0?b:g.Settings.defaults.tabControlOffset,popInOnClose:(E=l==null?void 0:l.popInOnClose)!==null&&E!==void 0?E:g.Settings.defaults.popInOnClose}}o.resolve=a})(r.Settings||(r.Settings={})),function(o){function a(m){var u,c,f,_,C;const{size:b,sizeUnit:E}=o.resolveDefaultMinItemHeight(m),{size:k,sizeUnit:R}=o.resolveDefaultMinItemWidth(m);return{borderWidth:(u=m==null?void 0:m.borderWidth)!==null&&u!==void 0?u:g.Dimensions.defaults.borderWidth,borderGrabWidth:(c=m==null?void 0:m.borderGrabWidth)!==null&&c!==void 0?c:g.Dimensions.defaults.borderGrabWidth,defaultMinItemHeight:b,defaultMinItemHeightUnit:E,defaultMinItemWidth:k,defaultMinItemWidthUnit:R,headerHeight:(f=m==null?void 0:m.headerHeight)!==null&&f!==void 0?f:g.Dimensions.defaults.headerHeight,dragProxyWidth:(_=m==null?void 0:m.dragProxyWidth)!==null&&_!==void 0?_:g.Dimensions.defaults.dragProxyWidth,dragProxyHeight:(C=m==null?void 0:m.dragProxyHeight)!==null&&C!==void 0?C:g.Dimensions.defaults.dragProxyHeight}}o.resolve=a;function l(m){return{borderWidth:m.borderWidth,borderGrabWidth:m.borderGrabWidth,defaultMinItemHeight:_e(m.defaultMinItemHeight,m.defaultMinItemHeightUnit),defaultMinItemWidth:_e(m.defaultMinItemWidth,m.defaultMinItemWidthUnit),headerHeight:m.headerHeight,dragProxyWidth:m.dragProxyWidth,dragProxyHeight:m.dragProxyHeight}}o.fromResolved=l;function d(m){const u=m==null?void 0:m.defaultMinItemHeight;return u===void 0?{size:g.Dimensions.defaults.defaultMinItemHeight,sizeUnit:g.Dimensions.defaults.defaultMinItemHeightUnit}:we(u,[y.Pixel])}o.resolveDefaultMinItemHeight=d;function h(m){const u=m==null?void 0:m.defaultMinItemWidth;return u===void 0?{size:g.Dimensions.defaults.defaultMinItemWidth,sizeUnit:g.Dimensions.defaults.defaultMinItemWidthUnit}:we(u,[y.Pixel])}o.resolveDefaultMinItemWidth=h}(r.Dimensions||(r.Dimensions={})),function(o){function a(l,d,h){var m,u,c,f,_,C,b,E,k,R,L,O;let T;return(l==null?void 0:l.show)!==void 0?T=l.show:d!==void 0&&d.hasHeaders!==void 0?T=d.hasHeaders?g.Header.defaults.show:!1:T=g.Header.defaults.show,{show:T,popout:(u=(m=l==null?void 0:l.popout)!==null&&m!==void 0?m:h==null?void 0:h.popout)!==null&&u!==void 0?u:(d==null?void 0:d.showPopoutIcon)===!1?!1:g.Header.defaults.popout,dock:(f=(c=l==null?void 0:l.popin)!==null&&c!==void 0?c:h==null?void 0:h.popin)!==null&&f!==void 0?f:g.Header.defaults.dock,maximise:(C=(_=l==null?void 0:l.maximise)!==null&&_!==void 0?_:h==null?void 0:h.maximise)!==null&&C!==void 0?C:(d==null?void 0:d.showMaximiseIcon)===!1?!1:g.Header.defaults.maximise,close:(E=(b=l==null?void 0:l.close)!==null&&b!==void 0?b:h==null?void 0:h.close)!==null&&E!==void 0?E:(d==null?void 0:d.showCloseIcon)===!1?!1:g.Header.defaults.close,minimise:(R=(k=l==null?void 0:l.minimise)!==null&&k!==void 0?k:h==null?void 0:h.minimise)!==null&&R!==void 0?R:g.Header.defaults.minimise,tabDropdown:(O=(L=l==null?void 0:l.tabDropdown)!==null&&L!==void 0?L:h==null?void 0:h.tabDropdown)!==null&&O!==void 0?O:g.Header.defaults.tabDropdown}}o.resolve=a}(r.Header||(r.Header={}));function e(o){return"parentId"in o||"indexInParent"in o||"window"in o}r.isPopout=e;function t(o){if(e(o))return he.resolve(o);{let a;return o.root!==void 0?a=o.root:o.content!==void 0&&o.content.length>0?a=o.content[0]:a=void 0,{resolved:!0,root:ae.resolve(a),openPopouts:r.resolveOpenPopouts(o.openPopouts),dimensions:r.Dimensions.resolve(o.dimensions),settings:r.Settings.resolve(o.settings),header:r.Header.resolve(o.header,o.settings,o.labels)}}}r.resolve=t;function n(o){return{root:ae.fromResolvedOrUndefined(o.root),openPopouts:he.fromResolvedArray(o.openPopouts),settings:g.Settings.createCopy(o.settings),dimensions:r.Dimensions.fromResolved(o.dimensions),header:g.Header.createCopy(o.header)}}r.fromResolved=n;function i(o){const a=o;return a.resolved!==void 0&&a.resolved===!0}r.isResolved=i;function s(o){if(o===void 0)return[];{const a=o.length,l=new Array(a);for(let d=0;d<a;d++)l[d]=he.resolve(o[d]);return l}}r.resolveOpenPopouts=s})(U||(U={}));var he;(function(r){(function(i){function s(a,l){var d,h,m,u,c,f,_,C;let b;const E=fe.Window.defaults;return a!==void 0?b={width:(d=a.width)!==null&&d!==void 0?d:E.width,height:(h=a.height)!==null&&h!==void 0?h:E.height,left:(m=a.left)!==null&&m!==void 0?m:E.left,top:(u=a.top)!==null&&u!==void 0?u:E.top}:b={width:(c=l==null?void 0:l.width)!==null&&c!==void 0?c:E.width,height:(f=l==null?void 0:l.height)!==null&&f!==void 0?f:E.height,left:(_=l==null?void 0:l.left)!==null&&_!==void 0?_:E.left,top:(C=l==null?void 0:l.top)!==null&&C!==void 0?C:E.top},b}i.resolve=s;function o(a){return{width:a.width===null?void 0:a.width,height:a.height===null?void 0:a.height,left:a.left===null?void 0:a.left,top:a.top===null?void 0:a.top}}i.fromResolved=o})(r.Window||(r.Window={}));function e(i){var s,o;let a;return i.root!==void 0?a=i.root:i.content!==void 0&&i.content.length>0?a=i.content[0]:a=void 0,{root:ae.resolve(a),openPopouts:U.resolveOpenPopouts(i.openPopouts),dimensions:U.Dimensions.resolve(i.dimensions),settings:U.Settings.resolve(i.settings),header:U.Header.resolve(i.header,i.settings,i.labels),parentId:(s=i.parentId)!==null&&s!==void 0?s:null,indexInParent:(o=i.indexInParent)!==null&&o!==void 0?o:null,window:r.Window.resolve(i.window,i.dimensions),resolved:!0}}r.resolve=e;function t(i){return{root:ae.fromResolvedOrUndefined(i.root),openPopouts:n(i.openPopouts),dimensions:U.Dimensions.fromResolved(i.dimensions),settings:g.Settings.createCopy(i.settings),header:g.Header.createCopy(i.header),parentId:i.parentId,indexInParent:i.indexInParent,window:r.Window.fromResolved(i.window)}}r.fromResolved=t;function n(i){const s=i.length,o=new Array(s);for(let a=0;a<s;a++){const l=i[a];o[a]=r.fromResolved(l)}return o}r.fromResolvedArray=n})(he||(he={}));function we(r,e){const{numericPart:t,firstNonNumericCharPart:n}=qe(r),i=Number.parseInt(t,10);if(isNaN(i))throw new $(`${J[7]}: ${r}`);{const s=y.tryParse(n);if(s===void 0)throw new $(`${J[8]}: ${r}`);if(e.includes(s))return{size:i,sizeUnit:s};throw new $(`${J[9]}: ${r}`)}}function _e(r,e){return r.toString(10)+y.format(e)}function De(r,e){if(r!==void 0)return r.toString(10)+y.format(e)}class M{constructor(){this._allEventSubscriptions=[],this._subscriptionsMap=new Map,this.unbind=this.removeEventListener,this.trigger=this.emit}tryBubbleEvent(e,t){}emit(e,...t){let n=this._subscriptionsMap.get(e);if(n!==void 0){n=n.slice();for(let i=0;i<n.length;i++){const s=n[i];s(...t)}}this.emitAllEvent(e,t),this.tryBubbleEvent(e,t)}emitUnknown(e,...t){let n=this._subscriptionsMap.get(e);if(n!==void 0){n=n.slice();for(let i=0;i<n.length;i++)n[i](...t)}this.emitAllEvent(e,t),this.tryBubbleEvent(e,t)}emitBaseBubblingEvent(e){const t=new M.BubblingEvent(e,this);this.emitUnknown(e,t)}emitUnknownBubblingEvent(e){const t=new M.BubblingEvent(e,this);this.emitUnknown(e,t)}removeEventListener(e,t){const n=t;this.removeUnknownEventListener(e,n)}off(e,t){this.removeEventListener(e,t)}addEventListener(e,t){const n=t;this.addUnknownEventListener(e,n)}on(e,t){this.addEventListener(e,t)}addUnknownEventListener(e,t){if(e===M.ALL_EVENT)this._allEventSubscriptions.push(t);else{let n=this._subscriptionsMap.get(e);n!==void 0?n.push(t):(n=[t],this._subscriptionsMap.set(e,n))}}removeUnknownEventListener(e,t){if(e===M.ALL_EVENT)this.removeSubscription(e,this._allEventSubscriptions,t);else{const n=this._subscriptionsMap.get(e);if(n===void 0)throw new Error("No subscribtions to unsubscribe for event "+e);this.removeSubscription(e,n,t)}}removeSubscription(e,t,n){const i=t.indexOf(n);if(i<0)throw new Error("Nothing to unbind for "+e);t.splice(i,1)}emitAllEvent(e,t){const n=this._allEventSubscriptions.length;if(n>0){const i=t.slice();i.unshift(e);const s=this._allEventSubscriptions.slice();for(let o=0;o<n;o++)s[o](...i)}}}(function(r){r.ALL_EVENT="__all",r.headerClickEventName="stackHeaderClick",r.headerTouchStartEventName="stackHeaderTouchStart";class e{constructor(s,o){this._name=s,this._target=o,this._isPropagationStopped=!1}get name(){return this._name}get target(){return this._target}get origin(){return this._target}get isPropagationStopped(){return this._isPropagationStopped}stopPropagation(){this._isPropagationStopped=!0}}r.BubblingEvent=e;class t extends e{constructor(s,o,a){super(s,o),this._mouseEvent=a}get mouseEvent(){return this._mouseEvent}}r.ClickBubblingEvent=t;class n extends e{constructor(s,o,a){super(s,o),this._touchEvent=a}get touchEvent(){return this._touchEvent}}r.TouchStartBubblingEvent=n})(M||(M={}));class Qe extends M{constructor(e,t,n,i,s,o,a,l,d){super(),this._config=e,this._parent=t,this._layoutManager=n,this._element=i,this._updateItemConfigEvent=s,this._showEvent=o,this._hideEvent=a,this._focusEvent=l,this._blurEvent=d,this._stackMaximised=!1,this._width=0,this._height=0,this._visible=!0,this._isShownWithZeroDimensions=!0,this._componentType=e.componentType,this._isClosable=e.isClosable,this._initialState=e.componentState,this._state=this._initialState,this._boundComponent=this.layoutManager.bindComponent(this,e),this.updateElementPositionPropertyFromBoundComponent()}get width(){return this._width}get height(){return this._height}get parent(){return this._parent}get componentName(){return this._componentType}get componentType(){return this._componentType}get virtual(){return this._boundComponent.virtual}get component(){return this._boundComponent.component}get tab(){return this._tab}get title(){return this._parent.title}get layoutManager(){return this._layoutManager}get isHidden(){return!this._visible}get visible(){return this._visible}get state(){return this._state}get initialState(){return this._initialState}get element(){return this._element}destroy(){this.releaseComponent(),this.stateRequestEvent=void 0,this.emit("destroy")}getElement(){return this._element}hide(){this._hideEvent()}show(){this._showEvent()}focus(e=!1){this._focusEvent(e)}blur(e=!1){this._blurEvent(e)}setSize(e,t){let n=this._parent;if(n.isColumn||n.isRow||n.parent===null)throw new w("ICSSPRC","ComponentContainer cannot have RowColumn Parent");{let i;do i=n,n=n.parent;while(n!==null&&!n.isColumn&&!n.isRow);if(n===null)return!1;{const s=n.isColumn?"height":"width",o=this[s];if(o===null)throw new x("ICSSCS11194");{const a=s==="height"?t:e,l=o*(1/(i.size/100)),d=a/l*100,h=(i.size-d)/(n.contentItems.length-1);for(let m=0;m<n.contentItems.length;m++){const u=n.contentItems[m];u===i?u.size=d:u.size+=h}return n.updateSize(!1),!0}}}}close(){this._isClosable&&(this.emit("close"),this._parent.close())}replaceComponent(e){if(this.releaseComponent(),z.isComponent(e)){const t=j.resolve(e,!1);if(this._initialState=t.componentState,this._state=this._initialState,this._componentType=t.componentType,this._updateItemConfigEvent(t),this._boundComponent=this.layoutManager.bindComponent(this,t),this.updateElementPositionPropertyFromBoundComponent(),this._boundComponent.virtual){if(this.virtualVisibilityChangeRequiredEvent!==void 0&&this.virtualVisibilityChangeRequiredEvent(this,this._visible),this.virtualRectingRequiredEvent!==void 0){this._layoutManager.fireBeforeVirtualRectingEvent(1);try{this.virtualRectingRequiredEvent(this,this._width,this._height)}finally{this._layoutManager.fireAfterVirtualRectingEvent()}}this.setBaseLogicalZIndex()}this.emit("stateChanged")}else throw new Error("ReplaceComponent not passed a component ItemConfig")}getState(){return this._state}extendState(e){const t=X(this._state,e);this.setState(t)}setState(e){this._state=e,this._parent.emitBaseBubblingEvent("stateChanged")}setTitle(e){this._parent.setTitle(e)}setTab(e){this._tab=e,this.emit("tab",e)}setVisibility(e){this._boundComponent.virtual&&this.virtualVisibilityChangeRequiredEvent!==void 0&&this.virtualVisibilityChangeRequiredEvent(this,e),e?this._visible?this._isShownWithZeroDimensions&&(this._height!==0||this._width!==0)&&(this._isShownWithZeroDimensions=!1,this.setSizeToNodeSize(this._width,this._height,!0),this.emitShow()):(this._visible=!0,this._height===0&&this._width===0?this._isShownWithZeroDimensions=!0:(this._isShownWithZeroDimensions=!1,this.setSizeToNodeSize(this._width,this._height,!0),this.emitShow())):this._visible&&(this._visible=!1,this._isShownWithZeroDimensions=!1,this.emitHide())}setBaseLogicalZIndex(){this.setLogicalZIndex(de.base)}setLogicalZIndex(e){e!==this._logicalZIndex&&(this._logicalZIndex=e,this.notifyVirtualZIndexChangeRequired())}enterDragMode(e,t){this._width=e,this._height=t,W(this._element,e),H(this._element,t),this.setLogicalZIndex(de.drag),this.drag()}exitDragMode(){this.setBaseLogicalZIndex()}enterStackMaximised(){this._stackMaximised=!0,this.setLogicalZIndex(de.stackMaximised)}exitStackMaximised(){this.setBaseLogicalZIndex(),this._stackMaximised=!1}drag(){if(this._boundComponent.virtual&&this.virtualRectingRequiredEvent!==void 0){this._layoutManager.fireBeforeVirtualRectingEvent(1);try{this.virtualRectingRequiredEvent(this,this._width,this._height)}finally{this._layoutManager.fireAfterVirtualRectingEvent()}}}setSizeToNodeSize(e,t,n){(e!==this._width||t!==this._height||n)&&(this._width=e,this._height=t,W(this._element,e),H(this._element,t),this._boundComponent.virtual?this.addVirtualSizedContainerToLayoutManager():(this.emit("resize"),this.checkShownFromZeroDimensions()))}notifyVirtualRectingRequired(){this.virtualRectingRequiredEvent!==void 0&&(this.virtualRectingRequiredEvent(this,this._width,this._height),this.emit("resize"),this.checkShownFromZeroDimensions())}notifyVirtualZIndexChangeRequired(){if(this.virtualZIndexChangeRequiredEvent!==void 0){const e=this._logicalZIndex,t=je[e];this.virtualZIndexChangeRequiredEvent(this,e,t)}}updateElementPositionPropertyFromBoundComponent(){this._boundComponent.virtual?this._element.style.position="static":this._element.style.position=""}addVirtualSizedContainerToLayoutManager(){this._layoutManager.beginVirtualSizedContainerAdding();try{this._layoutManager.addVirtualSizedContainer(this)}finally{this._layoutManager.endVirtualSizedContainerAdding()}}checkShownFromZeroDimensions(){this._isShownWithZeroDimensions&&(this._height!==0||this._width!==0)&&(this._isShownWithZeroDimensions=!1,this.emitShow())}emitShow(){this.emit("shown"),this.emit("show")}emitHide(){this.emit("hide")}releaseComponent(){this._stackMaximised&&this.exitStackMaximised(),this.emit("beforeComponentRelease",this._boundComponent.component),this.layoutManager.unbindComponent(this,this._boundComponent.virtual,this._boundComponent.component)}}class et extends M{constructor(e,t,n){super(),this._config=e,this._initialWindowSize=t,this._layoutManager=n,this._isInitialised=!1,this._popoutWindow=null,this.createWindow()}toConfig(){var e,t;if(this._isInitialised===!1)throw new Error("Can't create config, layout not yet initialised");const i=this.getGlInstance().saveLayout();let s,o;this._popoutWindow===null?(s=null,o=null):(s=(e=this._popoutWindow.screenX)!==null&&e!==void 0?e:this._popoutWindow.screenLeft,o=(t=this._popoutWindow.screenY)!==null&&t!==void 0?t:this._popoutWindow.screenTop);const a={width:this.getGlInstance().width,height:this.getGlInstance().height,left:s,top:o};return{root:i.root,openPopouts:i.openPopouts,settings:i.settings,dimensions:i.dimensions,header:i.header,window:a,parentId:this._config.parentId,indexInParent:this._config.indexInParent,resolved:!0}}getGlInstance(){if(this._popoutWindow===null)throw new x("BPGGI24693");return this._popoutWindow.__glInstance}getWindow(){if(this._popoutWindow===null)throw new x("BPGW087215");return this._popoutWindow}close(){if(this.getGlInstance())this.getGlInstance().closeWindow();else try{this.getWindow().close()}catch{}}popIn(){let e,t=this._config.indexInParent;if(!this._config.parentId)return;const n=this.getGlInstance().saveLayout(),s=X({},n).root;if(s===void 0)throw new v("BPPIR19998");const o=this._layoutManager.groundItem;if(o===void 0)throw new v("BPPIG34972");e=o.getItemsByPopInParentId(this._config.parentId)[0],e||(o.contentItems.length>0?e=o.contentItems[0]:e=o,t=0);const a=this._layoutManager.createAndInitContentItem(s,e);e.addChild(a,t),this._layoutManager.layoutConfig.settings.popInOnClose?this._onClose():this.close()}createWindow(){const e=this.createUrl(),t=Math.floor(Math.random()*1e6).toString(36),n=this.serializeWindowFeatures({width:this._initialWindowSize.width,height:this._initialWindowSize.height,innerWidth:this._initialWindowSize.width,innerHeight:this._initialWindowSize.height,menubar:"no",toolbar:"no",location:"no",personalbar:"no",resizable:"yes",scrollbars:"no",status:"no"});if(this._popoutWindow=globalThis.open(e,t,n),!this._popoutWindow){if(this._layoutManager.layoutConfig.settings.blockedPopoutsThrowError===!0)throw new Ge("Popout blocked");return}this._popoutWindow.addEventListener("load",()=>this.positionWindow(),{passive:!0}),this._popoutWindow.addEventListener("beforeunload",()=>{this._layoutManager.layoutConfig.settings.popInOnClose?this.popIn():this._onClose()},{passive:!0}),this._checkReadyInterval=setInterval(()=>this.checkReady(),10)}checkReady(){if(this._popoutWindow===null)throw new x("BPCR01844");this._popoutWindow.__glInstance&&this._popoutWindow.__glInstance.isInitialised&&(this.onInitialised(),this._checkReadyInterval!==void 0&&(clearInterval(this._checkReadyInterval),this._checkReadyInterval=void 0))}serializeWindowFeatures(e){const t=[];for(const n in e)t.push(n+"="+e[n].toString());return t.join(",")}createUrl(){const e="gl-window-config-"+Ue(),t=g.minifyConfig(this._config);try{localStorage.setItem(e,JSON.stringify(t))}catch(i){throw new Error("Error while writing to localStorage "+Ke(i))}const n=new URL(location.href);return n.searchParams.set("gl-window",e),n.toString()}positionWindow(){if(this._popoutWindow===null)throw new Error("BrowserPopout.positionWindow: null popoutWindow");this._popoutWindow.moveTo(this._initialWindowSize.left,this._initialWindowSize.top),this._popoutWindow.focus()}onInitialised(){this._isInitialised=!0,this.getGlInstance().on("popIn",()=>this.popIn()),this.emit("initialised")}_onClose(){setTimeout(()=>this.emit("closed"),50)}}class A extends M{constructor(e,t,n,i){super(),this.layoutManager=e,this._parent=n,this._element=i,this._popInParentIds=[],this._type=t.type,this._id=t.id,this._isInitialised=!1,this.isGround=!1,this.isRow=!1,this.isColumn=!1,this.isStack=!1,this.isComponent=!1,this.size=t.size,this.sizeUnit=t.sizeUnit,this.minSize=t.minSize,this.minSizeUnit=t.minSizeUnit,this._isClosable=t.isClosable,this._pendingEventPropagations={},this._throttledEvents=["stateChanged"],this._contentItems=this.createContentItems(t.content)}get type(){return this._type}get id(){return this._id}set id(e){this._id=e}get popInParentIds(){return this._popInParentIds}get parent(){return this._parent}get contentItems(){return this._contentItems}get isClosable(){return this._isClosable}get element(){return this._element}get isInitialised(){return this._isInitialised}static isStack(e){return e.isStack}static isComponentItem(e){return e.isComponent}static isComponentParentableItem(e){return e.isStack||e.isGround}removeChild(e,t=!1){const n=this._contentItems.indexOf(e);if(n===-1)throw new Error("Can't remove child item. Unknown content item");if(t||this._contentItems[n].destroy(),this._contentItems.splice(n,1),this._contentItems.length>0)this.updateSize(!1);else if(!this.isGround&&this._isClosable===!0){if(this._parent===null)throw new x("CIUC00874");this._parent.removeChild(this)}}addChild(e,t,n){return t??(t=this._contentItems.length),this._contentItems.splice(t,0,e),e.setParent(this),this._isInitialised===!0&&e._isInitialised===!1&&e.init(),t}replaceChild(e,t,n=!1){const i=this._contentItems.indexOf(e),s=e._element.parentNode;if(i===-1)throw new w("CIRCI23232","Can't replace child. oldChild is not child of this");if(s===null)throw new x("CIRCP23232");if(s.replaceChild(t._element,e._element),n===!0&&(e._parent=null,e.destroy()),this._contentItems[i]=t,t.setParent(this),t.size=e.size,t.sizeUnit=e.sizeUnit,t.minSize=e.minSize,t.minSizeUnit=e.minSizeUnit,t._parent===null)throw new x("CIRCNC45699");t._parent._isInitialised===!0&&t._isInitialised===!1&&t.init(),this.updateSize(!1)}remove(){if(this._parent===null)throw new x("CIR11110");this._parent.removeChild(this)}popout(){const e=Ue(),t=this.layoutManager.createPopoutFromContentItem(this,void 0,e,void 0);return this.emitBaseBubblingEvent("stateChanged"),t}calculateConfigContent(){const e=this._contentItems,t=e.length,n=new Array(t);for(let i=0;i<t;i++){const s=e[i];n[i]=s.toConfig()}return n}highlightDropZone(e,t,n){const i=this.layoutManager.dropTargetIndicator;if(i===null)throw new x("ACIHDZ5593");i.highlightArea(n,1)}onDrop(e,t){this.addChild(e)}show(){this.layoutManager.beginSizeInvalidation();try{K(this._element,!0);for(let e=0;e<this._contentItems.length;e++)this._contentItems[e].show()}finally{this.layoutManager.endSizeInvalidation()}}destroy(){for(let e=0;e<this._contentItems.length;e++)this._contentItems[e].destroy();this._contentItems=[],this.emitBaseBubblingEvent("beforeItemDestroyed"),this._element.remove(),this.emitBaseBubblingEvent("itemDestroyed")}getElementArea(e){e=e??this._element;const t=e.getBoundingClientRect(),n=t.top+document.body.scrollTop,i=t.left+document.body.scrollLeft,s=t.width,o=t.height;return{x1:i,y1:n,x2:i+s,y2:n+o,surface:s*o,contentItem:this}}init(){this._isInitialised=!0,this.emitBaseBubblingEvent("itemCreated"),this.emitUnknownBubblingEvent(this.type+"Created")}setParent(e){this._parent=e}addPopInParentId(e){this.popInParentIds.includes(e)||this.popInParentIds.push(e)}initContentItems(){for(let e=0;e<this._contentItems.length;e++)this._contentItems[e].init()}hide(){this.layoutManager.beginSizeInvalidation();try{K(this._element,!1)}finally{this.layoutManager.endSizeInvalidation()}}updateContentItemsSize(e){for(let t=0;t<this._contentItems.length;t++)this._contentItems[t].updateSize(e)}createContentItems(e){const t=e.length,n=new Array(t);for(let i=0;i<e.length;i++)n[i]=this.layoutManager.createContentItem(e[i],this);return n}propagateEvent(e,t){if(t.length===1){const n=t[0];n instanceof M.BubblingEvent&&n.isPropagationStopped===!1&&this._isInitialised===!0&&(this.isGround===!1&&this._parent?this._parent.emitUnknown(e,n):this.scheduleEventPropagationToLayoutManager(e,n))}}tryBubbleEvent(e,t){if(t.length===1){const n=t[0];n instanceof M.BubblingEvent&&n.isPropagationStopped===!1&&this._isInitialised===!0&&(this.isGround===!1&&this._parent?this._parent.emitUnknown(e,n):this.scheduleEventPropagationToLayoutManager(e,n))}}scheduleEventPropagationToLayoutManager(e,t){this._throttledEvents.indexOf(e)===-1?this.layoutManager.emitUnknown(e,t):this._pendingEventPropagations[e]!==!0&&(this._pendingEventPropagations[e]=!0,globalThis.requestAnimationFrame(()=>this.propagateEventToLayoutManager(e,t)))}propagateEventToLayoutManager(e,t){this._pendingEventPropagations[e]=!1,this.layoutManager.emitUnknown(e,t)}}class Y extends A{constructor(e,t,n){super(e,t,n,document.createElement("div")),this._parentItem=n,this._focused=!1,this.isComponent=!0,this._reorderEnabled=t.reorderEnabled,this.applyUpdatableConfig(t),this._initialWantMaximise=t.maximised;const i=document.createElement("div");i.classList.add("lm_content"),this.element.appendChild(i),this._container=new Qe(t,this,e,i,s=>this.handleUpdateItemConfigEvent(s),()=>this.show(),()=>this.hide(),s=>this.focus(s),s=>this.blur(s))}get componentName(){return this._container.componentType}get componentType(){return this._container.componentType}get reorderEnabled(){return this._reorderEnabled}get initialWantMaximise(){return this._initialWantMaximise}get component(){return this._container.component}get container(){return this._container}get parentItem(){return this._parentItem}get headerConfig(){return this._headerConfig}get title(){return this._title}get tab(){return this._tab}get focused(){return this._focused}destroy(){this._container.destroy(),super.destroy()}applyUpdatableConfig(e){this.setTitle(e.title),this._headerConfig=e.header}toConfig(){const e=this._container.stateRequestEvent,t=e===void 0?this._container.state:e();return{type:p.component,content:[],size:this.size,sizeUnit:this.sizeUnit,minSize:this.minSize,minSizeUnit:this.minSizeUnit,id:this.id,maximised:!1,isClosable:this.isClosable,reorderEnabled:this._reorderEnabled,title:this._title,header:B.Header.createCopy(this._headerConfig),componentType:se.copyComponentType(this.componentType),componentState:t}}close(){if(this.parent===null)throw new x("CIC68883");this.parent.removeChild(this,!1)}enterDragMode(e,t){W(this.element,e),H(this.element,t),this._container.enterDragMode(e,t)}exitDragMode(){this._container.exitDragMode()}enterStackMaximised(){this._container.enterStackMaximised()}exitStackMaximised(){this._container.exitStackMaximised()}drag(){this._container.drag()}updateSize(e){this.updateNodeSize(e)}init(){this.updateNodeSize(!1),super.init(),this._container.emit("open"),this.initContentItems()}setTitle(e){this._title=e,this.emit("titleChanged",e),this.emit("stateChanged")}setTab(e){this._tab=e,this.emit("tab",e),this._container.setTab(e)}hide(){super.hide(),this._container.setVisibility(!1)}show(){super.show(),this._container.setVisibility(!0)}focus(e=!1){this.parentItem.setActiveComponentItem(this,!0,e)}setFocused(e){this._focused=!0,this.tab.setFocused(),e||this.emitBaseBubblingEvent("focus")}blur(e=!1){this._focused&&this.layoutManager.setFocusedComponentItem(void 0,e)}setBlurred(e){this._focused=!1,this.tab.setBlurred(),e||this.emitBaseBubblingEvent("blur")}setParent(e){this._parentItem=e,super.setParent(e)}handleUpdateItemConfigEvent(e){this.applyUpdatableConfig(e)}updateNodeSize(e){if(this.element.style.display!=="none"){const{width:t,height:n}=G(this.element);this._container.setSizeToNodeSize(t,n,e)}}}class We extends A{constructor(){super(...arguments),this._focused=!1}get focused(){return this._focused}setFocusedValue(e){this._focused=e}}class ke extends M{constructor(e,t){super(),this._eElement=e,this._pointerTracking=!1,this._pointerDownEventListener=n=>this.onPointerDown(n),this._pointerMoveEventListener=n=>this.onPointerMove(n),this._pointerUpEventListener=n=>this.onPointerUp(n),this._timeout=void 0,this._allowableTargets=[e,...t],this._oDocument=document,this._eBody=document.body,this._nDelay=1800,this._nDistance=10,this._nX=0,this._nY=0,this._nOriginalX=0,this._nOriginalY=0,this._dragging=!1,this._eElement.addEventListener("pointerdown",this._pointerDownEventListener,{passive:!0})}destroy(){this.checkRemovePointerTrackingEventListeners(),this._eElement.removeEventListener("pointerdown",this._pointerDownEventListener)}cancelDrag(){this.processDragStop(void 0)}onPointerDown(e){if(this._allowableTargets.includes(e.target)&&e.isPrimary){const t=this.getPointerCoordinates(e);this.processPointerDown(t)}}processPointerDown(e){this._nOriginalX=e.x,this._nOriginalY=e.y,this._oDocument.addEventListener("pointermove",this._pointerMoveEventListener),this._oDocument.addEventListener("pointerup",this._pointerUpEventListener,{passive:!0}),this._pointerTracking=!0,this._timeout=setTimeout(()=>{try{this.startDrag()}catch(t){throw console.error(t),t}},this._nDelay)}onPointerMove(e){this._pointerTracking&&(this.processDragMove(e),e.preventDefault())}processDragMove(e){this._nX=e.pageX-this._nOriginalX,this._nY=e.pageY-this._nOriginalY,this._dragging===!1&&(Math.abs(this._nX)>this._nDistance||Math.abs(this._nY)>this._nDistance)&&this.startDrag(),this._dragging&&this.emit("drag",this._nX,this._nY,e)}onPointerUp(e){this.processDragStop(e)}processDragStop(e){var t;this._timeout!==void 0&&(clearTimeout(this._timeout),this._timeout=void 0),this.checkRemovePointerTrackingEventListeners(),this._dragging===!0&&(this._eBody.classList.remove("lm_dragging"),this._eElement.classList.remove("lm_dragging"),(t=this._oDocument.querySelector("iframe"))===null||t===void 0||t.style.setProperty("pointer-events",""),this._dragging=!1,this.emit("dragStop",e))}checkRemovePointerTrackingEventListeners(){this._pointerTracking&&(this._oDocument.removeEventListener("pointermove",this._pointerMoveEventListener),this._oDocument.removeEventListener("pointerup",this._pointerUpEventListener),this._pointerTracking=!1)}startDrag(){var e;this._timeout!==void 0&&(clearTimeout(this._timeout),this._timeout=void 0),this._dragging=!0,this._eBody.classList.add("lm_dragging"),this._eElement.classList.add("lm_dragging"),(e=this._oDocument.querySelector("iframe"))===null||e===void 0||e.style.setProperty("pointer-events","none"),this.emit("dragStart",this._nOriginalX,this._nOriginalY)}getPointerCoordinates(e){return{x:e.pageX,y:e.pageY}}}class tt{constructor(e,t,n){this._isVertical=e,this._size=t,this._grabSize=n<this._size?this._size:n,this._element=document.createElement("div"),this._element.classList.add("lm_splitter");const i=document.createElement("div");i.classList.add("lm_drag_handle");const s=this._grabSize-this._size,o=s/2;this._isVertical?(i.style.top=S(-o),i.style.height=S(this._size+s),this._element.classList.add("lm_vertical"),this._element.style.height=S(this._size)):(i.style.left=S(-o),i.style.width=S(this._size+s),this._element.classList.add("lm_horizontal"),this._element.style.width=S(this._size)),this._element.appendChild(i),this._dragListener=new ke(this._element,[i])}get element(){return this._element}destroy(){this._element.remove()}on(e,t){this._dragListener.on(e,t)}}class ne extends A{constructor(e,t,n,i){switch(super(t,n,i,ne.createElement(document,e)),this._rowOrColumnParent=i,this._splitter=[],this.isRow=!e,this.isColumn=e,this._childElementContainer=this.element,this._splitterSize=t.layoutConfig.dimensions.borderWidth,this._splitterGrabSize=t.layoutConfig.dimensions.borderGrabWidth,this._isColumn=e,this._dimension=e?"height":"width",this._splitterPosition=null,this._splitterMinPosition=null,this._splitterMaxPosition=null,n.type){case p.row:case p.column:this._configType=n.type;break;default:throw new w("ROCCCT00925")}}newComponent(e,t,n,i){const s={type:"component",componentType:e,componentState:t,title:n};return this.newItem(s,i)}addComponent(e,t,n,i){const s={type:"component",componentType:e,componentState:t,title:n};return this.addItem(s,i)}newItem(e,t){t=this.addItem(e,t);const n=this.contentItems[t];return A.isStack(n)&&z.isComponent(e)?n.contentItems[0]:n}addItem(e,t){this.layoutManager.checkMinimiseMaximisedStack();const n=z.resolve(e,!1),i=this.layoutManager.createAndInitContentItem(n,this);return this.addChild(i,t,!1)}addChild(e,t,n){if(t===void 0&&(t=this.contentItems.length),this.contentItems.length>0){const s=this.createSplitter(Math.max(0,t-1)).element;t>0?(this.contentItems[t-1].element.insertAdjacentElement("afterend",s),s.insertAdjacentElement("afterend",e.element)):(this.contentItems[0].element.insertAdjacentElement("beforebegin",s),s.insertAdjacentElement("beforebegin",e.element))}else this._childElementContainer.appendChild(e.element);super.addChild(e,t);const i=1/this.contentItems.length*100;if(n===!0)return this.emitBaseBubblingEvent("stateChanged"),t;for(let s=0;s<this.contentItems.length;s++){const o=this.contentItems[s];if(o===e)e.size=i;else{const a=o.size*=(100-i)/100;o.size=a}}return this.updateSize(!1),this.emitBaseBubblingEvent("stateChanged"),t}removeChild(e,t){const n=this.contentItems.indexOf(e),i=Math.max(n-1,0);if(n===-1)throw new Error("Can't remove child. ContentItem is not child of this Row or Column");if(this._splitter[i]&&(this._splitter[i].destroy(),this._splitter.splice(i,1)),super.removeChild(e,t),this.contentItems.length===1&&this.isClosable===!0){const s=this.contentItems[0];this.contentItems.length=0,this._rowOrColumnParent.replaceChild(this,s,!0)}else this.updateSize(!1),this.emitBaseBubblingEvent("stateChanged")}replaceChild(e,t){const n=e.size;super.replaceChild(e,t),t.size=n,this.updateSize(!1),this.emitBaseBubblingEvent("stateChanged")}updateSize(e){this.layoutManager.beginVirtualSizedContainerAdding();try{this.updateNodeSize(),this.updateContentItemsSize(e)}finally{this.layoutManager.endVirtualSizedContainerAdding()}}init(){if(this.isInitialised!==!0){this.updateNodeSize();for(let e=0;e<this.contentItems.length;e++)this._childElementContainer.appendChild(this.contentItems[e].element);super.init();for(let e=0;e<this.contentItems.length-1;e++)this.contentItems[e].element.insertAdjacentElement("afterend",this.createSplitter(e).element);this.initContentItems()}}toConfig(){return{type:this.type,content:this.calculateConfigContent(),size:this.size,sizeUnit:this.sizeUnit,minSize:this.minSize,minSizeUnit:this.minSizeUnit,id:this.id,isClosable:this.isClosable}}setParent(e){this._rowOrColumnParent=e,super.setParent(e)}updateNodeSize(){this.contentItems.length>0&&(this.calculateRelativeSizes(),this.setAbsoluteSizes()),this.emitBaseBubblingEvent("stateChanged"),this.emit("resize")}setAbsoluteSizes(){const e=this.calculateAbsoluteSizes();for(let t=0;t<this.contentItems.length;t++)e.additionalPixel-t>0&&e.itemSizes[t]++,this._isColumn?(W(this.contentItems[t].element,e.crossAxisSize),H(this.contentItems[t].element,e.itemSizes[t])):(W(this.contentItems[t].element,e.itemSizes[t]),H(this.contentItems[t].element,e.crossAxisSize))}calculateAbsoluteSizes(){const e=(this.contentItems.length-1)*this._splitterSize,{width:t,height:n}=G(this.element);let i,s;this._isColumn?(i=n-e,s=t):(i=t-e,s=n);let o=0;const a=[];for(let d=0;d<this.contentItems.length;d++){const h=this.contentItems[d];let m;if(h.sizeUnit===y.Percent)m=Math.floor(i*(h.size/100));else throw new w("ROCCAS6692");o+=m,a.push(m)}const l=Math.floor(i-o);return{itemSizes:a,additionalPixel:l,totalSize:i,crossAxisSize:s}}calculateRelativeSizes(){let e=0;const t=[];let n=0;for(let i=0;i<this.contentItems.length;i++){const s=this.contentItems[i];switch(s.sizeUnit){case y.Percent:{e+=s.size;break}case y.Fractional:{t.push(s),n+=s.size;break}default:throw new w("ROCCRS49110",JSON.stringify(s))}}if(Math.round(e)===100){this.respectMinItemSize();return}else if(Math.round(e)<100&&t.length>0){const i=100-e;for(let s=0;s<t.length;s++){const o=t[s];o.size=i*(o.size/n),o.sizeUnit=y.Percent}this.respectMinItemSize();return}else{if(Math.round(e)>100&&t.length>0){for(let i=0;i<t.length;i++){const s=t[i];s.size=50*(s.size/n),s.sizeUnit=y.Percent}e+=50}for(let i=0;i<this.contentItems.length;i++){const s=this.contentItems[i];s.size=s.size/e*100}this.respectMinItemSize()}}respectMinItemSize(){const e=this.calculateContentItemMinSize(this);if(!(e<=0||this.contentItems.length<=1)){let t=0,n=0;const i=[],s=[],o=this.calculateAbsoluteSizes();for(let a=0;a<o.itemSizes.length;a++){const l=o.itemSizes[a];let d;l<e?(n+=e-l,d={size:e}):(t+=l-e,d={size:l},i.push(d)),s.push(d)}if(n===0||n>t)return;{const a=n/t;let l=n;for(let d=0;d<i.length;d++){const h=i[d],m=Math.round((h.size-e)*a);l-=m,h.size-=m}l!==0&&(s[s.length-1].size-=l);for(let d=0;d<this.contentItems.length;d++){const h=this.contentItems[d];h.size=s[d].size/o.totalSize*100}}}}createSplitter(e){const t=new tt(this._isColumn,this._splitterSize,this._splitterGrabSize);return t.on("drag",(n,i)=>this.onSplitterDrag(t,n,i)),t.on("dragStop",()=>this.onSplitterDragStop(t)),t.on("dragStart",()=>this.onSplitterDragStart(t)),this._splitter.splice(e,0,t),t}getSplitItems(e){const t=this._splitter.indexOf(e);return{before:this.contentItems[t],after:this.contentItems[t+1]}}calculateContentItemMinSize(e){const t=e.minSize;if(t!==void 0){if(e.minSizeUnit===y.Pixel)return t;throw new w("ROCGMD98831",JSON.stringify(e))}else{const n=this.layoutManager.layoutConfig.dimensions;return this._isColumn?n.defaultMinItemHeight:n.defaultMinItemWidth}}calculateContentItemsTotalMinSize(e){let t=0;for(const n of e)t+=this.calculateContentItemMinSize(n);return t}onSplitterDragStart(e){const t=this.getSplitItems(e),n=ie(t.before.element.style[this._dimension]),i=ie(t.after.element.style[this._dimension]),s=this.calculateContentItemsTotalMinSize(t.before.contentItems),o=this.calculateContentItemsTotalMinSize(t.after.contentItems);this._splitterPosition=0,this._splitterMinPosition=-1*(n-s),this._splitterMaxPosition=i-o}onSplitterDrag(e,t,n){let i=this._isColumn?n:t;if(this._splitterMinPosition===null||this._splitterMaxPosition===null)throw new x("ROCOSD59226");i=Math.max(i,this._splitterMinPosition),i=Math.min(i,this._splitterMaxPosition),this._splitterPosition=i;const s=S(i);this._isColumn?e.element.style.top=s:e.element.style.left=s}onSplitterDragStop(e){if(this._splitterPosition===null)throw new x("ROCOSDS66932");{const t=this.getSplitItems(e),n=ie(t.before.element.style[this._dimension]),i=ie(t.after.element.style[this._dimension]),s=(this._splitterPosition+n)/(n+i),o=t.before.size+t.after.size;t.before.size=s*o,t.after.size=(1-s)*o,e.element.style.top=S(0),e.element.style.left=S(0),globalThis.requestAnimationFrame(()=>this.updateSize(!1))}}}(function(r){function e(i,s){return s==="width"?Ye(i):$e(i)}r.getElementDimensionSize=e;function t(i,s,o){return s==="width"?W(i,o):H(i,o)}r.setElementDimensionSize=t;function n(i,s){const o=i.createElement("div");return o.classList.add("lm_item"),s?o.classList.add("lm_column"):o.classList.add("lm_row"),o}r.createElement=n})(ne||(ne={}));class q extends We{constructor(e,t,n){super(e,Te.create(t),null,q.createElement(document)),this.isGround=!0,this._childElementContainer=this.element,this._containerElement=n;let i=null;for(;;){const s=i?i.previousSibling:this._containerElement.lastChild;if(s instanceof Element&&s.classList.contains("lm_content"))i=s;else break}this._containerElement.insertBefore(this.element,i)}init(){if(this.isInitialised!==!0){this.updateNodeSize();for(let e=0;e<this.contentItems.length;e++)this._childElementContainer.appendChild(this.contentItems[e].element);super.init(),this.initContentItems()}}loadRoot(e){if(this.clearRoot(),e!==void 0){const t=this.layoutManager.createAndInitContentItem(e,this);this.addChild(t,0)}}clearRoot(){const e=this.contentItems;switch(e.length){case 0:return;case 1:{e[0].remove();return}default:throw new w("GILR07721")}}addItem(e,t){this.layoutManager.checkMinimiseMaximisedStack();const n=z.resolve(e,!1);let i;if(this.contentItems.length>0?i=this.contentItems[0]:i=this,i.isComponent)throw new Error("Cannot add item as child to ComponentItem");{const s=this.layoutManager.createAndInitContentItem(n,i);return t=i.addChild(s,t),i===this?-1:t}}loadComponentAsRoot(e){this.clearRoot();const t=z.resolve(e,!1);if(t.maximised)throw new Error("Root Component cannot be maximised");{const n=new Y(this.layoutManager,t,this);n.init(),this.addChild(n,0)}}addChild(e,t){if(this.contentItems.length>0)throw new Error("Ground node can only have a single child");return this._childElementContainer.appendChild(e.element),t=super.addChild(e,t),this.updateSize(!1),this.emitBaseBubblingEvent("stateChanged"),t}calculateConfigContent(){const e=this.contentItems,t=e.length,n=new Array(t);for(let i=0;i<t;i++){const o=e[i].toConfig();if(te.isRootItemConfig(o))n[i]=o;else throw new w("RCCC66832")}return n}setSize(e,t){e===void 0||t===void 0?this.updateSize(!1):(W(this.element,e),H(this.element,t),this.contentItems.length>0&&(W(this.contentItems[0].element,e),H(this.contentItems[0].element,t)),this.updateContentItemsSize(!1))}updateSize(e){this.layoutManager.beginVirtualSizedContainerAdding();try{this.updateNodeSize(),this.updateContentItemsSize(e)}finally{this.layoutManager.endVirtualSizedContainerAdding()}}createSideAreas(){const t=q.Area.oppositeSides,n=new Array(Object.keys(t).length);let i=0;for(const s in t){const o=s,a=this.getElementArea();if(a===null)throw new x("RCSA77553");a.side=o,t[o][1]==="2"?a[o]=a[t[o]]-50:a[o]=a[t[o]]+50,a.surface=(a.x2-a.x1)*(a.y2-a.y1),n[i++]=a}return n}highlightDropZone(e,t,n){this.layoutManager.tabDropPlaceholder.remove(),super.highlightDropZone(e,t,n)}onDrop(e,t){if(e.isComponent){const n=N.createDefault(),i=e;n.header=B.Header.createCopy(i.headerConfig);const s=this.layoutManager.createAndInitContentItem(n,this);s.addChild(e),e=s}if(this.contentItems.length===0)this.addChild(e);else{if(e.type===p.row||e.type===p.column){const o=N.createDefault(),a=this.layoutManager.createContentItem(o,this);a.addChild(e),e=a}const n=t.side[0]=="x"?p.row:p.column,i=t.side[1]=="2",s=this.contentItems[0];if(!(s instanceof ne)||s.type!==n){const o=I.createDefault(n),a=this.layoutManager.createContentItem(o,this);this.replaceChild(s,a),a.addChild(e,i?0:void 0,!0),a.addChild(s,i?void 0:0,!0),s.size=50,e.size=50,e.sizeUnit=y.Percent,a.updateSize(!1)}else{const o=s.contentItems[i?0:s.contentItems.length-1];s.addChild(e,i?0:void 0,!0),o.size*=.5,e.size=o.size,e.sizeUnit=y.Percent,s.updateSize(!1)}}}dock(){throw new w("GID87731")}validateDocking(){throw new w("GIVD87732")}getAllContentItems(){const e=[this];return this.deepGetAllContentItems(this.contentItems,e),e}getConfigMaximisedItems(){const e=[];return this.deepFilterContentItems(this.contentItems,e,t=>A.isStack(t)&&t.initialWantMaximise?!0:!!(A.isComponentItem(t)&&t.initialWantMaximise)),e}getItemsByPopInParentId(e){const t=[];return this.deepFilterContentItems(this.contentItems,t,n=>n.popInParentIds.includes(e)),t}toConfig(){throw new Error("Cannot generate GroundItem config")}setActiveComponentItem(e,t,n){}updateNodeSize(){const{width:e,height:t}=G(this._containerElement);W(this.element,e),H(this.element,t),this.contentItems.length>0&&(W(this.contentItems[0].element,e),H(this.contentItems[0].element,t))}deepGetAllContentItems(e,t){for(let n=0;n<e.length;n++){const i=e[n];t.push(i),this.deepGetAllContentItems(i.contentItems,t)}}deepFilterContentItems(e,t,n){for(let i=0;i<e.length;i++){const s=e[i];n(s)&&t.push(s),this.deepFilterContentItems(s.contentItems,t,n)}}}(function(r){(function(t){t.oppositeSides={y2:"y1",x2:"x1",y1:"y2",x1:"x2"}})(r.Area||(r.Area={}));function e(t){const n=t.createElement("div");return n.classList.add("lm_goldenlayout"),n.classList.add("lm_item"),n.classList.add("lm_root"),n}r.createElement=e})(q||(q={}));class ve{constructor(e,t,n,i){this._header=e,this._pushEvent=i,this._clickEventListener=s=>this.onClick(s),this._touchStartEventListener=s=>this.onTouchStart(s),this._element=document.createElement("div"),this._element.classList.add(n),this._element.title=t,this._header.on("destroy",()=>this.destroy()),this._element.addEventListener("click",this._clickEventListener,{passive:!0}),this._element.addEventListener("touchstart",this._touchStartEventListener,{passive:!0}),this._header.controlsContainerElement.appendChild(this._element)}get element(){return this._element}destroy(){var e;this._element.removeEventListener("click",this._clickEventListener),this._element.removeEventListener("touchstart",this._touchStartEventListener),(e=this._element.parentNode)===null||e===void 0||e.removeChild(this._element)}onClick(e){this._pushEvent(e)}onTouchStart(e){this._pushEvent(e)}}class nt{constructor(e,t,n,i,s){var o;this._layoutManager=e,this._componentItem=t,this._closeEvent=n,this._focusEvent=i,this._dragStartEvent=s,this._isActive=!1,this._tabClickListener=l=>this.onTabClickDown(l),this._tabTouchStartListener=l=>this.onTabTouchStart(l),this._closeClickListener=()=>this.onCloseClick(),this._closeTouchStartListener=()=>this.onCloseTouchStart(),this._dragStartListener=(l,d)=>this.onDragStart(l,d),this._contentItemDestroyListener=()=>this.onContentItemDestroy(),this._tabTitleChangedListener=l=>this.setTitle(l),this._element=document.createElement("div"),this._element.classList.add("lm_tab"),this._titleElement=document.createElement("span"),this._titleElement.classList.add("lm_title"),this._closeElement=document.createElement("div"),this._closeElement.classList.add("lm_close_tab"),this._element.appendChild(this._titleElement),this._element.appendChild(this._closeElement),t.isClosable?this._closeElement.style.display="":this._closeElement.style.display="none",this.setTitle(t.title),this._componentItem.on("titleChanged",this._tabTitleChangedListener),((o=t.reorderEnabled)!==null&&o!==void 0?o:this._layoutManager.layoutConfig.settings.reorderEnabled)&&this.enableReorder(),this._element.addEventListener("click",this._tabClickListener,{passive:!0}),this._element.addEventListener("touchstart",this._tabTouchStartListener,{passive:!0}),this._componentItem.isClosable?(this._closeElement.addEventListener("click",this._closeClickListener,{passive:!0}),this._closeElement.addEventListener("touchstart",this._closeTouchStartListener,{passive:!0})):(this._closeElement.remove(),this._closeElement=void 0),this._componentItem.setTab(this),this._layoutManager.emit("tabCreated",this)}get isActive(){return this._isActive}get componentItem(){return this._componentItem}get contentItem(){return this._componentItem}get element(){return this._element}get titleElement(){return this._titleElement}get closeElement(){return this._closeElement}get reorderEnabled(){return this._dragListener!==void 0}set reorderEnabled(e){e!==this.reorderEnabled&&(e?this.enableReorder():this.disableReorder())}setTitle(e){this._titleElement.innerText=e,this._element.title=e}setActive(e){e!==this._isActive&&(this._isActive=e,e?this._element.classList.add("lm_active"):this._element.classList.remove("lm_active"))}destroy(){var e,t;this._closeEvent=void 0,this._focusEvent=void 0,this._dragStartEvent=void 0,this._element.removeEventListener("click",this._tabClickListener),this._element.removeEventListener("touchstart",this._tabTouchStartListener),(e=this._closeElement)===null||e===void 0||e.removeEventListener("click",this._closeClickListener),(t=this._closeElement)===null||t===void 0||t.removeEventListener("touchstart",this._closeTouchStartListener),this._componentItem.off("titleChanged",this._tabTitleChangedListener),this.reorderEnabled&&this.disableReorder(),this._element.remove()}setBlurred(){this._element.classList.remove("lm_focused"),this._titleElement.classList.remove("lm_focused")}setFocused(){this._element.classList.add("lm_focused"),this._titleElement.classList.add("lm_focused")}onDragStart(e,t){if(this._dragListener===void 0)throw new v("TODSDLU10093");if(this._dragStartEvent===void 0)throw new v("TODS23309");this._dragStartEvent(e,t,this._dragListener,this.componentItem)}onContentItemDestroy(){this._dragListener!==void 0&&(this._dragListener.destroy(),this._dragListener=void 0)}onTabClickDown(e){const t=e.target;(t===this._element||t===this._titleElement)&&(e.button===0?this.notifyFocus():e.button===1&&this._componentItem.isClosable&&this.notifyClose())}onTabTouchStart(e){e.target===this._element&&this.notifyFocus()}onCloseClick(){this.notifyClose()}onCloseTouchStart(){this.notifyClose()}notifyClose(){if(this._closeEvent===void 0)throw new v("TNC15007");this._closeEvent(this._componentItem)}notifyFocus(){if(this._focusEvent===void 0)throw new v("TNA15007");this._focusEvent(this._componentItem)}enableReorder(){this._dragListener=new ke(this._element,[this._titleElement]),this._dragListener.on("dragStart",this._dragStartListener),this._componentItem.on("destroy",this._contentItemDestroyListener)}disableReorder(){if(this._dragListener===void 0)throw new v("TDR87745");this._componentItem.off("destroy",this._contentItemDestroyListener),this._dragListener.off("dragStart",this._dragStartListener),this._dragListener=void 0}}class it{constructor(e,t,n,i,s){this._layoutManager=e,this._componentRemoveEvent=t,this._componentFocusEvent=n,this._componentDragStartEvent=i,this._dropdownActiveChangedEvent=s,this._tabs=[],this._lastVisibleTabIndex=-1,this._dropdownActive=!1,this._element=document.createElement("section"),this._element.classList.add("lm_tabs"),this._dropdownElement=document.createElement("section"),this._dropdownElement.classList.add("lm_tabdropdown_list"),this._dropdownElement.style.display="none"}get tabs(){return this._tabs}get tabCount(){return this._tabs.length}get lastVisibleTabIndex(){return this._lastVisibleTabIndex}get element(){return this._element}get dropdownElement(){return this._dropdownElement}get dropdownActive(){return this._dropdownActive}destroy(){for(let e=0;e<this._tabs.length;e++)this._tabs[e].destroy()}createTab(e,t){for(let i=0;i<this._tabs.length;i++)if(this._tabs[i].componentItem===e)return;const n=new nt(this._layoutManager,e,i=>this.handleTabCloseEvent(i),i=>this.handleTabFocusEvent(i),(i,s,o,a)=>this.handleTabDragStartEvent(i,s,o,a));t===void 0&&(t=this._tabs.length),this._tabs.splice(t,0,n),t<this._element.childNodes.length?this._element.insertBefore(n.element,this._element.childNodes[t]):this._element.appendChild(n.element)}removeTab(e){for(let t=0;t<this._tabs.length;t++)if(this._tabs[t].componentItem===e){this._tabs[t].destroy(),this._tabs.splice(t,1);return}throw new Error("contentItem is not controlled by this header")}processActiveComponentChanged(e){let t=-1;for(let n=0;n<this._tabs.length;n++){const i=this._tabs[n].componentItem===e;this._tabs[n].setActive(i),i&&(t=n)}if(t<0)throw new w("HSACI56632");if(this._layoutManager.layoutConfig.settings.reorderOnTabMenuClick&&this._lastVisibleTabIndex!==-1&&t>this._lastVisibleTabIndex){const n=this._tabs[t];for(let i=t;i>0;i--)this._tabs[i]=this._tabs[i-1];this._tabs[0]=n}}updateTabSizes(e,t){let n=!1;this.tryUpdateTabSizes(n,e,t)||(n=!0,this.tryUpdateTabSizes(n,e,t)),n!==this._dropdownActive&&(this._dropdownActive=n,this._dropdownActiveChangedEvent())}tryUpdateTabSizes(e,t,n){if(this._tabs.length>0){if(n===void 0)throw new Error("non-empty tabs must have active component item");let i=0,s=!1;const o=this._layoutManager.layoutConfig.settings.tabOverlapAllowance,a=this._tabs.indexOf(n.tab),l=this._tabs[a];this._lastVisibleTabIndex=-1;for(let d=0;d<this._tabs.length;d++){const h=this._tabs[d].element;h.parentElement!==this._element&&this._element.appendChild(h);const m=getComputedStyle(l.element).marginRight,u=ie(m),c=h.offsetWidth+u;i+=c;let f=0;if(a<=d)f=i;else{const _=getComputedStyle(l.element).marginRight,C=ie(_);f=i+l.element.offsetWidth+C}if(f>t){if(s)d===a&&(h.style.zIndex="auto",h.style.marginLeft="",h.parentElement!==this._element&&this._element.appendChild(h));else{let _;if(a>0&&a<=d?_=(f-t)/(d-1):_=(f-t)/d,_<o){for(let C=0;C<=d;C++){const b=C!==a&&C!==0?"-"+S(_):"";this._tabs[C].element.style.zIndex=S(d-C),this._tabs[C].element.style.marginLeft=b}this._lastVisibleTabIndex=d,h.parentElement!==this._element&&this._element.appendChild(h)}else s=!0}if(s&&d!==a)if(e)h.style.zIndex="auto",h.style.marginLeft="",h.parentElement!==this._dropdownElement&&this._dropdownElement.appendChild(h);else return!1}else this._lastVisibleTabIndex=d,h.style.zIndex="auto",h.style.marginLeft="",h.parentElement!==this._element&&this._element.appendChild(h)}}return!0}showAdditionalTabsDropdown(){this._dropdownElement.style.display=""}hideAdditionalTabsDropdown(){this._dropdownElement.style.display="none"}handleTabCloseEvent(e){this._componentRemoveEvent(e)}handleTabFocusEvent(e){this._componentFocusEvent(e)}handleTabDragStartEvent(e,t,n,i){this._componentDragStartEvent(e,t,n,i)}}class st extends M{constructor(e,t,n,i,s,o,a,l,d,h,m,u,c){super(),this._layoutManager=e,this._parent=t,this._configClosable=i,this._getActiveComponentItemEvent=s,this._popoutEvent=a,this._maximiseToggleEvent=l,this._clickEvent=d,this._touchStartEvent=h,this._componentRemoveEvent=m,this._componentFocusEvent=u,this._componentDragStartEvent=c,this._clickListener=f=>this.onClick(f),this._touchStartListener=f=>this.onTouchStart(f),this._rowColumnClosable=!0,this._closeButton=null,this._popoutButton=null,this._tabsContainer=new it(this._layoutManager,f=>this.handleTabInitiatedComponentRemoveEvent(f),f=>this.handleTabInitiatedComponentFocusEvent(f),(f,_,C,b)=>this.handleTabInitiatedDragStartEvent(f,_,C,b),()=>this.processTabDropdownActiveChanged()),this._show=n.show,this._popoutEnabled=n.popoutEnabled,this._popoutLabel=n.popoutLabel,this._maximiseEnabled=n.maximiseEnabled,this._maximiseLabel=n.maximiseLabel,this._minimiseEnabled=n.minimiseEnabled,this._minimiseLabel=n.minimiseLabel,this._closeEnabled=n.closeEnabled,this._closeLabel=n.closeLabel,this._tabDropdownEnabled=n.tabDropdownEnabled,this._tabDropdownLabel=n.tabDropdownLabel,this.setSide(n.side),this._canRemoveComponent=this._configClosable,this._element=document.createElement("section"),this._element.classList.add("lm_header"),this._controlsContainerElement=document.createElement("section"),this._controlsContainerElement.classList.add("lm_controls"),this._element.appendChild(this._tabsContainer.element),this._element.appendChild(this._controlsContainerElement),this._element.appendChild(this._tabsContainer.dropdownElement),this._element.addEventListener("click",this._clickListener,{passive:!0}),this._element.addEventListener("touchstart",this._touchStartListener,{passive:!0}),this._documentMouseUpListener=()=>this._tabsContainer.hideAdditionalTabsDropdown(),globalThis.document.addEventListener("mouseup",this._documentMouseUpListener,{passive:!0}),this._tabControlOffset=this._layoutManager.layoutConfig.settings.tabControlOffset,this._tabDropdownEnabled&&(this._tabDropdownButton=new ve(this,this._tabDropdownLabel,"lm_tabdropdown",()=>this._tabsContainer.showAdditionalTabsDropdown())),this._popoutEnabled&&(this._popoutButton=new ve(this,this._popoutLabel,"lm_popout",()=>this.handleButtonPopoutEvent())),this._maximiseEnabled&&(this._maximiseButton=new ve(this,this._maximiseLabel,"lm_maximise",f=>this.handleButtonMaximiseToggleEvent(f))),this._configClosable&&(this._closeButton=new ve(this,this._closeLabel,"lm_close",()=>o())),this.processTabDropdownActiveChanged()}get show(){return this._show}get side(){return this._side}get leftRightSided(){return this._leftRightSided}get layoutManager(){return this._layoutManager}get parent(){return this._parent}get tabs(){return this._tabsContainer.tabs}get lastVisibleTabIndex(){return this._tabsContainer.lastVisibleTabIndex}get element(){return this._element}get tabsContainerElement(){return this._tabsContainer.element}get controlsContainerElement(){return this._controlsContainerElement}destroy(){this.emit("destroy"),this._popoutEvent=void 0,this._maximiseToggleEvent=void 0,this._clickEvent=void 0,this._touchStartEvent=void 0,this._componentRemoveEvent=void 0,this._componentFocusEvent=void 0,this._componentDragStartEvent=void 0,this._tabsContainer.destroy(),globalThis.document.removeEventListener("mouseup",this._documentMouseUpListener),this._element.remove()}createTab(e,t){this._tabsContainer.createTab(e,t)}removeTab(e){this._tabsContainer.removeTab(e)}processActiveComponentChanged(e){this._tabsContainer.processActiveComponentChanged(e),this.updateTabSizes()}setSide(e){this._side=e,this._leftRightSided=[Z.right,Z.left].includes(this._side)}setRowColumnClosable(e){this._rowColumnClosable=e,this.updateClosability()}updateClosability(){let e;if(!this._configClosable)e=!1;else if(!this._rowColumnClosable)e=!1;else{e=!0;const t=this.tabs.length;for(let n=0;n<t;n++)if(!this._tabsContainer.tabs[n].componentItem.isClosable){e=!1;break}}this._closeButton!==null&&K(this._closeButton.element,e),this._popoutButton!==null&&K(this._popoutButton.element,e),this._canRemoveComponent=e||this._tabsContainer.tabCount>1}applyFocusedValue(e){e?this._element.classList.add("lm_focused"):this._element.classList.remove("lm_focused")}processMaximised(){if(this._maximiseButton===void 0)throw new v("HPMAX16997");this._maximiseButton.element.setAttribute("title",this._minimiseLabel)}processMinimised(){if(this._maximiseButton===void 0)throw new v("HPMIN16997");this._maximiseButton.element.setAttribute("title",this._maximiseLabel)}updateTabSizes(){if(this._tabsContainer.tabCount>0){const e=this._show?this._layoutManager.layoutConfig.dimensions.headerHeight:0;this._leftRightSided?(this._element.style.height="",this._element.style.width=S(e)):(this._element.style.width="",this._element.style.height=S(e));let t;this._leftRightSided?t=this._element.offsetHeight-this._controlsContainerElement.offsetHeight-this._tabControlOffset:t=this._element.offsetWidth-this._controlsContainerElement.offsetWidth-this._tabControlOffset,this._tabsContainer.updateTabSizes(t,this._getActiveComponentItemEvent())}}handleTabInitiatedComponentRemoveEvent(e){if(this._canRemoveComponent){if(this._componentRemoveEvent===void 0)throw new v("HHTCE22294");this._componentRemoveEvent(e)}}handleTabInitiatedComponentFocusEvent(e){if(this._componentFocusEvent===void 0)throw new v("HHTAE22294");this._componentFocusEvent(e)}handleTabInitiatedDragStartEvent(e,t,n,i){if(!this._canRemoveComponent)n.cancelDrag();else{if(this._componentDragStartEvent===void 0)throw new v("HHTDSE22294");this._componentDragStartEvent(e,t,n,i)}}processTabDropdownActiveChanged(){this._tabDropdownButton!==void 0&&K(this._tabDropdownButton.element,this._tabsContainer.dropdownActive)}handleButtonPopoutEvent(){if(this._layoutManager.layoutConfig.settings.popoutWholeStack){if(this._popoutEvent===void 0)throw new v("HHBPOE17834");this._popoutEvent()}else{const e=this._getActiveComponentItemEvent();e&&e.popout()}}handleButtonMaximiseToggleEvent(e){if(this._maximiseToggleEvent===void 0)throw new v("HHBMTE16834");this._maximiseToggleEvent()}onClick(e){e.target===this._element&&this.notifyClick(e)}onTouchStart(e){e.target===this._element&&this.notifyTouchStart(e)}notifyClick(e){if(this._clickEvent===void 0)throw new v("HNHC46834");this._clickEvent(e)}notifyTouchStart(e){if(this._touchStartEvent===void 0)throw new v("HNHTS46834");this._touchStartEvent(e)}}class V extends We{constructor(e,t,n){var i,s,o,a,l,d,h,m,u,c,f,_,C,b,E,k,R,L,O;super(e,t,n,V.createElement(document)),this._headerSideChanged=!1,this._resizeListener=()=>this.handleResize(),this._maximisedListener=()=>this.handleMaximised(),this._minimisedListener=()=>this.handleMinimised(),this._headerConfig=t.header;const T=e.layoutConfig.header,xe=t.content;let P;xe.length!==1?P=void 0:P=xe[0].header,this._initialWantMaximise=t.maximised,this._initialActiveItemIndex=(i=t.activeItemIndex)!==null&&i!==void 0?i:0;const ze=(a=(o=(s=this._headerConfig)===null||s===void 0?void 0:s.show)!==null&&o!==void 0?o:P==null?void 0:P.show)!==null&&a!==void 0?a:T.show,Me=(h=(d=(l=this._headerConfig)===null||l===void 0?void 0:l.popout)!==null&&d!==void 0?d:P==null?void 0:P.popout)!==null&&h!==void 0?h:T.popout,Pe=(c=(u=(m=this._headerConfig)===null||m===void 0?void 0:m.maximise)!==null&&u!==void 0?u:P==null?void 0:P.maximise)!==null&&c!==void 0?c:T.maximise,Ce=(C=(_=(f=this._headerConfig)===null||f===void 0?void 0:f.close)!==null&&_!==void 0?_:P==null?void 0:P.close)!==null&&C!==void 0?C:T.close,Be=(k=(E=(b=this._headerConfig)===null||b===void 0?void 0:b.minimise)!==null&&E!==void 0?E:P==null?void 0:P.minimise)!==null&&k!==void 0?k:T.minimise,Le=(O=(L=(R=this._headerConfig)===null||R===void 0?void 0:R.tabDropdown)!==null&&L!==void 0?L:P==null?void 0:P.tabDropdown)!==null&&O!==void 0?O:T.tabDropdown;this._maximisedEnabled=Pe!==!1;const Oe={show:ze!==!1,side:ze===!1?Z.top:ze,popoutEnabled:Me!==!1,popoutLabel:Me===!1?"":Me,maximiseEnabled:this._maximisedEnabled,maximiseLabel:Pe===!1?"":Pe,closeEnabled:Ce!==!1,closeLabel:Ce===!1?"":Ce,minimiseEnabled:!0,minimiseLabel:Be,tabDropdownEnabled:Le!==!1,tabDropdownLabel:Le===!1?"":Le};this._header=new st(e,this,Oe,t.isClosable&&Ce!==!1,()=>this.getActiveComponentItem(),()=>this.remove(),()=>this.handlePopoutEvent(),()=>this.toggleMaximise(),F=>this.handleHeaderClickEvent(F),F=>this.handleHeaderTouchStartEvent(F),F=>this.handleHeaderComponentRemoveEvent(F),F=>this.handleHeaderComponentFocusEvent(F),(F,Fe,Ve,Ne)=>this.handleHeaderComponentStartDragEvent(F,Fe,Ve,Ne)),this.isStack=!0,this._childElementContainer=document.createElement("section"),this._childElementContainer.classList.add("lm_items"),this.on("resize",this._resizeListener),this._maximisedEnabled&&(this.on("maximised",this._maximisedListener),this.on("minimised",this._minimisedListener)),this.element.appendChild(this._header.element),this.element.appendChild(this._childElementContainer),this.setupHeaderPosition(),this._header.updateClosability()}get childElementContainer(){return this._childElementContainer}get header(){return this._header}get headerShow(){return this._header.show}get headerSide(){return this._header.side}get headerLeftRightSided(){return this._header.leftRightSided}get contentAreaDimensions(){return this._contentAreaDimensions}get initialWantMaximise(){return this._initialWantMaximise}get isMaximised(){return this===this.layoutManager.maximisedStack}get stackParent(){if(!this.parent)throw new Error("Stack should always have a parent");return this.parent}updateSize(e){this.layoutManager.beginVirtualSizedContainerAdding();try{this.updateNodeSize(),this.updateContentItemsSize(e)}finally{this.layoutManager.endVirtualSizedContainerAdding()}}init(){if(this.isInitialised===!0)return;this.updateNodeSize();for(let n=0;n<this.contentItems.length;n++)this._childElementContainer.appendChild(this.contentItems[n].element);super.init();const e=this.contentItems,t=e.length;if(t>0){if(this._initialActiveItemIndex<0||this._initialActiveItemIndex>=t)throw new Error(`ActiveItemIndex out of range: ${this._initialActiveItemIndex} id: ${this.id}`);for(let n=0;n<t;n++){const i=e[n];if(i instanceof Y)this._header.createTab(i,n),i.hide(),i.container.setBaseLogicalZIndex();else throw new Error(`Stack Content Item is not of type ComponentItem: ${n} id: ${this.id}`)}this.setActiveComponentItem(e[this._initialActiveItemIndex],!1),this._header.updateTabSizes()}this._header.updateClosability(),this.initContentItems()}setActiveContentItem(e){if(A.isComponentItem(e))this.setActiveComponentItem(e,!1);else throw new Error("Stack.setActiveContentItem: item is not a ComponentItem")}setActiveComponentItem(e,t,n=!1){if(this._activeComponentItem!==e){if(this.contentItems.indexOf(e)===-1)throw new Error("componentItem is not a child of this stack");this.layoutManager.beginSizeInvalidation();try{this._activeComponentItem!==void 0&&this._activeComponentItem.hide(),this._activeComponentItem=e,this._header.processActiveComponentChanged(e),e.show()}finally{this.layoutManager.endSizeInvalidation()}this.emit("activeContentItemChanged",e),this.layoutManager.emit("activeContentItemChanged",e),this.emitStateChangedEvent()}(this.focused||t)&&this.layoutManager.setFocusedComponentItem(e,n)}getActiveContentItem(){var e;return(e=this.getActiveComponentItem())!==null&&e!==void 0?e:null}getActiveComponentItem(){return this._activeComponentItem}focusActiveContentItem(){var e;(e=this._activeComponentItem)===null||e===void 0||e.focus()}setFocusedValue(e){this._header.applyFocusedValue(e),super.setFocusedValue(e)}setRowColumnClosable(e){this._header.setRowColumnClosable(e)}newComponent(e,t,n,i){const s={type:"component",componentType:e,componentState:t,title:n};return this.newItem(s,i)}addComponent(e,t,n,i){const s={type:"component",componentType:e,componentState:t,title:n};return this.addItem(s,i)}newItem(e,t){return t=this.addItem(e,t),this.contentItems[t]}addItem(e,t){this.layoutManager.checkMinimiseMaximisedStack();const n=z.resolve(e,!1),i=this.layoutManager.createAndInitContentItem(n,this);return this.addChild(i,t)}addChild(e,t,n=!1){if(t!==void 0&&t>this.contentItems.length)throw t-=1,new w("SAC99728");if(e instanceof Y)return t=super.addChild(e,t),this._childElementContainer.appendChild(e.element),this._header.createTab(e,t),this.setActiveComponentItem(e,n),this._header.updateTabSizes(),this.updateSize(!1),e.container.setBaseLogicalZIndex(),this._header.updateClosability(),this.emitStateChangedEvent(),t;throw new w("SACC88532")}removeChild(e,t){const n=e,i=this.contentItems.indexOf(n),s=this.contentItems.length===1;if(this._activeComponentItem===n&&(n.focused&&n.blur(),!s)){const o=i===0?1:i-1;this.setActiveComponentItem(this.contentItems[o],!1)}this._header.removeTab(n),super.removeChild(n,t),s||this._header.updateClosability(),this.emitStateChangedEvent()}toggleMaximise(){this.isMaximised?this.minimise():this.maximise()}maximise(){if(!this.isMaximised){this.layoutManager.setMaximisedStack(this);const e=this.contentItems,t=e.length;for(let n=0;n<t;n++){const i=e[n];if(i instanceof Y)i.enterStackMaximised();else throw new w("SMAXI87773")}this.emitStateChangedEvent()}}minimise(){if(this.isMaximised){this.layoutManager.setMaximisedStack(void 0);const e=this.contentItems,t=e.length;for(let n=0;n<t;n++){const i=e[n];if(i instanceof Y)i.exitStackMaximised();else throw new w("SMINI87773")}this.emitStateChangedEvent()}}destroy(){var e;!((e=this._activeComponentItem)===null||e===void 0)&&e.focused&&this._activeComponentItem.blur(),super.destroy(),this.off("resize",this._resizeListener),this._maximisedEnabled&&(this.off("maximised",this._maximisedListener),this.off("minimised",this._minimisedListener)),this._header.destroy()}toConfig(){let e;if(this._activeComponentItem&&(e=this.contentItems.indexOf(this._activeComponentItem),e<0))throw new Error("active component item not found in stack");if(this.contentItems.length>0&&e===void 0)throw new Error("expected non-empty stack to have an active component item");return{type:"stack",content:this.calculateConfigContent(),size:this.size,sizeUnit:this.sizeUnit,minSize:this.minSize,minSizeUnit:this.minSizeUnit,id:this.id,isClosable:this.isClosable,maximised:this.isMaximised,header:this.createHeaderConfig(),activeItemIndex:e}}onDrop(e,t){if(this._dropSegment==="header"){if(this.resetHeaderDropZone(),this._dropIndex===void 0)throw new v("SODDI68990");this.addChild(e,this._dropIndex);return}if(this._dropSegment==="body"){this.addChild(e,0,!0);return}const n=this._dropSegment==="top"||this._dropSegment==="bottom",i=this._dropSegment==="left"||this._dropSegment==="right",s=this._dropSegment==="top"||this._dropSegment==="left",o=n&&this.stackParent.isColumn||i&&this.stackParent.isRow;if(e.isComponent){const a=N.createDefault();a.header=this.createHeaderConfig();const l=this.layoutManager.createAndInitContentItem(a,this);l.addChild(e),e=l}if(e.type===p.row||e.type===p.column){const a=N.createDefault();a.header=this.createHeaderConfig();const l=this.layoutManager.createContentItem(a,this);l.addChild(e),e=l}if(o){const a=this.stackParent.contentItems.indexOf(this);this.stackParent.addChild(e,s?a:a+1,!0),this.size*=.5,e.size=this.size,e.sizeUnit=this.sizeUnit,this.stackParent.updateSize(!1)}else{const a=n?p.column:p.row,l=I.createDefault(a),d=this.layoutManager.createContentItem(l,this);this.stackParent.replaceChild(this,d),d.addChild(e,s?0:void 0,!0),d.addChild(this,s?void 0:0,!0),this.size=50,e.size=50,e.sizeUnit=y.Percent,d.updateSize(!1)}}highlightDropZone(e,t){for(const n in this._contentAreaDimensions){const i=n,s=this._contentAreaDimensions[i].hoverArea;if(s.x1<e&&s.x2>e&&s.y1<t&&s.y2>t){i==="header"?(this._dropSegment="header",this.highlightHeaderDropZone(this._header.leftRightSided?t:e)):(this.resetHeaderDropZone(),this.highlightBodyDropZone(i));return}}}getArea(){if(this.element.style.display==="none")return null;const e=super.getElementArea(this._header.element),t=super.getElementArea(this._childElementContainer);if(e===null||t===null)throw new x("SGAHC13086");const n=t.x2-t.x1,i=t.y2-t.y1;return this._contentAreaDimensions={header:{hoverArea:{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2},highlightArea:{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2}}},this.contentItems.length===0?(this._contentAreaDimensions.body={hoverArea:{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2},highlightArea:{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}},super.getElementArea(this.element)):(this._contentAreaDimensions.left={hoverArea:{x1:t.x1,y1:t.y1,x2:t.x1+n*.25,y2:t.y2},highlightArea:{x1:t.x1,y1:t.y1,x2:t.x1+n*.5,y2:t.y2}},this._contentAreaDimensions.top={hoverArea:{x1:t.x1+n*.25,y1:t.y1,x2:t.x1+n*.75,y2:t.y1+i*.5},highlightArea:{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y1+i*.5}},this._contentAreaDimensions.right={hoverArea:{x1:t.x1+n*.75,y1:t.y1,x2:t.x2,y2:t.y2},highlightArea:{x1:t.x1+n*.5,y1:t.y1,x2:t.x2,y2:t.y2}},this._contentAreaDimensions.bottom={hoverArea:{x1:t.x1+n*.25,y1:t.y1+i*.5,x2:t.x1+n*.75,y2:t.y2},highlightArea:{x1:t.x1,y1:t.y1+i*.5,x2:t.x2,y2:t.y2}},super.getElementArea(this.element))}positionHeader(e){this._header.side!==e&&(this._header.setSide(e),this._headerSideChanged=!0,this.setupHeaderPosition())}updateNodeSize(){if(this.element.style.display!=="none"){const e=G(this.element);if(this._header.show){const t=this._header.leftRightSided?be.width:be.height;e[t]-=this.layoutManager.layoutConfig.dimensions.headerHeight}this._childElementContainer.style.width=S(e.width),this._childElementContainer.style.height=S(e.height);for(let t=0;t<this.contentItems.length;t++)this.contentItems[t].element.style.width=S(e.width),this.contentItems[t].element.style.height=S(e.height);this.emit("resize"),this.emitStateChangedEvent()}}highlightHeaderDropZone(e){const t=this._header.lastVisibleTabIndex+1,i=this._header.tabsContainerElement.childNodes,s=new Array(t);let o=0,a=0;for(;a<t;){const h=i[o++];h!==this.layoutManager.tabDropPlaceholder&&(s[a++]=h)}const l=this.layoutManager.dropTargetIndicator;if(l===null)throw new x("SHHDZDTI97110");let d;if(t===0){const h=this._header.element.getBoundingClientRect(),m=h.top+document.body.scrollTop,u=h.left+document.body.scrollLeft;d={x1:u,x2:u+100,y1:m+h.height-20,y2:m+h.height},this._dropIndex=0}else{let h=0,m=!1,u,c,f,_;do{_=s[h];const L=_.getBoundingClientRect(),O=L.top+document.body.scrollTop,T=L.left+document.body.scrollLeft;this._header.leftRightSided?(c=O,u=T,f=L.height):(c=T,u=O,f=L.width),e>=c&&e<c+f?m=!0:h++}while(h<t&&!m);if(m===!1&&e<c)return;const C=c+f/2;e<C?(this._dropIndex=h,_.insertAdjacentElement("beforebegin",this.layoutManager.tabDropPlaceholder)):(this._dropIndex=Math.min(h+1,t),_.insertAdjacentElement("afterend",this.layoutManager.tabDropPlaceholder));const b=this.layoutManager.tabDropPlaceholder.getBoundingClientRect(),E=b.top+document.body.scrollTop,k=b.left+document.body.scrollLeft,R=b.width;if(this._header.leftRightSided){const L=E;d={x1:u,x2:u+_.clientHeight,y1:L,y2:L+R}}else{const L=k;d={x1:L,x2:L+R,y1:u,y2:u+_.clientHeight}}}l.highlightArea(d,0)}resetHeaderDropZone(){this.layoutManager.tabDropPlaceholder.remove()}setupHeaderPosition(){K(this._header.element,this._header.show),this.element.classList.remove("lm_left","lm_right","lm_bottom"),this._header.leftRightSided&&this.element.classList.add("lm_"+this._header.side),this.updateSize(!1)}highlightBodyDropZone(e){if(this._contentAreaDimensions===void 0)throw new v("SHBDZC82265");{const t=this._contentAreaDimensions[e].highlightArea,n=this.layoutManager.dropTargetIndicator;if(n===null)throw new x("SHBDZD96110");n.highlightArea(t,1),this._dropSegment=e}}handleResize(){this._header.updateTabSizes()}handleMaximised(){this._header.processMaximised()}handleMinimised(){this._header.processMinimised()}handlePopoutEvent(){this.popout()}handleHeaderClickEvent(e){const t=M.headerClickEventName,n=new M.ClickBubblingEvent(t,this,e);this.emit(t,n)}handleHeaderTouchStartEvent(e){const t=M.headerTouchStartEventName,n=new M.TouchStartBubblingEvent(t,this,e);this.emit(t,n)}handleHeaderComponentRemoveEvent(e){this.removeChild(e,!1)}handleHeaderComponentFocusEvent(e){this.setActiveComponentItem(e,!0)}handleHeaderComponentStartDragEvent(e,t,n,i){this.isMaximised===!0&&this.toggleMaximise(),this.layoutManager.startComponentDrag(e,t,n,i,this)}createHeaderConfig(){if(this._headerSideChanged){const e=this._header.show?this._header.side:!1;let t=B.Header.createCopy(this._headerConfig,e);return t===void 0&&(t={show:e,popout:void 0,maximise:void 0,close:void 0,minimise:void 0,tabDropdown:void 0}),t}else return B.Header.createCopy(this._headerConfig)}emitStateChangedEvent(){this.emitBaseBubblingEvent("stateChanged")}}(function(r){function e(t){const n=t.createElement("div");return n.classList.add("lm_item"),n.classList.add("lm_stack"),n}r.createElement=e})(V||(V={}));class He extends M{constructor(e,t,n,i,s,o){if(super(),this._dragListener=n,this._layoutManager=i,this._componentItem=s,this._originalParent=o,this._area=null,this._lastValidArea=null,this._dragListener.on("drag",(a,l,d)=>this.onDrag(a,l,d)),this._dragListener.on("dragStop",()=>this.onDrop()),this.createDragProxyElements(e,t),this._componentItem.parent===null)throw new x("DPC10097");this._componentItemFocused=this._componentItem.focused,this._componentItemFocused&&this._componentItem.blur(),this._componentItem.parent.removeChild(this._componentItem,!0),this.setDimensions(),document.body.appendChild(this._element),this.determineMinMaxXY(),this._layoutManager.calculateItemAreas(),this.setDropPosition(e,t)}get element(){return this._element}createDragProxyElements(e,t){this._element=document.createElement("div"),this._element.classList.add("lm_dragProxy");const n=document.createElement("div");n.classList.add("lm_header");const i=document.createElement("div");i.classList.add("lm_tabs");const s=document.createElement("div");s.classList.add("lm_tab");const o=document.createElement("span");o.classList.add("lm_title"),s.appendChild(o),i.appendChild(s),n.appendChild(i),this._proxyContainerElement=document.createElement("div"),this._proxyContainerElement.classList.add("lm_content"),this._element.appendChild(n),this._element.appendChild(this._proxyContainerElement),this._originalParent instanceof V&&this._originalParent.headerShow&&(this._sided=this._originalParent.headerLeftRightSided,this._element.classList.add("lm_"+this._originalParent.headerSide),[Z.right,Z.bottom].indexOf(this._originalParent.headerSide)>=0&&this._proxyContainerElement.insertAdjacentElement("afterend",n)),this._element.style.left=S(e),this._element.style.top=S(t),s.setAttribute("title",this._componentItem.title),o.insertAdjacentText("afterbegin",this._componentItem.title),this._proxyContainerElement.appendChild(this._componentItem.element)}determineMinMaxXY(){const e=this._layoutManager.groundItem;if(e===void 0)throw new v("DPDMMXY73109");{const n=e.element.getBoundingClientRect();this._minX=n.left+document.body.scrollLeft,this._minY=n.top+document.body.scrollTop,this._maxX=this._minX+n.width,this._maxY=this._minY+n.height}}onDrag(e,t,n){const i=n.pageX,s=n.pageY;this.setDropPosition(i,s),this._componentItem.drag()}setDropPosition(e,t){this._layoutManager.layoutConfig.settings.constrainDragToContainer&&(e<=this._minX?e=Math.ceil(this._minX):e>=this._maxX&&(e=Math.floor(this._maxX)),t<=this._minY?t=Math.ceil(this._minY):t>=this._maxY&&(t=Math.floor(this._maxY))),this._element.style.left=S(e),this._element.style.top=S(t),this._area=this._layoutManager.getArea(e,t),this._area!==null&&(this._lastValidArea=this._area,this._area.contentItem.highlightDropZone(e,t,this._area))}onDrop(){const e=this._layoutManager.dropTargetIndicator;if(e===null)throw new x("DPOD30011");e.hide(),this._componentItem.exitDragMode();let t;this._area!==null?(t=this._componentItem,this._area.contentItem.onDrop(t,this._area)):this._lastValidArea!==null?(t=this._componentItem,this._lastValidArea.contentItem.onDrop(t,this._lastValidArea)):this._originalParent?(t=this._componentItem,this._originalParent.addChild(t)):this._componentItem.destroy(),this._element.remove(),this._layoutManager.emit("itemDropped",this._componentItem),this._componentItemFocused&&t!==void 0&&t.focus()}setDimensions(){const e=this._layoutManager.layoutConfig.dimensions;if(e===void 0)throw new Error("DragProxy.setDimensions: dimensions undefined");let t=e.dragProxyWidth,n=e.dragProxyHeight;if(t===void 0||n===void 0)throw new Error("DragProxy.setDimensions: width and/or height undefined");const i=this._layoutManager.layoutConfig.header.show===!1?0:e.headerHeight;this._element.style.width=S(t),this._element.style.height=S(n),t-=this._sided?i:0,n-=this._sided?0:i,this._proxyContainerElement.style.width=S(t),this._proxyContainerElement.style.height=S(n),this._componentItem.enterDragMode(t,n),this._componentItem.show()}}class ge{constructor(e,t,n,i,s,o,a){this._layoutManager=e,this._element=t,this._extraAllowableChildTargets=n,this._componentTypeOrFtn=i,this._componentState=s,this._title=o,this._id=a,this._dragListener=null,this._dummyGroundContainer=document.createElement("div");const l=oe.createDefault("row");this._dummyGroundContentItem=new q(this._layoutManager,l,this._dummyGroundContainer),this.createDragListener()}destroy(){this.removeDragListener()}createDragListener(){this.removeDragListener(),this._dragListener=new ke(this._element,this._extraAllowableChildTargets),this._dragListener.on("dragStart",(e,t)=>this.onDragStart(e,t)),this._dragListener.on("dragStop",()=>this.onDragStop())}onDragStart(e,t){var n;const i="component";let s;if(typeof this._componentTypeOrFtn=="function"){const l=this._componentTypeOrFtn();ge.isDragSourceComponentItemConfig(l)?s={type:i,componentState:l.state,componentType:l.type,title:(n=l.title)!==null&&n!==void 0?n:this._title}:s=l}else s={type:i,componentState:this._componentState,componentType:this._componentTypeOrFtn,title:this._title,id:this._id};const o=j.resolve(s,!1),a=new Y(this._layoutManager,o,this._dummyGroundContentItem);if(this._dummyGroundContentItem.contentItems.push(a),this._dragListener===null)throw new x("DSODSD66746");{const l=new He(e,t,this._dragListener,this._layoutManager,a,this._dummyGroundContentItem),d=this._layoutManager.transitionIndicator;if(d===null)throw new x("DSODST66746");d.transitionElements(this._element,l.element)}}onDragStop(){this.createDragListener()}removeDragListener(){this._dragListener!==null&&(this._dragListener.destroy(),this._dragListener=null)}}(function(r){function e(t){return!("componentType"in t)}r.isDragSourceComponentItemConfig=e})(ge||(ge={}));class ot{constructor(){this._element=document.createElement("div"),this._element.classList.add("lm_dropTargetIndicator");const e=document.createElement("div");e.classList.add("lm_inner"),this._element.appendChild(e),document.body.appendChild(this._element)}destroy(){this._element.remove()}highlightArea(e,t){this._element.style.left=S(e.x1+t),this._element.style.top=S(e.y1+t),this._element.style.width=S(e.x2-e.x1-t),this._element.style.height=S(e.y2-e.y1-t),this._element.style.display="block"}hide(){K(this._element,!1)}}class rt{constructor(){this._element=document.createElement("div"),this._element.classList.add("lm_transition_indicator"),document.body.appendChild(this._element),this._toElement=null,this._fromDimensions=null,this._totalAnimationDuration=200,this._animationStartTime=null}destroy(){this._element.remove()}transitionElements(e,t){}nextAnimationFrame(){}measure(e){const t=e.getBoundingClientRect();return{left:t.left,top:t.top,width:e.offsetWidth,height:e.offsetHeight}}}class Q extends M{constructor(e){super(),this._layoutManager=e,this._childEventListener=t=>this.onEventFromChild(t),globalThis.addEventListener(Q.ChildEventName,this._childEventListener,{passive:!0})}emit(e,...t){e==="userBroadcast"?this.emitUserBroadcast(...t):super.emit(e,...t)}emitUserBroadcast(...e){this.handleUserBroadcastEvent("userBroadcast",e)}destroy(){globalThis.removeEventListener(Q.ChildEventName,this._childEventListener)}handleUserBroadcastEvent(e,t){this._layoutManager.isSubWindow?this.propagateToParent(e,t):this.propagateToThisAndSubtree(e,t)}onEventFromChild(e){const t=e.detail;this.handleUserBroadcastEvent(t.eventName,t.args)}propagateToParent(e,t){const i={bubbles:!0,cancelable:!0,detail:{layoutManager:this._layoutManager,eventName:e,args:t}},s=new CustomEvent(Q.ChildEventName,i),o=globalThis.opener;if(o===null)throw new x("EHPTP15778");o.dispatchEvent(s)}propagateToThisAndSubtree(e,t){this.emitUnknown(e,...t);for(let n=0;n<this._layoutManager.openPopouts.length;n++){const i=this._layoutManager.openPopouts[n].getGlInstance();i&&i.eventHub.propagateToThisAndSubtree(e,t)}}}(function(r){r.ChildEventName="gl_child_event"})(Q||(Q={}));class ee extends M{constructor(e){super(),this.resizeWithContainerAutomatically=!1,this.resizeDebounceInterval=100,this.resizeDebounceExtendedWhenPossible=!0,this._isInitialised=!1,this._groundItem=void 0,this._openPopouts=[],this._dropTargetIndicator=null,this._transitionIndicator=null,this._itemAreas=[],this._maximisePlaceholder=ee.createMaximisePlaceElement(document),this._tabDropPlaceholder=ee.createTabDropPlaceholderElement(document),this._dragSources=[],this._updatingColumnsResponsive=!1,this._firstLoad=!0,this._eventHub=new Q(this),this._width=null,this._height=null,this._virtualSizedContainers=[],this._virtualSizedContainerAddingBeginCount=0,this._sizeInvalidationBeginCount=0,this._resizeObserver=new ResizeObserver(()=>this.handleContainerResize()),this._windowBeforeUnloadListener=()=>this.onBeforeUnload(),this._windowBeforeUnloadListening=!1,this._maximisedStackBeforeDestroyedListener=t=>this.cleanupBeforeMaximisedStackDestroyed(t),this.isSubWindow=e.isSubWindow,this._constructorOrSubWindowLayoutConfig=e.constructorOrSubWindowLayoutConfig,Ie.checkInitialise(),me.checkInitialise(),e.containerElement!==void 0&&(this._containerElement=e.containerElement)}get container(){return this._containerElement}get isInitialised(){return this._isInitialised}get groundItem(){return this._groundItem}get root(){return this._groundItem}get openPopouts(){return this._openPopouts}get dropTargetIndicator(){return this._dropTargetIndicator}get transitionIndicator(){return this._transitionIndicator}get width(){return this._width}get height(){return this._height}get eventHub(){return this._eventHub}get rootItem(){if(this._groundItem===void 0)throw new Error("Cannot access rootItem before init");return this._groundItem.contentItems.length===0?void 0:this._groundItem.contentItems[0]}get focusedComponentItem(){return this._focusedComponentItem}get tabDropPlaceholder(){return this._tabDropPlaceholder}get maximisedStack(){return this._maximisedStack}get deprecatedConstructor(){return!this.isSubWindow&&this._constructorOrSubWindowLayoutConfig!==void 0}destroy(){if(this._isInitialised){this._windowBeforeUnloadListening&&(globalThis.removeEventListener("beforeunload",this._windowBeforeUnloadListener),this._windowBeforeUnloadListening=!1),this.layoutConfig.settings.closePopoutsOnUnload===!0&&this.closeAllOpenPopouts(),this._resizeObserver.disconnect(),this.checkClearResizeTimeout(),this._groundItem!==void 0&&this._groundItem.destroy(),this._tabDropPlaceholder.remove(),this._dropTargetIndicator!==null&&this._dropTargetIndicator.destroy(),this._transitionIndicator!==null&&this._transitionIndicator.destroy(),this._eventHub.destroy();for(const e of this._dragSources)e.destroy();this._dragSources=[],this._isInitialised=!1}}minifyConfig(e){return g.minifyConfig(e)}unminifyConfig(e){return g.unminifyConfig(e)}init(){this.setContainer(),this._dropTargetIndicator=new ot,this._transitionIndicator=new rt,this.updateSizeFromContainer();let e;if(this.isSubWindow){if(this._constructorOrSubWindowLayoutConfig===void 0)throw new v("LMIU07155");{const n=this._constructorOrSubWindowLayoutConfig.root;if(n===void 0)throw new w("LMIC07156");if(z.isComponent(n))e=n;else throw new w("LMIC07157");const i=U.resolve(this._constructorOrSubWindowLayoutConfig);this.layoutConfig=Object.assign(Object.assign({},i),{root:void 0})}}else this._constructorOrSubWindowLayoutConfig===void 0?this.layoutConfig=g.createDefault():this.layoutConfig=U.resolve(this._constructorOrSubWindowLayoutConfig);const t=this.layoutConfig;this._groundItem=new q(this,t.root,this._containerElement),this._groundItem.init(),this.checkLoadedLayoutMaximiseItem(),this._resizeObserver.observe(this._containerElement),this._isInitialised=!0,this.adjustColumnsResponsive(),this.emit("initialised"),e!==void 0&&this.loadComponentAsRoot(e)}loadLayout(e){if(this.isInitialised){if(this._groundItem===void 0)throw new v("LMLL11119");this.createSubWindows(),this.layoutConfig=U.resolve(e),this._groundItem.loadRoot(this.layoutConfig.root),this.checkLoadedLayoutMaximiseItem(),this.adjustColumnsResponsive()}else throw new Error("GoldenLayout: Need to call init() if LayoutConfig with defined root passed to constructor")}saveLayout(){if(this._isInitialised===!1)throw new Error("Can't create config, layout not yet initialised");if(this._groundItem===void 0)throw new v("LMTC18244");{const e=this._groundItem.calculateConfigContent();let t;e.length!==1?t=void 0:t=e[0],this.reconcilePopoutWindows();const n=[];for(let s=0;s<this._openPopouts.length;s++)n.push(this._openPopouts[s].toConfig());return{root:t,openPopouts:n,settings:g.Settings.createCopy(this.layoutConfig.settings),dimensions:g.Dimensions.createCopy(this.layoutConfig.dimensions),header:g.Header.createCopy(this.layoutConfig.header),resolved:!0}}}clear(){if(this._groundItem===void 0)throw new v("LMCL11129");this._groundItem.clearRoot()}toConfig(){return this.saveLayout()}newComponent(e,t,n){const i=this.newComponentAtLocation(e,t,n);if(i===void 0)throw new w("LMNC65588");return i}newComponentAtLocation(e,t,n,i){if(this._groundItem===void 0)throw new Error("Cannot add component before init");{const s=this.addComponentAtLocation(e,t,n,i);if(s===void 0)return;{const o=s.parentItem.contentItems[s.index];if(A.isComponentItem(o))return o;throw new w("LMNC992877533")}}}addComponent(e,t,n){const i=this.addComponentAtLocation(e,t,n);if(i===void 0)throw new w("LMAC99943");return i}addComponentAtLocation(e,t,n,i){const s={type:"component",componentType:e,componentState:t,title:n};return this.addItemAtLocation(s,i)}newItem(e){const t=this.newItemAtLocation(e);if(t===void 0)throw new w("LMNC65588");return t}newItemAtLocation(e,t){if(this._groundItem===void 0)throw new Error("Cannot add component before init");{const n=this.addItemAtLocation(e,t);return n===void 0?void 0:n.parentItem.contentItems[n.index]}}addItem(e){const t=this.addItemAtLocation(e);if(t===void 0)throw new w("LMAI99943");return t}addItemAtLocation(e,t){if(this._groundItem===void 0)throw new Error("Cannot add component before init");{t===void 0&&(t=ee.defaultLocationSelectors);const n=this.findFirstLocation(t);if(n===void 0)return;{let i=n.parentItem,s;switch(i.type){case p.ground:{s=i.addItem(e,n.index),s>=0?i=this._groundItem.contentItems[0]:s=0;break}case p.row:case p.column:{s=i.addItem(e,n.index);break}case p.stack:if(z.isComponent(e)){s=i.addItem(e,n.index);break}else throw Error(J[6]);case p.component:throw new w("LMAIALC87444602");default:throw new D("LMAIALU98881733",i.type)}if(z.isComponent(e)){const o=i.contentItems[s];A.isStack(o)&&(i=o,s=0)}return n.parentItem=i,n.index=s,n}}}loadComponentAsRoot(e){if(this._groundItem===void 0)throw new Error("Cannot add item before init");this._groundItem.loadComponentAsRoot(e)}updateSize(e,t){this.setSize(e,t)}setSize(e,t){if(this._width=e,this._height=t,this._isInitialised===!0){if(this._groundItem===void 0)throw new v("LMUS18881");if(this._groundItem.setSize(this._width,this._height),this._maximisedStack){const{width:n,height:i}=G(this._containerElement);W(this._maximisedStack.element,n),H(this._maximisedStack.element,i),this._maximisedStack.updateSize(!1)}this.adjustColumnsResponsive()}}beginSizeInvalidation(){this._sizeInvalidationBeginCount++}endSizeInvalidation(){--this._sizeInvalidationBeginCount===0&&this.updateSizeFromContainer()}updateSizeFromContainer(){const{width:e,height:t}=G(this._containerElement);this.setSize(e,t)}updateRootSize(e=!1){if(this._groundItem===void 0)throw new v("LMURS28881");this._groundItem.updateSize(e)}createAndInitContentItem(e,t){const n=this.createContentItem(e,t);return n.init(),n}createContentItem(e,t){if(typeof e.type!="string")throw new $("Missing parameter 'type'",JSON.stringify(e));return I.isComponentItem(e)&&!(t instanceof V)&&t&&!(this.isSubWindow===!0&&t instanceof q)&&(e={type:p.stack,content:[e],size:e.size,sizeUnit:e.sizeUnit,minSize:e.minSize,minSizeUnit:e.minSizeUnit,id:e.id,maximised:e.maximised,isClosable:e.isClosable,activeItemIndex:0,header:void 0}),this.createContentItemFromConfig(e,t)}findFirstComponentItemById(e){if(this._groundItem===void 0)throw new v("LMFFCIBI82446");return this.findFirstContentItemTypeByIdRecursive(p.component,e,this._groundItem)}createPopout(e,t,n,i){return e instanceof A?this.createPopoutFromContentItem(e,t,n,i):this.createPopoutFromItemConfig(e,t,n,i)}createPopoutFromContentItem(e,t,n,i){let s=e.parent,o=e;for(;s!==null&&s.contentItems.length===1&&!s.isGround;)o=s,s=s.parent;if(s===null)throw new x("LMCPFCI00834");{if(i===void 0&&(i=s.contentItems.indexOf(o)),n!==null&&s.addPopInParentId(n),t===void 0){const l=globalThis.screenX||globalThis.screenLeft,d=globalThis.screenY||globalThis.screenTop,h=e.element.offsetLeft,m=e.element.offsetTop,{width:u,height:c}=G(e.element);t={left:l+h,top:d+m,width:u,height:c}}const a=e.toConfig();if(e.remove(),te.isRootItemConfig(a))return this.createPopoutFromItemConfig(a,t,n,i);throw new Error(`${J[0]}`)}}beginVirtualSizedContainerAdding(){++this._virtualSizedContainerAddingBeginCount===0&&(this._virtualSizedContainers.length=0)}addVirtualSizedContainer(e){this._virtualSizedContainers.push(e)}endVirtualSizedContainerAdding(){if(--this._virtualSizedContainerAddingBeginCount===0){const e=this._virtualSizedContainers.length;if(e>0){this.fireBeforeVirtualRectingEvent(e);for(let t=0;t<e;t++)this._virtualSizedContainers[t].notifyVirtualRectingRequired();this.fireAfterVirtualRectingEvent(),this._virtualSizedContainers.length=0}}}fireBeforeVirtualRectingEvent(e){this.beforeVirtualRectingEvent!==void 0&&this.beforeVirtualRectingEvent(e)}fireAfterVirtualRectingEvent(){this.afterVirtualRectingEvent!==void 0&&this.afterVirtualRectingEvent()}createPopoutFromItemConfig(e,t,n,i){const s=this.toConfig(),o={root:e,openPopouts:[],settings:s.settings,dimensions:s.dimensions,header:s.header,window:t,parentId:n,indexInParent:i,resolved:!0};return this.createPopoutFromPopoutLayoutConfig(o)}createPopoutFromPopoutLayoutConfig(e){var t,n,i,s;const o=e.window,a={left:(t=o.left)!==null&&t!==void 0?t:globalThis.screenX||globalThis.screenLeft+20,top:(n=o.top)!==null&&n!==void 0?n:globalThis.screenY||globalThis.screenTop+20,width:(i=o.width)!==null&&i!==void 0?i:500,height:(s=o.height)!==null&&s!==void 0?s:309},l=new et(e,a,this);return l.on("initialised",()=>this.emit("windowOpened",l)),l.on("closed",()=>this.reconcilePopoutWindows()),this._openPopouts.push(l),this.layoutConfig.settings.closePopoutsOnUnload&&!this._windowBeforeUnloadListening&&(globalThis.addEventListener("beforeunload",this._windowBeforeUnloadListener,{passive:!0}),this._windowBeforeUnloadListening=!0),l}closeAllOpenPopouts(){for(let e=0;e<this._openPopouts.length;e++)this._openPopouts[e].close();this._openPopouts.length=0,this._windowBeforeUnloadListening&&(globalThis.removeEventListener("beforeunload",this._windowBeforeUnloadListener),this._windowBeforeUnloadListening=!1)}newDragSource(e,t,n,i,s){const o=new ge(this,e,[],t,n,i,s);return this._dragSources.push(o),o}removeDragSource(e){Je(e,this._dragSources),e.destroy()}startComponentDrag(e,t,n,i,s){new He(e,t,n,this,i,s)}focusComponent(e,t=!1){e.focus(t)}clearComponentFocus(e=!1){this.setFocusedComponentItem(void 0,e)}setFocusedComponentItem(e,t=!1){if(e!==this._focusedComponentItem){let n;if(e===void 0||(n=e.parentItem),this._focusedComponentItem!==void 0){const i=this._focusedComponentItem;this._focusedComponentItem=void 0,i.setBlurred(t);const s=i.parentItem;n===s?n=void 0:s.setFocusedValue(!1)}e!==void 0&&(this._focusedComponentItem=e,e.setFocused(t),n!==void 0&&n.setFocusedValue(!0))}}createContentItemFromConfig(e,t){switch(e.type){case p.ground:throw new w("LMCCIFC68871");case p.row:return new ne(!1,this,e,t);case p.column:return new ne(!0,this,e,t);case p.stack:return new V(this,e,t);case p.component:return new Y(this,e,t);default:throw new D("CCC913564",e.type,"Invalid Config Item type specified")}}setMaximisedStack(e){e===void 0?this._maximisedStack!==void 0&&this.processMinimiseMaximisedStack():e!==this._maximisedStack&&(this._maximisedStack!==void 0&&this.processMinimiseMaximisedStack(),this.processMaximiseStack(e))}checkMinimiseMaximisedStack(){this._maximisedStack!==void 0&&this._maximisedStack.minimise()}cleanupBeforeMaximisedStackDestroyed(e){this._maximisedStack!==null&&this._maximisedStack===e.target&&(this._maximisedStack.off("beforeItemDestroyed",this._maximisedStackBeforeDestroyedListener),this._maximisedStack=void 0)}closeWindow(){globalThis.setTimeout(()=>globalThis.close(),1)}getArea(e,t){let n=null,i=1/0;for(let s=0;s<this._itemAreas.length;s++){const o=this._itemAreas[s];e>=o.x1&&e<o.x2&&t>=o.y1&&t<o.y2&&i>o.surface&&(i=o.surface,n=o)}return n}calculateItemAreas(){const e=this.getAllContentItems(),t=this._groundItem;if(t===void 0)throw new v("LMCIAR44365");if(e.length===1){const n=t.getElementArea();if(n===null)throw new x("LMCIARA44365");this._itemAreas=[n];return}else{t.contentItems[0].isStack?this._itemAreas=[]:this._itemAreas=t.createSideAreas();for(let n=0;n<e.length;n++){const i=e[n];if(A.isStack(i)){const s=i.getArea();if(s===null)continue;{this._itemAreas.push(s);const o=i.contentAreaDimensions;if(o===void 0)throw new v("LMCIASC45599");{const a=o.header.highlightArea,l=(a.x2-a.x1)*(a.y2-a.y1),d={x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2,contentItem:i,surface:l};this._itemAreas.push(d)}}}}}}checkLoadedLayoutMaximiseItem(){if(this._groundItem===void 0)throw new v("LMCLLMI43432");{const e=this._groundItem.getConfigMaximisedItems();if(e.length>0){let t=e[0];if(A.isComponentItem(t)){const n=t.parent;if(n===null)throw new x("LMXLLMI69999");t=n}if(A.isStack(t))t.maximise();else throw new w("LMCLLMI19993")}}}processMaximiseStack(e){if(this._maximisedStack=e,e.on("beforeItemDestroyed",this._maximisedStackBeforeDestroyedListener),e.element.classList.add("lm_maximised"),e.element.insertAdjacentElement("afterend",this._maximisePlaceholder),this._groundItem===void 0)throw new v("LMMXI19993");{this._groundItem.element.prepend(e.element);const{width:t,height:n}=G(this._containerElement);W(e.element,t),H(e.element,n),e.updateSize(!0),e.focusActiveContentItem(),this._maximisedStack.emit("maximised"),this.emit("stateChanged")}}processMinimiseMaximisedStack(){if(this._maximisedStack===void 0)throw new w("LMMMS74422");{const e=this._maximisedStack;if(e.parent===null)throw new x("LMMI13668");e.element.classList.remove("lm_maximised"),this._maximisePlaceholder.insertAdjacentElement("afterend",e.element),this._maximisePlaceholder.remove(),this.updateRootSize(!0),this._maximisedStack=void 0,e.off("beforeItemDestroyed",this._maximisedStackBeforeDestroyedListener),e.emit("minimised"),this.emit("stateChanged")}}reconcilePopoutWindows(){const e=[];for(let t=0;t<this._openPopouts.length;t++)this._openPopouts[t].getWindow().closed===!1?e.push(this._openPopouts[t]):this.emit("windowClosed",this._openPopouts[t]);this._openPopouts.length!==e.length&&(this._openPopouts=e,this.emit("stateChanged"))}getAllContentItems(){if(this._groundItem===void 0)throw new v("LMGACI13130");return this._groundItem.getAllContentItems()}createSubWindows(){for(let e=0;e<this.layoutConfig.openPopouts.length;e++){const t=this.layoutConfig.openPopouts[e];this.createPopoutFromPopoutLayoutConfig(t)}}handleContainerResize(){this.resizeWithContainerAutomatically&&this.processResizeWithDebounce()}processResizeWithDebounce(){this.resizeDebounceExtendedWhenPossible&&this.checkClearResizeTimeout(),this._resizeTimeoutId===void 0&&(this._resizeTimeoutId=setTimeout(()=>{this._resizeTimeoutId=void 0,this.beginSizeInvalidation(),this.endSizeInvalidation()},this.resizeDebounceInterval))}checkClearResizeTimeout(){this._resizeTimeoutId!==void 0&&(clearTimeout(this._resizeTimeoutId),this._resizeTimeoutId=void 0)}setContainer(){var e;const t=document.body,n=(e=this._containerElement)!==null&&e!==void 0?e:t;if(n===t){this.resizeWithContainerAutomatically=!0;const i=document.documentElement;i.style.height="100%",i.style.margin="0",i.style.padding="0",i.style.overflow="clip",t.style.height="100%",t.style.margin="0",t.style.padding="0",t.style.overflow="clip"}this._containerElement=n}onBeforeUnload(){this.destroy()}adjustColumnsResponsive(){if(this._groundItem===void 0)throw new v("LMACR20883");if(this._firstLoad=!1,this.useResponsiveLayout()&&!this._updatingColumnsResponsive&&this._groundItem.contentItems.length>0&&this._groundItem.contentItems[0].isRow){if(this._groundItem===void 0||this._width===null)throw new v("LMACR77412");{const e=this._groundItem.contentItems[0].contentItems.length;if(e<=1)return;{const t=this.layoutConfig.dimensions.defaultMinItemWidth;if(e*t<=this._width)return;{this._updatingColumnsResponsive=!0;const i=Math.max(Math.floor(this._width/t),1),s=e-i,o=this._groundItem.contentItems[0],a=this.getAllStacks();if(a.length===0)throw new w("LMACRS77413");{const l=a[0];for(let d=0;d<s;d++){const h=o.contentItems[o.contentItems.length-1];this.addChildContentItemsToContainer(l,h)}this._updatingColumnsResponsive=!1}}}}}}useResponsiveLayout(){const e=this.layoutConfig.settings,t=e.responsiveMode===ce.always,n=e.responsiveMode===ce.onload&&this._firstLoad;return t||n}addChildContentItemsToContainer(e,t){const n=t.contentItems;if(t instanceof V)for(let i=0;i<n.length;i++){const s=n[i];t.removeChild(s,!0),e.addChild(s)}else for(let i=0;i<n.length;i++){const s=n[i];this.addChildContentItemsToContainer(e,s)}}getAllStacks(){if(this._groundItem===void 0)throw new v("LMFASC52778");{const e=[];return this.findAllStacksRecursive(e,this._groundItem),e}}findFirstContentItemType(e){if(this._groundItem===void 0)throw new v("LMFFCIT82446");return this.findFirstContentItemTypeRecursive(e,this._groundItem)}findFirstContentItemTypeRecursive(e,t){const n=t.contentItems,i=n.length;if(i!==0){for(let s=0;s<i;s++){const o=n[s];if(o.type===e)return o}for(let s=0;s<i;s++){const o=n[s],a=this.findFirstContentItemTypeRecursive(e,o);if(a!==void 0)return a}return}}findFirstContentItemTypeByIdRecursive(e,t,n){const i=n.contentItems,s=i.length;if(s!==0){for(let o=0;o<s;o++){const a=i[o];if(a.type===e&&a.id===t)return a}for(let o=0;o<s;o++){const a=i[o],l=this.findFirstContentItemTypeByIdRecursive(e,t,a);if(l!==void 0)return l}return}}findAllStacksRecursive(e,t){const n=t.contentItems;for(let i=0;i<n.length;i++){const s=n[i];s instanceof V?e.push(s):s.isComponent||this.findAllStacksRecursive(e,s)}}findFirstLocation(e){const t=e.length;for(let n=0;n<t;n++){const i=e[n],s=this.findLocation(i);if(s!==void 0)return s}}findLocation(e){const t=e.index;switch(e.typeId){case 0:{if(this._focusedComponentItem===void 0)return;{const n=this._focusedComponentItem.parentItem,i=n.contentItems,s=i.length;if(t===void 0)return{parentItem:n,index:s};{const a=i.indexOf(this._focusedComponentItem)+t;return a<0||a>s?void 0:{parentItem:n,index:a}}}}case 1:{if(this._focusedComponentItem===void 0)return;{const n=this._focusedComponentItem.parentItem;return this.tryCreateLocationFromParentItem(n,t)}}case 2:{const n=this.findFirstContentItemType(p.stack);return n===void 0?void 0:this.tryCreateLocationFromParentItem(n,t)}case 3:{let n=this.findFirstContentItemType(p.row);return n!==void 0?this.tryCreateLocationFromParentItem(n,t):(n=this.findFirstContentItemType(p.column),n!==void 0?this.tryCreateLocationFromParentItem(n,t):void 0)}case 4:{const n=this.findFirstContentItemType(p.row);return n===void 0?void 0:this.tryCreateLocationFromParentItem(n,t)}case 5:{const n=this.findFirstContentItemType(p.column);return n===void 0?void 0:this.tryCreateLocationFromParentItem(n,t)}case 6:{if(this._groundItem===void 0)throw new v("LMFLRIF18244");return this.rootItem!==void 0?void 0:t===void 0||t===0?{parentItem:this._groundItem,index:0}:void 0}case 7:{if(this._groundItem===void 0)throw new v("LMFLF18244");{const n=this._groundItem.contentItems;if(n.length===0)return t===void 0||t===0?{parentItem:this._groundItem,index:0}:void 0;{const i=n[0];return this.tryCreateLocationFromParentItem(i,t)}}}}}tryCreateLocationFromParentItem(e,t){const i=e.contentItems.length;return t===void 0?{parentItem:e,index:i}:t<0||t>i?void 0:{parentItem:e,index:t}}}(function(r){function e(n){const i=n.createElement("div");return i.classList.add("lm_maximise_place"),i}r.createMaximisePlaceElement=e;function t(n){const i=n.createElement("div");return i.classList.add("lm_drop_tab_placeholder"),i}r.createTabDropPlaceholderElement=t,r.defaultLocationSelectors=[{typeId:1,index:void 0},{typeId:2,index:void 0},{typeId:3,index:void 0},{typeId:7,index:void 0}],r.afterFocusedItemIfPossibleLocationSelectors=[{typeId:0,index:1},{typeId:2,index:void 0},{typeId:3,index:void 0},{typeId:7,index:void 0}]})(ee||(ee={}));class Se extends ee{constructor(e,t,n,i){if(super(Se.createLayoutManagerConstructorParameters(e,t)),this._bindComponentEventHanlderPassedInConstructor=!1,this._creationTimeoutPassed=!1,t!==void 0&&typeof t=="function"&&(this.bindComponentEvent=t,this._bindComponentEventHanlderPassedInConstructor=!0,n!==void 0&&(this.unbindComponentEvent=n)),!this._bindComponentEventHanlderPassedInConstructor&&this.isSubWindow){if(this._constructorOrSubWindowLayoutConfig===void 0)throw new v("VLC98823");{const s=U.resolve(this._constructorOrSubWindowLayoutConfig);this.layoutConfig=Object.assign(Object.assign({},s),{root:void 0})}}i!==!0&&(this.deprecatedConstructor||this.init())}destroy(){this.bindComponentEvent=void 0,this.unbindComponentEvent=void 0,super.destroy()}init(){if(!this._bindComponentEventHanlderPassedInConstructor&&(document.readyState==="loading"||document.body===null)){document.addEventListener("DOMContentLoaded",()=>this.init(),{passive:!0});return}if(!this._bindComponentEventHanlderPassedInConstructor&&this.isSubWindow===!0&&!this._creationTimeoutPassed){setTimeout(()=>this.init(),7),this._creationTimeoutPassed=!0;return}this.isSubWindow===!0&&(this._bindComponentEventHanlderPassedInConstructor||this.clearHtmlAndAdjustStylesForSubWindow(),window.__glInstance=this),super.init()}clearHtmlAndAdjustStylesForSubWindow(){const e=document.head,t=new Array(4);t[0]=document.querySelectorAll("body link"),t[1]=document.querySelectorAll("body style"),t[2]=document.querySelectorAll("template"),t[3]=document.querySelectorAll(".gl_keep");for(let i=0;i<t.length;i++){const s=t[i];for(let o=0;o<s.length;o++){const a=s[o];e.appendChild(a)}}const n=document.body;n.innerHTML="",n.style.visibility="visible",this.checkAddDefaultPopinButton(),document.body.offsetHeight}checkAddDefaultPopinButton(){if(this.layoutConfig.settings.popInOnClose)return!1;{const e=document.createElement("div");e.classList.add("lm_popin"),e.setAttribute("title",this.layoutConfig.header.dock);const t=document.createElement("div");t.classList.add("lm_icon");const n=document.createElement("div");return n.classList.add("lm_bg"),e.appendChild(t),e.appendChild(n),e.addEventListener("click",()=>this.emit("popIn")),document.body.appendChild(e),!0}}bindComponent(e,t){if(this.bindComponentEvent!==void 0)return this.bindComponentEvent(e,t);if(this.getComponentEvent!==void 0)return{virtual:!1,component:this.getComponentEvent(e,t)};{const i=`${J[2]}: ${JSON.stringify(t)}`;throw new Ze(i)}}unbindComponent(e,t,n){if(this.unbindComponentEvent!==void 0)this.unbindComponentEvent(e);else if(!t&&this.releaseComponentEvent!==void 0){if(n===void 0)throw new v("VCUCRCU333998");this.releaseComponentEvent(e,n)}}}(function(r){let e=!1;function t(n,i){const s=e?null:new URL(document.location.href).searchParams.get("gl-window");e=!0;const o=s!==null;let a,l;if(s!==null){const d=localStorage.getItem(s);if(d===null)throw new Error("Null gl-window Config");localStorage.removeItem(s);const h=JSON.parse(d),m=g.unminifyConfig(h);l=U.fromResolved(m),n instanceof HTMLElement&&(a=n)}else n===void 0?l=void 0:n instanceof HTMLElement?(l=void 0,a=n):l=n,a===void 0&&i instanceof HTMLElement&&(a=i);return{constructorOrSubWindowLayoutConfig:l,isSubWindow:o,containerElement:a}}r.createLayoutManagerConstructorParameters=t})(Se||(Se={}));export{p as I,U as L,Se as V};
