import{a as l,t as W,c as T,w as $,o as Z,S as ge,v as S,x as y,K as B,z as u,L as X,N as _,A as E,I,O as he,U as Y,J as z,u as x,T as ye,F as we,n as K,l as Se,H as xe,Q as Le}from"./@vue-ClpcO8Zo.js";import{u as Pe,F as _e}from"./vee-validate-BmYbzI1D.js";import{c as Ce,a as ke}from"./yup-BgJ03jPv.js";import{l as F}from"./lodash-BzB9AJ4Z.js";import{C as Ve}from"./vue-select-BKCeRojA.js";import{_ as Be}from"./index-Cdw_DY-s.js";import"./property-expr-DEi1ZLzV.js";import"./tiny-case-BJ7jYKNY.js";import"./toposort-D3GKjj2I.js";import"./vue-router-DlzEUOd-.js";/* empty css                   */const Fe=["for"],Ie={class:"location-item"},Oe={class:"location-item-text"},qe={class:"text-bold"},Ne={key:0},Te={class:"form-validation"},$e={key:0,class:"invalid-message"},U=50,j=25,Ee={__name:"InfiniteSelect",props:{name:{type:String,required:!0},label:{type:String},field:{type:String,default:"text"},modelValue:[String,Number,Object],placeholder:{type:String,default:""},options:{type:Array},labelProp:{type:String},valueProp:{type:String},disabled:{type:Boolean},paginate:{type:Boolean,default:!0},fetchPageCallBack:{type:Function,default:void 0},isLastPage:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},disableValidation:{type:Boolean,default:!1},icon:{type:String},clearable:{type:Boolean,default:!0},searchable:{type:Boolean,default:!0}},emits:["selected","update:modelValue"],setup(c,{expose:C,emit:O}){const n=c,k=O,p=l(U),i=l(""),m=l([]),g=l([]),L=l(!0),w=l(null),d=l(1),b=l(!1),A=l(null),s=l(0),o=W(n,"name"),f=W(n,"modelValue"),{value:h,errorMessage:P,meta:v}=Pe(o,void 0,{initialValue:f}),q=l(0),R=l(null),N=l(null),D=T(()=>m.value.filter(e=>e&&e[n.labelProp]&&e[n.labelProp].toLowerCase().includes(i.value.toLowerCase())||e&&e.subText&&e.subText.toLowerCase().includes(i.value.toLowerCase()))),ee=T(()=>d.value>1),H=T(()=>{if(!n.paginate)return D.value;const e=d.value*p.value;return D.value.slice(0,e+p.value)}),te=T(()=>!v.validated||n.disableValidation?null:v.valid?"valid":"invalid");$(()=>n.modelValue,()=>{w.value=n.modelValue}),$(()=>n.loading,e=>{b.value=e,q.value++}),$(()=>n.isLastPage,e=>{L.value=!e}),$(()=>F.cloneDeep(n.options),e=>{if(m.value.length===0)m.value=e,g.value=e;else{const t=e.filter(a=>!m.value.some(r=>F.isEqual(r,a)));t.length>0&&m.value.push(...t),de()}},{immediate:!0});async function ae(){!L.value||b.value||await J(d.value,i.value)}async function J(e,t=null){if(n.fetchPageCallBack===void 0)console.error("fetchPageCallBack must be implemented inorder to enable pagination.");else try{await n.fetchPageCallBack(e,t)}catch(a){console.error("Error fetching items:",a)}}const le=async e=>{i.value=e,d.value=1,p.value=U,m.value=g.value,oe(d.value,i.value),await K(),q.value++},oe=F.debounce(async(e,t)=>{await J(e,t)},j);async function ne(e){var t,a;if(e!=null&&e.target){const r=e.target,M=r.scrollTop,pe=r.scrollHeight,be=r.clientHeight;if(M<=100&&ee.value){const V=r.children[0];V&&((t=R.value)==null||t.observe(V))}else if(pe-M<=be+100){const V=r.children[(r==null?void 0:r.children.length)-1];V&&((a=N.value)==null||a.observe(V))}s.value=M}}const G=F.debounce(ne,j);function se(e){e.forEach(t=>{t.isIntersecting&&!b.value&&d.value--})}async function re(e){e.forEach(async t=>{t.isIntersecting&&!b.value&&L.value&&(d.value++,await ae())})}const ie=e=>{var t;if(!(!L.value||b.value))switch(e.key){case"ArrowDown":const a=H.value.length-1;if(a>=0&&document.querySelectorAll(".vs__dropdown-option")[a]){const r=document.querySelectorAll(".vs__dropdown-option")[a];r.getBoundingClientRect().bottom>=window.innerHeight*.8&&(ue(d.value+1)||((t=N.value)==null||t.observe(r),s.value=r.scrollTop))}break}},Q=F.debounce(ie,j);function ue(e){const t=e*p.value;return D.value.slice(t,t+p.value).length>1}function ce(e){k("selected",e)}function de(){K().then(()=>{const e=document.querySelector(".vs__dropdown-menu");e&&requestAnimationFrame(()=>{e.scrollTop=s.value})})}function ve(){K(()=>{requestAnimationFrame(()=>{const e=document.querySelector(".vs__dropdown-menu");e&&e.addEventListener("scroll",G)})})}function me(){const e=document.querySelector(".vs-dropdown-menu");e&&e.removeEventListener("scroll",G),s.value=0}function fe(){m.value=[],p.value=U}return C({reset:fe}),Z(()=>{R.value=new IntersectionObserver(se),N.value=new IntersectionObserver(re)}),ge(()=>{var e,t;(e=R.value)==null||e.disconnect(),(t=N.value)==null||t.disconnect()}),(e,t)=>(y(),S(we,null,[c.label?(y(),S("label",{key:0,class:X(["label",{required:e.$attrs.required}]),for:e.$attrs.id},_(c.label)+" Page: "+_(d.value)+" | Loaded Records: "+_(m.value.length),11,Fe)):B("",!0),u("div",{class:X(["input-field-select",(te.value,{icon:c.icon})])},[E(x(Ve),he({id:"selector",ref_key:"selectRef",ref:A,disabled:c.disabled,options:H.value,filterable:!1,placeholder:c.placeholder,clearable:c.clearable,onSearch:t[0]||(t[0]=a=>{le(a)}),onOpen:ve,onClose:me,"onOption:selected":ce,onKeydown:[Y(z(x(Q),["prevent"]),["down"]),Y(z(x(Q),["prevent"]),["up"])],label:c.labelProp,modelValue:w.value,"onUpdate:modelValue":t[1]||(t[1]=a=>w.value=a),reduce:a=>a[c.valueProp],searchable:n.searchable},e.$attrs),{option:I(a=>[u("div",Ie,[u("div",Oe,[u("div",qe,_(a.text),1),a!=null&&a.subText?(y(),S("div",Ne,_(a.subText),1)):B("",!0)])])]),"list-footer":I(()=>[b.value?(y(),S("li",{key:q.value,class:"loader"},"Loading...")):B("",!0)]),"no-options":I(()=>[!b.value&&H.value.length===0?(y(),S("div",{key:q.value},t[2]||(t[2]=[u("span",null,"No Matches found",-1)]))):B("",!0)]),_:1},16,["disabled","options","placeholder","clearable","onKeydown","label","modelValue","reduce","searchable"])],2),u("div",Te,[E(ye,{name:"fade"},{default:I(()=>[x(P)?(y(),S("span",$e,_(x(P)),1)):B("",!0)]),_:1})])],64))}},Ae=["onSubmit"],Re=["onClick"],De={__name:"CustomForm",setup(c){const C=l(!0),O=Ce({location:ke().required("location is required")}),n=Se("api"),k=l(""),p=l([{text:"Select Location",value:0}]),i=l([{text:"Select Location",value:0}]),m=l(""),g=l(!1),L=l(null),w=l(!1);async function d(s,o){m.value=o,i.value=p.value,g.value=!0;const f=o&&o.trim()!==""?{LocationName:o,FormattedAddress:o}:{},h=await n.getPage({searchCriteria:f,pageNumber:s});w.value=!h.HasNextPage;const P=h.Items.map(v=>({text:v.LocationName,value:v.LocationID,subText:v.FormattedAddress}));i.value=[...P],g.value=!1}function b(s){alert(JSON.stringify(s,null,2))}function A(s,o){var h;(h=l(null).value)==null||h.reset(),C.value=!1,o({values:{location:""}}),setTimeout(()=>{s({location:""}),C.value=!0},500)}return Z(async()=>{g.value=!0;const s=await n.getPage({searchCriteria:{},pageNumber:1});w.value=!s.HasNextPage;const o=s.Items.map(f=>({text:f.LocationName,subText:f.FormattedAddress,value:f.LocationID}));i.value=[...o],g.value=!1}),(s,o)=>(y(),xe(x(_e),{"validation-schema":x(O),as:"div"},{default:I(({handleSubmit:f,handleReset:h,setErrors:P})=>[u("form",{ref:"customFormRef",onSubmit:v=>f(v,b),style:{"border-color":"black","border-style":"dashed","border-width":"1px","border-radius":"1%","margin-top":"10%",padding:"10%",width:"500px"}},[o[1]||(o[1]=u("br",null,null,-1)),E(Ee,{ref_key:"elLocation",ref:L,modelValue:k.value,"onUpdate:modelValue":o[0]||(o[0]=v=>k.value=v),name:"location",options:i.value,label:"Location:",labelProp:"text",valueProp:"value",paginate:!0,required:!0,searchable:!0,clearable:!0,isLastPage:w.value,loading:g.value,fetchPageCallBack:d,rules:"required",placeholder:"Select Location",style:{width:"100%"}},null,8,["modelValue","options","isLastPage","loading"]),o[2]||(o[2]=u("br",null,null,-1)),o[3]||(o[3]=u("button",null,"Submit",-1)),u("button",{onClick:z(v=>A(P,h),["prevent"])},"Reset",8,Re)],40,Ae)]),_:1},8,["validation-schema"]))}},He={name:"FiddleView",components:{CustomForm:De}},Me={class:"scrollable"},Ke={class:"h-100 d-flex align-items-top justify-content-center"};function Ue(c,C,O,n,k,p){const i=Le("CustomForm");return y(),S("div",Me,[u("div",Ke,[E(i)])])}const at=Be(He,[["render",Ue],["__scopeId","data-v-f77efa66"]]);export{at as default};
