Ext.define("Ext.pivot.plugin.DrillDown",{alternateClassName:["Mz.pivot.plugin.DrillDown"],alias:["plugin.pivotdrilldown","plugin.mzdrilldown"],extend:"Ext.AbstractPlugin",requires:["Ext.pivot.Grid","Ext.window.Window","Ext.data.proxy.Memory","Ext.data.Store","Ext.toolbar.Paging"],mixins:{observable:"Ext.util.Observable"},columns:[],width:400,height:300,textWindow:"Drill down window",lockableScope:"top",init:function(a){var b=this;if(!a.isPivotGrid){Ext.raise("This plugin is only compatible with Ext.pivot.Grid")}b.pivot=a;b.pivotListeners=b.pivot.on({pivotitemcelldblclick:b.runPlugin,pivotgroupcelldblclick:b.runPlugin,pivottotalcelldblclick:b.runPlugin,scope:b,destroyable:true});b.callParent(arguments)},destroy:function(){var a=this;Ext.destroyMembers(a,"view","pivotListeners");a.pivot=a.view=a.pivotListeners=a.store=null;a.callParent(arguments)},showView:function(c){var e=this,a=e.pivot.getMatrix().store.model.getFields(),d=e.columns,b;if(!e.view){b=Ext.create("Ext.data.Store",{pageSize:25,remoteSort:true,fields:Ext.clone(a),proxy:{type:"memory",reader:{type:"array"},enablePaging:true}});if(d.length===0){Ext.Array.each(a,function(h,f,g){d.push({header:Ext.String.capitalize(h.name),dataIndex:h.name})})}e.view=Ext.create("Ext.window.Window",{title:e.textWindow,width:e.width,height:e.height,layout:"fit",modal:true,closeAction:"hide",items:[{xtype:"grid",border:false,viewConfig:{loadMask:false},columns:d,store:b,dockedItems:[{itemId:"idPager",xtype:"pagingtoolbar",store:b,dock:"bottom",displayInfo:true}]}]});e.store=b}e.store.getProxy().data=c;e.store.load();e.view.show();e.view.down("#idPager").moveFirst()},runPlugin:function(g,f,c){var d=this,b=d.pivot.getMatrix(),a;if(d.disabled){return}if(g.topKey){a=b.results.get(g.leftKey,g.topKey);if(a){d.showView(a.records)}}}});