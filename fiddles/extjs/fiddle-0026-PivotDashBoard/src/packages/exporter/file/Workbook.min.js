Ext.define("Ext.exporter.file.excel.Workbook",{extend:"Ext.exporter.file.Base",requires:["Ext.exporter.file.excel.Worksheet","Ext.exporter.file.excel.Table","Ext.exporter.file.excel.Style","Ext.exporter.file.excel.Row","Ext.exporter.file.excel.Column","Ext.exporter.file.excel.Cell"],config:{title:"Workbook",author:"Sencha",windowHeight:9000,windowWidth:50000,protectStructure:false,protectWindows:false,styles:[],worksheets:[]},tpl:['<?xml version="1.0" encoding="utf-8"?>\n','<?mso-application progid="Excel.Sheet"?>\n',"<Workbook ",'xmlns="urn:schemas-microsoft-com:office:spreadsheet" ','xmlns:o="urn:schemas-microsoft-com:office:office" ','xmlns:x="urn:schemas-microsoft-com:office:excel" ','xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" ','xmlns:html="http://www.w3.org/TR/REC-html40">\n','   <DocumentProperties xmlns="urn:schemas-microsoft-com:office:office">\n',"       <Title>{title:htmlEncode}</Title>\n","       <Author>{author:htmlEncode}</Author>\n","       <Created>{createdAt}</Created>\n","   </DocumentProperties>\n",'   <ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel">\n',"       <WindowHeight>{windowHeight}</WindowHeight>\n","       <WindowWidth>{windowWidth}</WindowWidth>\n","       <ProtectStructure>{protectStructure}</ProtectStructure>\n","       <ProtectWindows>{protectWindows}</ProtectWindows>\n","   </ExcelWorkbook>\n","   <Styles>\n",'<tpl for="styles">{[values.render()]}</tpl>',"   </Styles>\n",'<tpl for="worksheets">{[values.render()]}</tpl>',"</Workbook>"],destroy:function(){this.getStyles().destroy();this.getWorksheets().destroy();return this.callParent(arguments)},getRenderData:function(){return Ext.apply(this.callParent(arguments),{worksheets:this.getWorksheets().getRange(),styles:this.getStyles().getRange()})},applyStyles:function(b,a){return this.checkCollection(b,a,"Ext.exporter.file.excel.Style")},applyWorksheets:function(b,a){return this.checkCollection(b,a,"Ext.exporter.file.excel.Worksheet")},addStyle:function(a){return this.getStyles().add(a||{})},getStyle:function(a){return this.getStyles().get(a)},addWorksheet:function(a){return this.getWorksheets().add(a||{})},getWorksheet:function(a){return this.getWorksheets().get(a)}});